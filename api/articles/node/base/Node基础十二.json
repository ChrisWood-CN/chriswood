{"title":"Node基础十二","uid":"c5c39a45409b6c5284d037b63eb17322","slug":"node/base/Node基础十二","date":"2022-10-01T04:32:50.000Z","updated":"2023-06-14T00:11:57.238Z","comments":true,"path":"api/articles/node/base/Node基础十二.json","keywords":"chriswood blogs sharing","cover":[],"content":"<h2 id=\"十二-数据库MySQL\"><a href=\"#十二-数据库MySQL\" class=\"headerlink\" title=\"十二.数据库MySQL\"></a>十二.数据库MySQL</h2><h2 id=\"认识数据库\"><a href=\"#认识数据库\" class=\"headerlink\" title=\"认识数据库\"></a>认识数据库</h2><h3 id=\"1-1-为什么要使用数据库\"><a href=\"#1-1-为什么要使用数据库\" class=\"headerlink\" title=\"1.1. 为什么要使用数据库\"></a>1.1. 为什么要使用数据库</h3><p>任何的软件系统都需要存放大量的数据，这些数据通常是非常复杂和庞大的：</p>\n<ul>\n<li>比如用户信息包括姓名、年龄、性别、地址、身份证号、出生日期等等；</li>\n<li>比如商品信息包括商品的名称、描述、价格（原价）、分类标签、商品图片等等；</li>\n<li>比如歌曲信息包括歌曲的名称、歌手、专辑、歌曲时长、歌词信息、封面图片等等；</li>\n</ul>\n<p>那么这些信息不能直接存储到文件中吗？可以，但是文件系统有很多的缺点：</p>\n<ul>\n<li>很难以合适的方式组织数据（多张表之前的关系合理组织）；</li>\n<li>并且对数据进行增删改查中的复杂操作（虽然一些简单确实可以），并且保证单操作的原子性；</li>\n<li>很难进行数据共享，比如一个数据库需要为多个程序服务，如何进行很好的数据共享；</li>\n<li>需要考虑如何进行数据的高效备份、迁移、恢复；</li>\n<li>等等…</li>\n</ul>\n<p>数据库通俗来讲就是一个存储数据的仓库，数据库本质上就是一个软件、一个程序。</p>\n<h3 id=\"1-2-常见的数据库有哪些？\"><a href=\"#1-2-常见的数据库有哪些？\" class=\"headerlink\" title=\"1.2. 常见的数据库有哪些？\"></a>1.2. 常见的数据库有哪些？</h3><p>通常我们将数据划分成两类：</p>\n<ul>\n<li><p>关系型数据库：MySQL、Oracle、DB2、SQL Server、Postgre SQL等；</p>\n</li>\n<li><ul>\n<li>关系型数据库通常我们会创建很多个二维数据表；</li>\n</ul>\n</li>\n<li><p>数据表之间相互关联起来，形成一对一、一对多、多对对等关系；</p>\n</li>\n<li><p>之后可以利用SQL语句在多张表中查询我们所需的数据；</p>\n</li>\n<li><p>支持事物，对数据的访问更加的安全；</p>\n</li>\n<li><p>非关系型数据库：MongoDB、Redis、Memcached、HBse等；</p>\n</li>\n<li><ul>\n<li>非关系型数据库的英文其实是Not only SQL，也简称为NoSQL；</li>\n</ul>\n</li>\n<li><p>相当而已非关系型数据库比较简单一些，存储数据也会更加自由（甚至我们可以直接将一个复杂的json对象直接塞入到数据库中）；</p>\n</li>\n<li><p>NoSQL是基于Key-Value的对应关系，并且查询的过程中不需要经过SQL解析，所以性能更高；</p>\n</li>\n<li><p>NoSQL通常不支持事物，需要在自己的程序中来保证一些原子性的操作；</p>\n</li>\n</ul>\n<p>如何在开发中选择他们呢？具体的选择会根据不同的项目进行综合的分析，我这里给一点点建议：</p>\n<ul>\n<li>目前在公司进行后端开发（Node、Java、Go等），还是以关系型数据库为主；</li>\n<li>比较常用的用到非关系型数据库的，在爬取大量的数据进行存储时，会比较常见；</li>\n</ul>\n<p>我们的课程是开发自己的后端项目，所以我们以关系型数据库MySQL作为主要内容。</p>\n<p>MySQL的介绍：</p>\n<ul>\n<li>MySQL原本是一个开源的数据库，原开发者为瑞典的MySQL AB公司；</li>\n<li>在2008年被Sun公司收购；在2009年，Sun被Oracle收购；</li>\n<li>所以目前MySQL归属于Oracle；</li>\n</ul>\n<p>MySQL是一个关系型数据库，其实本质上就是一款软件、一个程序：</p>\n<ul>\n<li>这个程序中管理着多个数据库；</li>\n<li>每个数据库中可以有多张表；</li>\n<li>每个表中可以有多条数据；</li>\n</ul>\n<p><img src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\" alt=\"图片\">关系型数据库</p>\n<h3 id=\"1-3-MySQL的下载和安装\"><a href=\"#1-3-MySQL的下载和安装\" class=\"headerlink\" title=\"1.3. MySQL的下载和安装\"></a>1.3. MySQL的下载和安装</h3><p><strong>第一步：下载MySQL软件</strong></p>\n<p>下载地址：<a href=\"https://dev.mysql.com/downloads/mysql/\">https://dev.mysql.com/downloads/mysql/</a></p>\n<ul>\n<li><p>根据自己的操作系统下载即可；</p>\n</li>\n<li><p>推荐大家直接下载安装版本，在安装过程中会配置一些环境变量；</p>\n</li>\n<li><ul>\n<li>Windows推荐下载MSI的版本；</li>\n</ul>\n</li>\n<li><p>Mac推荐下载DMG的版本；</p>\n</li>\n<li><p>这里我安装的是MySQL最新的版本：8.0.22（不再使用旧的MySQL5.x的版本）</p>\n</li>\n</ul>\n<p>Windows：</p>\n<ul>\n<li>下载下面的，不需要联网安装；</li>\n</ul>\n<p><img src=\"https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuvdojjKnD58NF714kccict62FK0yMcWgEBjqqcvNQE5dXHvHJ2Irqsics0HJLU1QHsIdtic2q87jicGIw/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1\" alt=\"图片\">Windows下载的版本</p>\n<p>Mac：</p>\n<p><img src=\"https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuvdojjKnD58NF714kccict62icJylNSAM4bk5mZwvSBouI8ymB3xCjQI2OdeE8HPVkAhArR3hIwibc7A/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1\" alt=\"图片\">Mac下载的版本</p>\n<p><strong>第二步：安装的过程</strong></p>\n<p>安装的过程，基本没有太复杂的操作。</p>\n<p>有一个需要着重说明的是MySQL8，可以采用一种更新的、安全性更高的密码和加密方式：</p>\n<ul>\n<li>最新的加密方式有可能会被一些比较老的软件驱动不支持；</li>\n<li>所以要根据情况来选择，但是我这里选择最新的加密方式了；</li>\n</ul>\n<p>Windows的安装过程：</p>\n<p><img src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\" alt=\"图片\">Server Only</p>\n<p><img src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\" alt=\"图片\">执行</p>\n<p><img src=\"https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuvdojjKnD58NF714kccict62CRsYribbzFicIFszSG6EWIJiaiayqDpFkbSyXZbuJUlCQe22MK6oOLXarg/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1\" alt=\"图片\">安装一个依赖</p>\n<p><img src=\"https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuvdojjKnD58NF714kccict62z39u8qonz5WsGdiaqCQWOf9Y3svcK3ysuzGQz2CUJbdrcoSAZKBKKzw/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1\" alt=\"图片\">下一步</p>\n<p><img src=\"https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuvdojjKnD58NF714kccict62k70qPjhYoV4dibEO1AxRRO4qNq9HiavCaTqaCLtHOcdJ3zbbnPEUibCEg/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1\" alt=\"图片\">配置端口号</p>\n<p><img src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\" alt=\"图片\">选择密码加密方式</p>\n<p><img src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\" alt=\"图片\">填写一个复杂的密码</p>\n<p><img src=\"https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuvdojjKnD58NF714kccict62IWLbUU0kLq8ibkEUHSBFSic3c0eTvDvibq6dZoATVQZzohwPlGozUTuKw/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1\" alt=\"图片\">配置服务的名称</p>\n<p><img src=\"https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuvdojjKnD58NF714kccict62IvjRm4cLgZbjg3WicrX1DgwMZqDibXjrjpnJA2rrBZ7Uva1ASmrzIm3A/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1\" alt=\"图片\">应用所有配置</p>\n<p><img src=\"https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuvdojjKnD58NF714kccict62fia8L5CT6VjzDPiaRMicezlibbuv0ycFiaIK0egfGXI8iccicPEIbQw1oau3Q/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1\" alt=\"图片\">完成即可</p>\n<p><strong>第三步：启动mysql</strong></p>\n<p>在Windows启动MySQL：</p>\n<p><img src=\"https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuvdojjKnD58NF714kccict622uZ9FyrnvFxMAPrYKJ0AhZtdIIHwHJ8EYyoIVFqDCrzVO9hwjqCoMw/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1\" alt=\"图片\">image-20201109171443817</p>\n<p>在Mac中启动MySQL是在系统偏好设置中：</p>\n<p><img src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\" alt=\"图片\">Mac启动MySQL</p>\n<h3 id=\"1-4-mysql的连接和操作\"><a href=\"#1-4-mysql的连接和操作\" class=\"headerlink\" title=\"1.4. mysql的连接和操作\"></a>1.4. mysql的连接和操作</h3><p>打开终端，查看MySQL的安装：</p>\n<ul>\n<li>这里会显示找不到命令；</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">mysql --version</code></pre>\n\n<p>在Windows上配置环境变量：</p>\n<p><img src=\"https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuvdojjKnD58NF714kccict62OrAGbqEib5b6dicGia0rdC6KRFWSTgiciaLIoHXJJIzlxRr82ACWib0KntjA/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1\" alt=\"图片\">Windows上配置环境变量</p>\n<p>在Mac上配置环境变量：</p>\n<p>手动执行下面的终端命令，将MySQL配置到环境变量中：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 添加环境变量\nexport PATH&#x3D;$PATH:&#x2F;usr&#x2F;local&#x2F;mysql&#x2F;bin\n# 再次执行mysql版本\nmysql --version</code></pre>\n\n<h4 id=\"1-4-1-终端连接数据库\"><a href=\"#1-4-1-终端连接数据库\" class=\"headerlink\" title=\"1.4.1. 终端连接数据库\"></a>1.4.1. 终端连接数据库</h4><p>我们如果想要操作数据，需要先和数据建立一个连接，最直接的方式就是通过终端来连接；</p>\n<p>有两种方式来连接：</p>\n<ul>\n<li>两种方式的区别在于输入密码是直接输入，还是另起一行以密文的形式输入；</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 方式一：\nmysql -uroot -pCoderwhy888.\n# 方式二：\nmysql -uroot -p\nEnter password: your password</code></pre>\n\n<p>输入成功后，会进入到mysql的REPL（交互式的编程环境）：</p>\n<p><img src=\"https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuvdojjKnD58NF714kccict62JnpyIGr4tx2hay6FP42FClFbpuWbG8UI6Og3s3wS2ouVa0u0YGAtkg/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1\" alt=\"图片\">MySQL的REPL</p>\n<p>我们可以直接在REPL中对数据库进行操作。</p>\n<h4 id=\"1-4-2-终端操作数据库\"><a href=\"#1-4-2-终端操作数据库\" class=\"headerlink\" title=\"1.4.2. 终端操作数据库\"></a>1.4.2. 终端操作数据库</h4><p>我们说过，一个数据库软件中，可以包含很多个数据库：</p>\n<ul>\n<li>infomation_schema：信息数据库，其中包括MySQL在维护的其他数据库、表、列、访问权限等信息；</li>\n<li>performance_schema：性能数据库，记录着MySQL Server数据库引擎在运行过程中的一些资源消耗相关的信息；</li>\n<li>mysql：用于存储数据库管理者的用户信息、权限信息以及一些日志信息等；</li>\n<li>sys：相当于是一个简易版的performance_schema，将数据汇总成更容易理解的形式；</li>\n</ul>\n<p>注意：这里我只是在终端简单演练数据库，并没有详细讲解每一个命令，也没有完全按照SQL格式规范；</p>\n<ul>\n<li>这些在后面会详细讲解的；</li>\n</ul>\n<p>查看所有的数据库：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">show databases;</code></pre>\n\n<p><img src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\" alt=\"图片\">image-20201108165132702</p>\n<p>在终端直接创建一个属于自己的新的数据库coderhub（一般情况下一个新的项目会对应一个新的数据库）。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">create database coderhub;</code></pre>\n\n<p><img src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\" alt=\"图片\">创建一个数据库</p>\n<p>使用我们创建的数据库coderhub：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">use coderhub;</code></pre>\n\n<p>在数据库中创建自己的表：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">create table user(\n\tname varchar(20),\n\tage int,\n\theight double\n);</code></pre>\n\n<p><img src=\"https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuvdojjKnD58NF714kccict62EVFibib0GWnial4mhuOACqkFyAX2thes0m5s8g0rrBy2QuOSdUN7ibWG7g/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1\" alt=\"图片\">创建用户表</p>\n<p>在user表中插入自己的数据：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">insert into user (name, age, height) values (&#39;why&#39;, 18, 1.88);\ninsert into user (name, age, height) values (&#39;kobe&#39;, 40, 1.98);</code></pre>\n\n<p><img src=\"https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuvdojjKnD58NF714kccict62NLDWPzECzABc5ZlhoTic2awy2GSPGBMocgIpadOZWa6l9kGnbTnZCMQ/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1\" alt=\"图片\">插入两条数据</p>\n<p>查看user表中所有的数据：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">select * from user;</code></pre>\n\n<p><img src=\"https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuvdojjKnD58NF714kccict62HJmcEAdvA6FpMWTQER7PUkowJnlaYdmhYYZHic6I5XuhMWgHgVh2q7w/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1\" alt=\"图片\">查询表中的数据</p>\n<h3 id=\"1-5-GUI工具操作数据库\"><a href=\"#1-5-GUI工具操作数据库\" class=\"headerlink\" title=\"1.5. GUI工具操作数据库\"></a>1.5. GUI工具操作数据库</h3><p>我们会发现在终端操作数据库有很多不方便的地方：</p>\n<ul>\n<li>语句写出来没有高亮，并且不会有任何的提示；</li>\n<li>复杂的语句分成多行，格式看起来并不美观，很冗余出现错误；</li>\n<li>终端中查看所有的数据库或者表非常的不直观和不方便；</li>\n<li>等等…</li>\n</ul>\n<p>所以在开发中，我们可以借助于一些GUI工具来帮助我们连接上数据库，之后直接在GUI工具中操作就会非常方便。</p>\n<p>常见的MySQL的GUI工具有很多，这里推荐几款：</p>\n<ul>\n<li>Navicat：个人最喜欢的一款工作，但是是收费的（有免费的试用时间，或者各显神通）；</li>\n<li>SQLYog：一款免费的SQL工具；</li>\n<li>TablePlus：常用功能都可以使用，但是会多一些限制（比如只能开两个标签页）；</li>\n</ul>\n<p>这里我选择使用Navicat。</p>\n<p><img src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\" alt=\"图片\">连接数据库</p>\n<p>查看所有的数据库、表、表中的数据：</p>\n<p><img src=\"https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuvdojjKnD58NF714kccict62MRWvtduj4pC1Yt9GvW8JSqmpWzFJJENfoHq4yicxUEz5uELrmTFjMnw/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1\" alt=\"图片\">Navicat界面</p>\n<p>编写SQL语句，并且执行；</p>\n<p><img src=\"https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuvdojjKnD58NF714kccict62fViaNPicV44h5ictF9vpLbP0zHic620OjEibibNXnIgKMm5EAaqwg17GKZTQ/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1\" alt=\"图片\">Navicat编写SQL</p>\n<h2 id=\"SQL语句\"><a href=\"#SQL语句\" class=\"headerlink\" title=\"SQL语句\"></a>SQL语句</h2><h3 id=\"2-1-认识SQL语句\"><a href=\"#2-1-认识SQL语句\" class=\"headerlink\" title=\"2.1. 认识SQL语句\"></a>2.1. 认识SQL语句</h3><p>我们希望操作数据库（特别是在程序中），就需要有和数据库沟通的语言，这个语言就是SQL：</p>\n<ul>\n<li>SQL是Structured Query Language，称之为结构化查询语言，简称SQL；</li>\n<li>使用SQL编写出来的语句，就称之为SQL语句；</li>\n<li>SQL语句可以用于对数据库进行操作；</li>\n</ul>\n<p>事实上，常见的关系型数据库SQL语句都是比较相似的，所以你学会了MySQL中的SQL语句，之后去操作比如Oracle或者其他关系型数据库，也是非常方便的。</p>\n<p>SQL语句的常用规范：</p>\n<ul>\n<li>通常关键字是大写的，比如CREATE、TABLE、SHOW等等；</li>\n<li>一条语句结束后，需要以 <code>;</code> 结尾；</li>\n<li>如果遇到关键字作为表明或者字段名称，可以使用&#96;&#96;包裹;</li>\n</ul>\n<p>常见的SQL语句我们可以分成四类：</p>\n<ul>\n<li><p>DDL（Data Definition Language）：数据定义语言；</p>\n</li>\n<li><ul>\n<li>可以通过DDL语句对数据库或者表进行：创建、删除、修改等操作；</li>\n</ul>\n</li>\n<li><p>DML（Data Manipulation Language）：数据操作语言；</p>\n</li>\n<li><ul>\n<li>可以通过DML语句对表进行：添加、删除、修改等操作；</li>\n</ul>\n</li>\n<li><p>DQL（Data Query Language）：数据查询语言；</p>\n</li>\n<li><ul>\n<li>可以通过DQL从数据库中查询记录；（重点）</li>\n</ul>\n</li>\n<li><p>DCL（Data Control Language）：数据控制语言；</p>\n</li>\n<li><ul>\n<li>对数据库、表格的权限进行相关访问控制操作；</li>\n</ul>\n</li>\n</ul>\n<p>接下来我们对他们进行一个个的学习和掌握。</p>\n<h3 id=\"2-2-DDL语句\"><a href=\"#2-2-DDL语句\" class=\"headerlink\" title=\"2.2. DDL语句\"></a>2.2. DDL语句</h3><h4 id=\"2-2-1-数据库的操作\"><a href=\"#2-2-1-数据库的操作\" class=\"headerlink\" title=\"2.2.1. 数据库的操作\"></a>2.2.1. 数据库的操作</h4><p><strong>查看当前的数据库：</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 查看所有的数据SHOW DATABASES;# 使用某一个数据USE coderhub;# 查看当前正在使用的数据库SELECT DATABASE();</code></pre>\n\n<p><strong>创建新的数据：</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 创建数据库语句CREATE DATABASE bilibili;CREATE DATABASE IF NOT EXISTS bilibili;CREATE DATABASE IF NOT EXISTS bilibili DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci;</code></pre>\n\n<p>创建数据库时，可以设置字符串和字符排序（我们可以直接使用默认的）：</p>\n<ul>\n<li>字符集：utf8mb4在我们需要插入emoji表情时要用到；</li>\n<li>排序规则：ai表示不区分重音；ci表示不区分大小写；</li>\n</ul>\n<p><img src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\" alt=\"图片\">image-20201108210407214</p>\n<p><strong>删除数据库：</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 删除数据库DROP DATABASE bilibili;DROP DATABASE IF EXIT bilibili;</code></pre>\n\n<p><strong>修改数据库：</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 修改数据库的字符集和排序规则ALTER DATABASE bilibili CHARACTER SET &#x3D; utf8 COLLATE &#x3D; utf8_unicode_ci;</code></pre>\n\n<h4 id=\"2-2-2-数据表的操作\"><a href=\"#2-2-2-数据表的操作\" class=\"headerlink\" title=\"2.2.2. 数据表的操作\"></a>2.2.2. 数据表的操作</h4><p><strong>查看数据表</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 查看所有的数据表SHOW TABLES;# 查看某一个表结构DESC user;</code></pre>\n\n<p><strong>创建数据表</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">CREATE TABLE IF NOT EXISTS &#96;users&#96;(\tname VARCHAR(20),\tage INT,\theight DOUBLE);</code></pre>\n\n<h3 id=\"2-3-创建表细节\"><a href=\"#2-3-创建表细节\" class=\"headerlink\" title=\"2.3. 创建表细节\"></a>2.3. 创建表细节</h3><h4 id=\"2-3-1-SQL数据类型\"><a href=\"#2-3-1-SQL数据类型\" class=\"headerlink\" title=\"2.3.1. SQL数据类型\"></a>2.3.1. SQL数据类型</h4><p>我们知道不同的数据会划分为不同的数据类型，在数据库中也是一样：</p>\n<ul>\n<li>MySQL支持的数据类型有：数字类型，日期和时间类型，字符串（字符和字节）类型，空间类型和 JSON数据类型。</li>\n</ul>\n<p><strong>数字类型</strong></p>\n<p>MySQL的数字类型有很多：</p>\n<ul>\n<li>整数数字类型：INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT；</li>\n</ul>\n<p><img src=\"https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuvdojjKnD58NF714kccict621PETJZSaJgOBXKPezvLSOpynauDDn3wRookibBicQwsAQmJeIwkyY16w/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1\" alt=\"图片\">整数类型</p>\n<ul>\n<li>精确数字类型：DECIMAL，NUMERIC（DECIMAL是NUMERIC的实现形式）；</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">salary DECIMAL(5,2)</code></pre>\n\n<ul>\n<li><p>浮点数字类型：FLOAT，DOUBLE</p>\n</li>\n<li><ul>\n<li>FLOAT是4个字节，DOUBLE是8个字节；</li>\n</ul>\n</li>\n</ul>\n<p><strong>日期类型</strong></p>\n<p>MySQL的日期类型也很多：</p>\n<ul>\n<li><p><code>YEAR</code>以*<code>YYYY</code>*格式显示值</p>\n</li>\n<li><ul>\n<li>范围 <code>1901</code>到<code>2155</code>，和 <code>0000</code>。</li>\n</ul>\n</li>\n<li><p><code>DATE</code>类型用于具有日期部分但没有时间部分的值：</p>\n</li>\n<li><ul>\n<li><code>DATE</code>以格式*<code>YYYY-MM-DD</code>*显示值 ；</li>\n</ul>\n</li>\n<li><p>支持的范围是 <code>&#39;1000-01-01&#39;</code> 到 <code>&#39;9999-12-31&#39;</code>；</p>\n</li>\n<li><p><code>DATETIME</code>类型用于包含日期和时间部分的值：</p>\n</li>\n<li><ul>\n<li><code>DATETIME</code>以格式’<em><code>YYYY-MM-DD hh:mm:ss</code></em>‘显示值；</li>\n</ul>\n</li>\n<li><p>支持的范围是<code>1000-01-01 00:00:00</code>到<code>9999-12-31 23:59:59</code>;</p>\n</li>\n<li><p><code>TIMESTAMP</code>数据类型被用于同时包含日期和时间部分的值：</p>\n</li>\n<li><ul>\n<li><code>TIMESTAMP</code>以格式’<em><code>YYYY-MM-DD hh:mm:ss</code></em>‘显示值；</li>\n</ul>\n</li>\n<li><p>但是它的范围是UTC的时间范围：<code>&#39;1970-01-01 00:00:01&#39;</code>到<code>&#39;2038-01-19 03:14:07&#39;</code>;</p>\n</li>\n<li><p>另外：<code>DATETIME</code>或<code>TIMESTAMP</code> 值可以包括在高达微秒（6位）精度的后小数秒一部分</p>\n</li>\n<li><ul>\n<li>比如DATETIME表示的范围可以是<code>&#39;1000-01-01 00:00:00.000000&#39;</code>到<code>&#39;9999-12-31 23:59:59.999999&#39;</code>;</li>\n</ul>\n</li>\n</ul>\n<p><strong>字符串类型</strong></p>\n<p>MySQL的字符串类型表示方式如下：</p>\n<ul>\n<li><p><code>CHAR</code>类型在创建表时为固定长度，长度可以是0到255之间的任何值；</p>\n</li>\n<li><ul>\n<li>在被查询时，会删除后面的空格；</li>\n</ul>\n</li>\n<li><p><code>VARCHAR</code>类型的值是可变长度的字符串，长度可以指定为0到65535之间的值；</p>\n</li>\n<li><ul>\n<li>在被查询时，不会删除后面的空格；</li>\n</ul>\n</li>\n<li><p><code>BINARY</code>和<code>VARBINARY</code> 类型用于存储二进制字符串，存储的是字节字符串；</p>\n</li>\n<li><ul>\n<li><a href=\"https://dev.mysql.com/doc/refman/8.0/en/binary-varbinary.html\">https://dev.mysql.com/doc/refman/8.0/en/binary-varbinary.html</a></li>\n</ul>\n</li>\n<li><p><code>BLOB</code>用于存储大的二进制类型；</p>\n</li>\n<li><p><code>TEXT</code>用于存储大的字符串类型；</p>\n</li>\n</ul>\n<h4 id=\"2-3-2-表的约束\"><a href=\"#2-3-2-表的约束\" class=\"headerlink\" title=\"2.3.2. 表的约束\"></a>2.3.2. 表的约束</h4><p><strong>主键：PRIMARY KEY</strong></p>\n<p>一张表中，我们为了区分每一条记录的唯一性，必须有一个字段是永远不会重复，并且不会为空的，这个字段我们通常会将它设置为主键：</p>\n<ul>\n<li>主键是表中唯一的索引；</li>\n<li>并且必须是NOT NULL的，如果没有设置 NOT NULL，那么MySQL也会隐式的设置为NOT NULL；</li>\n<li>主键也可以是多列索引，PRIMARY KEY(<em><code>key_part</code></em>, …)，我们一般称之为联合主键；</li>\n<li>建议：开发中主键字段应该是和业务无关的，尽量不要使用业务字段来作为主键；</li>\n</ul>\n<p><strong>唯一：UNIQUE</strong></p>\n<p>某些字段在开发中我们希望是唯一的，不会重复的，比如手机号码、身份证号码等，这个字段我们可以使用UNIQUE来约束：</p>\n<ul>\n<li>使用UNIQUE约束的字段在表中必须是不同的；</li>\n<li>对于所有引擎，<code>UNIQUE</code> 索引允许<code>NULL</code>包含的列具有多个值<code>NULL</code>。</li>\n</ul>\n<p><strong>不能为空：NOT NULL</strong></p>\n<p>某些字段我们要求用户必须插入值，不可以为空，这个时候我们可以使用 NOT NULL 来约束；</p>\n<p><strong>默认值：DEFAULT</strong></p>\n<p>某些字段我们希望在没有设置值时给予一个默认值，这个时候我们可以使用 DEFAULT来完成；</p>\n<p><strong>自动递增：AUTO_INCREMENT</strong></p>\n<p>某些字段我们希望不设置值时可以进行递增，比如用户的id，这个时候可以使用AUTO_INCREMENT来完成；</p>\n<p>外键约束也是最常用的一种约束手段，我们再讲到多表关系时，再进行讲解；</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 创建表CREATE TABLE IF NOT EXISTS &#96;users&#96;(\tid INT PRIMARY KEY AUTO_INCREMENT,\tname VARCHAR(20) NOT NULL,\tage INT DEFAULT 0,\ttelPhone VARCHAR(20) DEFAULT &#39;&#39; UNIQUE NOT NULL,\tcreateTime TIMESTAMP DEFAULT CURRENT_TIMESTAMP);</code></pre>\n\n<p><strong>删除数据表</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 删除表DROP TABLE &#96;moment&#96;;DROP TABLE IF EXISTS &#96;moment&#96;;</code></pre>\n\n<p><strong>修改数据表</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 1.修改表名ALTER TABLE &#96;moments&#96; RENAME TO &#96;moment&#96;;# 2.添加一个新的列ALTER TABLE &#96;moment&#96; ADD &#96;publishTime&#96; DATETIME;ALTER TABLE &#96;moment&#96; ADD &#96;updateTime&#96; DATETIME;# 3.删除一列数据ALTER TABLE &#96;moment&#96; DROP &#96;updateTime&#96;;# 4.修改列的名称ALTER TABLE &#96;moment&#96; CHANGE &#96;publishTime&#96; &#96;publishDate&#96; DATE;# 5.修改列的数据类型ALTER TABLE &#96;moment&#96; MODIFY &#96;id&#96; INT;</code></pre>\n\n<h3 id=\"2-3-DML语句\"><a href=\"#2-3-DML语句\" class=\"headerlink\" title=\"2.3. DML语句\"></a>2.3. DML语句</h3><p>新建一张商品表：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">CREATE TABLE IF NOT EXISTS &#96;products&#96;(\t&#96;id&#96; INT PRIMARY KEY AUTO_INCREMENT,\t&#96;title&#96; VARCHAR(20),\t&#96;description&#96; VARCHAR(200),\t&#96;price&#96; DOUBLE,\t&#96;publishTime&#96; DATETIME);</code></pre>\n\n<h4 id=\"2-3-1-插入数据\"><a href=\"#2-3-1-插入数据\" class=\"headerlink\" title=\"2.3.1. 插入数据\"></a>2.3.1. 插入数据</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">INSERT INTO &#96;products&#96; (&#96;title&#96;, &#96;description&#96;, &#96;price&#96;, &#96;publishTime&#96;) \t\t\t\t\t\t\t\tVALUES (&#39;iPhone&#39;, &#39;iPhone12只要998&#39;, 998.88, &#39;2020-10-10&#39;); INSERT INTO &#96;products&#96; (&#96;title&#96;, &#96;description&#96;, &#96;price&#96;, &#96;publishTime&#96;) \t\t\t\t\t\t\t\tVALUES (&#39;huawei&#39;, &#39;iPhoneP40只要888&#39;, 888.88, &#39;2020-11-11&#39;);</code></pre>\n\n<h4 id=\"2-3-2-删除数据\"><a href=\"#2-3-2-删除数据\" class=\"headerlink\" title=\"2.3.2. 删除数据\"></a>2.3.2. 删除数据</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\"># 删除数据# 会删除表中所有的数据DELETE FROM &#96;products&#96;;# 会删除符合条件的数据DELETE FROM &#96;products&#96; WHERE &#96;title&#96; &#x3D; &#39;iPhone&#39;;</code></pre>\n\n<h4 id=\"2-3-3-修改数据\"><a href=\"#2-3-3-修改数据\" class=\"headerlink\" title=\"2.3.3. 修改数据\"></a>2.3.3. 修改数据</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\"># 修改数据# 会修改表中所有的数据UPDATE &#96;products&#96;  SET &#96;title&#96; &#x3D; &#39;iPhone12&#39;, &#96;price&#96; &#x3D; 1299.88;# 会修改符合条件的数据UPDATE &#96;products&#96;  SET &#96;title&#96; &#x3D; &#39;iPhone12&#39;, &#96;price&#96; &#x3D; 1299.88 WHERE &#96;title&#96; &#x3D; &#39;iPhone&#39;;</code></pre>\n\n<p>如果我们希望修改完数据后，直接可以显示最新的更新时间：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">ALTER TABLE &#96;products&#96; ADD &#96;updateTime&#96; TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP;</code></pre>\n\n<h3 id=\"2-4-DQL语句\"><a href=\"#2-4-DQL语句\" class=\"headerlink\" title=\"2.4. DQL语句\"></a>2.4. DQL语句</h3><p>SELECT用于从一个或者多个表中检索选中的行（Record）。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">SELECT select_expr [, select_expr]...\t[FROM table_references]\t[WHERE where_condition]\t[ORDER expr [ASC | DESC]]\t[LIMIT &#123;[offset,] row_count | row_count OFFSET offset&#125;]\t[GROUP BY expr]\t[HAVING where_condition]</code></pre>\n\n<p>我们先准备一张表：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">CREATE TABLE IF NOT EXISTS &#96;products&#96; (\tid INT PRIMARY KEY AUTO_INCREMENT,\tbrand VARCHAR(20),\ttitle VARCHAR(100) NOT NULL,\tprice DOUBLE NOT NULL,\tscore DECIMAL(2,1),\tvoteCnt INT,\turl VARCHAR(100),\tpid INT);</code></pre>\n\n<p>我们在其中插入一些数据：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">const mysql &#x3D; require(&#39;mysql2&#39;); const connection &#x3D; mysql.createConnection(&#123;  host: &#39;localhost&#39;,  port: 3306,  user: &#39;root&#39;,  password: &#39;Coderwhy888.&#39;,  database: &#39;coderhub&#39;&#125;);const statement &#x3D; &#96;INSERT INTO products SET ?;&#96;const phoneJson &#x3D; require(&#39;.&#x2F;phone.json&#39;);for (let phone of phoneJson) &#123;  connection.query(statement, phone);&#125;</code></pre>\n\n<p><img src=\"https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuvdojjKnD58NF714kccict62t3HsvMnYVHy4GCDf3vJPwvOm3zxDMvbGXcNJcCp9dvgXkicArXOvoKg/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1\" alt=\"图片\">image-20201111103013994</p>\n<h4 id=\"2-4-1-基本查询\"><a href=\"#2-4-1-基本查询\" class=\"headerlink\" title=\"2.4.1. 基本查询\"></a>2.4.1. 基本查询</h4><p>查询所有的数据并且显示所有的字段：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">SELECT * FROM &#96;products&#96;;</code></pre>\n\n<p>查询title、brand、price：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">SELECT title, brand, price FROM &#96;products&#96;;</code></pre>\n\n<p>我们也可以给字段起别名：</p>\n<ul>\n<li>别名一般在多张表或者给客户端返回对应的key时会使用到；</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">SELECT title as t, brand as b, price as p FROM &#96;products&#96;;</code></pre>\n\n<h4 id=\"2-4-2-条件查询\"><a href=\"#2-4-2-条件查询\" class=\"headerlink\" title=\"2.4.2. 条件查询\"></a>2.4.2. 条件查询</h4><p>在开发中，我们希望根据条件来筛选我们的数据，这个时候我们要使用条件查询：</p>\n<ul>\n<li>条件查询会使用 WEHRE查询子句；</li>\n</ul>\n<p><strong>WHERE的比较运算符</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 查询价格小于1000的手机SELECT * FROM &#96;products&#96; WHERE price &lt; 1000;# 查询价格大于等于2000的手机SELECT * FROM &#96;products&#96; WHERE price &gt;&#x3D; 2000;# 价格等于3399的手机SELECT * FROM &#96;products&#96; WHERE price &#x3D; 3399;# 价格不等于3399的手机SELECT * FROM &#96;products&#96; WHERE price &#x3D; 3399;# 查询华为品牌的手机SELECT * FROM &#96;products&#96; WHERE &#96;brand&#96; &#x3D; &#39;华为&#39;;</code></pre>\n\n<p><strong>WHERE的逻辑运算符</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 查询品牌是华为，并且小于2000元的手机SELECT * FROM &#96;products&#96; WHERE &#96;brand&#96; &#x3D; &#39;华为&#39; and &#96;price&#96; &lt; 2000;SELECT * FROM &#96;products&#96; WHERE &#96;brand&#96; &#x3D; &#39;华为&#39; &amp;&amp; &#96;price&#96; &lt; 2000;# 查询1000到2000的手机（不包含1000和2000）SELECT * FROM &#96;products&#96; WHERE price &gt; 1000 and price &lt; 2000;# OR: 符合一个条件即可# 查询所有的华为手机或者价格小于1000的手机SELECT * FROM &#96;products&#96; WHERE brand &#x3D; &#39;华为&#39; or price &lt; 1000;# 查询1000到2000的手机（包含1000和2000）SELECT * FROM &#96;products&#96; WHERE price BETWEEN 1000 and 2000;# 查看多个结果中的一个SELECT * FROM &#96;products&#96; WHERE brand in (&#39;华为&#39;, &#39;小米&#39;);</code></pre>\n\n<p><strong>WHERE的模糊查询</strong></p>\n<p>模糊查询使用<code>LIKE</code>关键字，结合两个特殊的符号：</p>\n<ul>\n<li><code>%</code>表示匹配任意个的任意字符；</li>\n<li><code>_</code>表示匹配一个的任意字符；</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 查询所有以v开头的titleSELECT * FROM &#96;products&#96; WHERE title LIKE &#39;v%&#39;;# 查询带M的titleSELECT * FROM &#96;products&#96; WHERE title LIKE &#39;%M%&#39;;# 查询带M的title必须是第三个字符SELECT * FROM &#96;products&#96; WHERE title LIKE &#39;__M%&#39;;</code></pre>\n\n<h4 id=\"2-4-3-查询排序\"><a href=\"#2-4-3-查询排序\" class=\"headerlink\" title=\"2.4.3. 查询排序\"></a>2.4.3. 查询排序</h4><p>当我们查询到结果的时候，我们希望讲结果按照某种方式进行排序，这个时候使用的是<code>ORDER BY</code>；</p>\n<p><code>ORDER BY</code>有两个常用的值：</p>\n<ul>\n<li><code>ASC</code>：升序排列；</li>\n<li><code>DESC</code>：降序排列；</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">SELECT * FROM &#96;products&#96; WHERE brand &#x3D; &#39;华为&#39; or price &lt; 1000 ORDER BY price ASC;</code></pre>\n\n<h4 id=\"2-4-4-分页偏移\"><a href=\"#2-4-4-分页偏移\" class=\"headerlink\" title=\"2.4.4. 分页偏移\"></a>2.4.4. 分页偏移</h4><p>当数据库中的数据非常多时，一次性查询到所有的结果进行显示是不太现实的：</p>\n<ul>\n<li>在真实开发中，我们都会要求用户传入offset、limit或者page等字段；</li>\n<li>它们的目的是让我们可以在数据库中进行分页查询；</li>\n<li>它的用法有[LIMIT[offset,] row_countrow_count OFFSET offset]</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">SELECT * FROM &#96;products&#96; LIMIT 30 OFFSET 0;SELECT * FROM &#96;products&#96; LIMIT 30 OFFSET 30;SELECT * FROM &#96;products&#96; LIMIT 30 OFFSET 60;# 另外一种写法：offset, row_countSELECT * FROM &#96;products&#96; LIMIT 90, 30;</code></pre>\n\n<h4 id=\"2-4-5-聚合函数\"><a href=\"#2-4-5-聚合函数\" class=\"headerlink\" title=\"2.4.5. 聚合函数\"></a>2.4.5. 聚合函数</h4><p>聚合函数表示对<code>值集合</code>进行操作的组（集合）函数。</p>\n<p><img src=\"https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuvdojjKnD58NF714kccict62L8Ye2kbuDjWjdJGVgkarUaxoNDbdrtXM6Y2RcfYUQLwbjDN5vbbdNg/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1\" alt=\"图片\">聚合查询</p>\n<p>我们这里学习最常用的一些聚合函数：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 华为手机价格的平均值SELECT AVG(price) FROM &#96;products&#96; WHERE brand &#x3D; &#39;华为&#39;;# 计算所有手机的平均分SELECT AVG(score) FROM &#96;products&#96;;# 手机中最低和最高分数SELECT MAX(score) FROM &#96;products&#96;;SELECT MIN(score) FROM &#96;products&#96;;# 计算总投票人数SELECT SUM(voteCnt) FROM &#96;products&#96;;# 计算所有条目的数量SELECT COUNT(*) FROM &#96;products&#96;;# 华为手机的个数SELECT COUNT(*) FROM &#96;products&#96; WHERE brand &#x3D; &#39;华为&#39;;</code></pre>\n\n<p>事实上聚合函数相当于默认将所有的数据分成了一组：</p>\n<ul>\n<li>我们前面使用avg还是max等，都是将所有的结果看成一组来计算的；</li>\n<li>那么如果我们希望划分多个组：比如华为、苹果、小米等手机分别的平均价格，应该怎么来做呢？</li>\n<li>这个时候我们可以使用 <code>GROUP BY</code>；</li>\n</ul>\n<p><code>GROUP BY</code>通常和聚合函数一起使用：</p>\n<ul>\n<li>表示我们先对数据进行分组，再对每一组数据，进行聚合函数的计算；</li>\n</ul>\n<p>我们现在来提一个需求：</p>\n<ul>\n<li>根据品牌进行分组；</li>\n<li>计算各个品牌中商品的个数、平均价格、最高价格、最低价格、平均评分；</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">SELECT brand, \t\t\tCOUNT(*) as count, \t\t\tROUND(AVG(price),2) as avgPrice,\t\t\tMAX(price) as maxPrice,\t\t\tMIN(price) as minPrice,\t\t\tAVG(score) as avgScoreFROM &#96;products&#96; GROUP BY brand;</code></pre>\n\n<p>如果我们还希望筛选出平均价格在4000以下，并且平均分在7以上的品牌：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">SELECT brand, \t\t\tCOUNT(*) as count, \t\t\tROUND(AVG(price),2) as avgPrice,\t\t\tMAX(price) as maxPrice,\t\t\tMIN(price) as minPrice,\t\t\tAVG(score) as avgScoreFROM &#96;products&#96; GROUP BY brand HAVING avgPrice &lt; 4000 and avgScore &gt; 7;</code></pre>\n\n<h3 id=\"2-5-外键约束\"><a href=\"#2-5-外键约束\" class=\"headerlink\" title=\"2.5. 外键约束\"></a>2.5. 外键约束</h3><h4 id=\"2-5-1-创建多张表\"><a href=\"#2-5-1-创建多张表\" class=\"headerlink\" title=\"2.5.1. 创建多张表\"></a>2.5.1. 创建多张表</h4><p>假如我们的上面的商品表中，对应的品牌还需要包含其他的信息：</p>\n<ul>\n<li>比如品牌的官网，品牌的世界排名，品牌的市值等等；</li>\n</ul>\n<p>如果我们直接在商品中去体现品牌相关的信息，会存在一些问题：</p>\n<ul>\n<li>一方面，products表中应该表示的都是商品相关的数据，应该有另外一张表来表示brand的数据；</li>\n<li>另一方面，多个商品使用的品牌是一致时，会存在大量的冗余数据；</li>\n</ul>\n<p>所以，我们可以将所有的批评数据，单独放到一张表中，创建一张品牌的表：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">CREATE TABLE IF NOT EXISTS &#96;brand&#96;(\tid INT PRIMARY KEY AUTO_INCREMENT,\tname VARCHAR(20) NOT NULL,\twebsite VARCHAR(100),\tworldRank INT);</code></pre>\n\n<p>插入模拟的数据：</p>\n<ul>\n<li>这里我是刻意有一些商品数据的品牌是没有添加的；</li>\n<li>并且也可以添加了一些不存在的手机品牌；</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">INSERT INTO &#96;brand&#96; (name, website, worldRank) VALUES (&#39;华为&#39;, &#39;www.huawei.com&#39;, 1);INSERT INTO &#96;brand&#96; (name, website, worldRank) VALUES (&#39;小米&#39;, &#39;www.mi.com&#39;, 10);INSERT INTO &#96;brand&#96; (name, website, worldRank) VALUES (&#39;苹果&#39;, &#39;www.apple.com&#39;, 5);INSERT INTO &#96;brand&#96; (name, website, worldRank) VALUES (&#39;oppo&#39;, &#39;www.oppo.com&#39;, 15);INSERT INTO &#96;brand&#96; (name, website, worldRank) VALUES (&#39;京东&#39;, &#39;www.jd.com&#39;, 3);INSERT INTO &#96;brand&#96; (name, website, worldRank) VALUES (&#39;Google&#39;, &#39;www.google.com&#39;, 8);</code></pre>\n\n<h4 id=\"2-5-2-创建外键\"><a href=\"#2-5-2-创建外键\" class=\"headerlink\" title=\"2.5.2. 创建外键\"></a>2.5.2. 创建外键</h4><p>我们先给<code>products</code>添加一个<code>brand_id</code>字段：</p>\n<p>将两张表联系起来，我们可以将<code>products</code>中的<code>brand_id</code>关联到<code>brand</code>中的<code>id</code>：</p>\n<ul>\n<li><p>如果是创建表添加外键约束：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">FOREIGN KEY (brand_id) REFERENCES brand(id)</code></pre>\n</li>\n<li><p>如果是表已经创建好，额外添加外键：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">ALTER TABLE &#96;products&#96; ADD FOREIGN KEY (brand_id) REFERENCES brand(id);</code></pre></li>\n</ul>\n<p>现在我们可以将<code>products</code>中的<code>brand_id</code>关联到<code>brand</code>中的<code>id</code>的值：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">UPDATE &#96;products&#96; SET &#96;brand_id&#96; &#x3D; 1 WHERE &#96;brand&#96; &#x3D; &#39;华为&#39;;UPDATE &#96;products&#96; SET &#96;brand_id&#96; &#x3D; 4 WHERE &#96;brand&#96; &#x3D; &#39;OPPO&#39;;UPDATE &#96;products&#96; SET &#96;brand_id&#96; &#x3D; 3 WHERE &#96;brand&#96; &#x3D; &#39;苹果&#39;;UPDATE &#96;products&#96; SET &#96;brand_id&#96; &#x3D; 2 WHERE &#96;brand&#96; &#x3D; &#39;小米&#39;;</code></pre>\n\n<h4 id=\"2-5-3-删除和更新\"><a href=\"#2-5-3-删除和更新\" class=\"headerlink\" title=\"2.5.3. 删除和更新\"></a>2.5.3. 删除和更新</h4><p>我们来思考一个问题：</p>\n<ul>\n<li>如果<code>products</code>中引用的外键被更新了或者删除了，这个时候会出现什么情况呢？</li>\n</ul>\n<p>我们来进行一个更新操作：比如将华为的id更新为100</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">UPDATE &#96;brand&#96; SET id &#x3D; 100 WHERE id &#x3D; 1;</code></pre>\n\n<p>这个时候执行代码是报错的：</p>\n<p><img src=\"https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuvdojjKnD58NF714kccict62s4NqCyOHNHzI33dvsnSaKZmI3FeOoGvmwUpL1ric8ibYZCl8xiawqGVfg/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1\" alt=\"图片\">不可以更新和删除，因为有一个外键引用</p>\n<p>如果我希望可以更新呢？我们可以给更新时设置几个值：</p>\n<ul>\n<li><p>RESTRICT（默认属性）：当更新或删除某个记录时，会检查该记录是否有关联的外键记录，有的话会报错的，不允许更新或删除；</p>\n</li>\n<li><p>NO ACTION：和RESTRICT是一致的，是在SQL标准中定义的；</p>\n</li>\n<li><p>CASCADE：当更新或删除某个记录时，会检查该记录是否有关联的外键记录，有的话：</p>\n</li>\n<li><ul>\n<li>更新：那么会更新对应的记录；</li>\n</ul>\n</li>\n<li><p>删除：那么关联的记录会被一起删除掉；</p>\n</li>\n<li><p>SET NULL：当更新或删除某个记录时，会检查该记录是否有关联的外键记录，有的话，将对应的值设置为NULL；</p>\n</li>\n</ul>\n<p><strong>如果修改外键的更新时的动作呢？</strong></p>\n<p>第一步：查看表结构：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 执行命令SHOW CREATE TABLE &#96;products&#96;;# 结果如下：CREATE TABLE &#96;products&#96; (  &#96;id&#96; int NOT NULL AUTO_INCREMENT,  &#96;brand&#96; varchar(20) DEFAULT NULL,  &#96;title&#96; varchar(100) NOT NULL,  &#96;price&#96; double NOT NULL,  &#96;score&#96; decimal(2,1) DEFAULT NULL,  &#96;voteCnt&#96; int DEFAULT NULL,  &#96;url&#96; varchar(100) DEFAULT NULL,  &#96;pid&#96; int DEFAULT NULL,  &#96;brand_id&#96; int DEFAULT NULL,  PRIMARY KEY (&#96;id&#96;),  KEY &#96;brand_id&#96; (&#96;brand_id&#96;),  CONSTRAINT &#96;products_ibfk_1&#96; FOREIGN KEY (&#96;brand_id&#96;) REFERENCES &#96;brand&#96; (&#96;id&#96;)) ENGINE&#x3D;InnoDB AUTO_INCREMENT&#x3D;109 DEFAULT CHARSET&#x3D;utf8mb4 COLLATE&#x3D;utf8mb4_0900_ai_ci</code></pre>\n\n<p>这个时候，我们可以知道外键的名称是<code>products_ibfk_1</code>。</p>\n<p>第二步：删除之前的外键</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">ALTER TABLE &#96;products&#96; DROP FOREIGN KEY products_ibfk_1;</code></pre>\n\n<p>第三步：添加新的外键，并且设置新的action</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">ALTER TABLE &#96;products&#96; ADD FOREIGN KEY (brand_id) REFERENCES brand(id) ON UPDATE CASCADE ON DELETE CASCADE;</code></pre>\n\n<h3 id=\"2-6-多表查询\"><a href=\"#2-6-多表查询\" class=\"headerlink\" title=\"2.6. 多表查询\"></a>2.6. 多表查询</h3><h4 id=\"2-6-1-多表查询\"><a href=\"#2-6-1-多表查询\" class=\"headerlink\" title=\"2.6.1. 多表查询\"></a>2.6.1. 多表查询</h4><p>如果我们希望查询到产品的同时，显示对应的品牌相关的信息，因为数据是存放在两张表中，所以这个时候就需要进行多表查询。</p>\n<p>如果我们直接通过查询语句希望在多张表中查询到数据，这个时候是什么效果呢？</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">SELECT * FROM &#96;products&#96;, &#96;brand&#96;;</code></pre>\n\n<p><img src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\" alt=\"图片\">查询结果</p>\n<p>我们会发现一共有648条数据，这个数据量是如何得到的呢？</p>\n<ul>\n<li>第一张表的108条 * 第二张表的6条数据；</li>\n<li>也就是说第一张表中每一个条数据，都会和第二张表中的每一条数据结合一次；</li>\n<li>这个结果我们称之为 <code>笛卡尔乘积</code>，也称之为<code>直积</code>，表示为 X*Y；</li>\n</ul>\n<p>但是事实上很多的数据是没有意义的，比如华为和苹果、小米的品牌结合起来的数据就是没有意义的，我们可不可以进行筛选呢？</p>\n<ul>\n<li>使用where来进行筛选；</li>\n<li>这个表示查询到笛卡尔乘积后的结果中，符合<code>products.brand_id = brand.id</code>条件的数据过滤出来；</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">SELECT * FROM &#96;products&#96;, &#96;brand&#96; WHERE &#96;products&#96;.brand_id &#x3D; &#96;brand&#96;.id;</code></pre>\n\n<p>事实上我们想要的效果并不是这样的，而且表中的某些特定的数据，这个时候我们可以使用 SQL JOIN 操作：</p>\n<ul>\n<li>左连接</li>\n<li>右连接</li>\n<li>内连接</li>\n<li>全连接</li>\n</ul>\n<p><img src=\"https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuvdojjKnD58NF714kccict62ib7r5wOcXJmB58QP8ERVO3TCwV0ft7wEfHibfQ2Wvh7YKibJQdsSnXcGw/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1\" alt=\"图片\">SQL JOIN</p>\n<h4 id=\"2-6-2-左连接\"><a href=\"#2-6-2-左连接\" class=\"headerlink\" title=\"2.6.2. 左连接\"></a>2.6.2. 左连接</h4><p>如果我们希望获取到的是左边所有的数据（以左表为主）：</p>\n<ul>\n<li>这个时候就表示无论左边的表是否有对应的<code>brand_id</code>的值对应右边表的<code>id</code>，左边的数据都会被查询出来；</li>\n<li>这个也是开发中使用最多的情况，它的完整写法是<code>LEFT [OUTER] JOIN</code>，但是OUTER可以省略的；</li>\n</ul>\n<p><img src=\"https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuvdojjKnD58NF714kccict62mWOib1xbOuvoQUlV8paKuIgqzyp1SnGTetngQiavKSj5DUwabkJibsWfQ/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1\" alt=\"图片\"></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">SELECT * FROM &#96;products&#96; LEFT JOIN &#96;brand&#96; ON &#96;products&#96;.brand_id &#x3D; &#96;brand&#96;.id;</code></pre>\n\n<p>如果我们查询的是左连接部分中，和右表无关的数据：</p>\n<ul>\n<li>也非常简单，只需要加上一个条件即可：B表中的数据为空</li>\n</ul>\n<p><img src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\" alt=\"图片\"></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">SELECT * FROM &#96;products&#96; LEFT JOIN &#96;brand&#96; ON &#96;products&#96;.brand_id &#x3D; &#96;brand&#96;.id WHERE brand.id IS NULL;</code></pre>\n\n<h4 id=\"2-6-3-右连接\"><a href=\"#2-6-3-右连接\" class=\"headerlink\" title=\"2.6.3. 右连接\"></a>2.6.3. 右连接</h4><p>如果我们希望获取到的是右边所有的数据（以由表为主）：</p>\n<p><img src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\" alt=\"图片\"></p>\n<ul>\n<li>这个时候就表示无论左边的表中的<code>brand_id</code>是否有和右边表中的<code>id</code>对应，右边的数据都会被查询出来；</li>\n<li>右连接在开发中没有左连接常用，它的完整写法是<code>RIGHT [OUTER] JOIN</code>，但是OUTER可以省略的；</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">SELECT * FROM &#96;products&#96; RIGHT JOIN &#96;brand&#96; ON &#96;products&#96;.brand_id &#x3D; &#96;brand&#96;.id;</code></pre>\n\n<p>如果我们查询的是右连接部分中，和左表无关的数据：</p>\n<ul>\n<li>也非常简单，只需要加上一个条件即可：A表中的数据为空；</li>\n</ul>\n<p><img src=\"https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuvdojjKnD58NF714kccict62hAq5L2QQXPu7HZJG7oM9JAmR92pSJBsvlmKIE8D1s8DtUJLthJWoNg/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1\" alt=\"图片\"></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">SELECT * FROM &#96;products&#96; RIGHT JOIN &#96;brand&#96; ON &#96;products&#96;.brand_id &#x3D; &#96;brand&#96;.id WHERE products.id IS NULL;</code></pre>\n\n<h4 id=\"2-6-4-内连接\"><a href=\"#2-6-4-内连接\" class=\"headerlink\" title=\"2.6.4. 内连接\"></a>2.6.4. 内连接</h4><p>事实上内连接是表示左边的表和右边的表都有对应的数据关联：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">SELECT * FROM &#96;products&#96; INNER JOIN &#96;brand&#96; ON &#96;products&#96;.brand_id &#x3D; &#96;brand&#96;.id;</code></pre>\n\n<p>我们会发现它和之前的下面写法是一样的效果：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">SELECT * FROM &#96;products&#96;, &#96;brand&#96; WHERE &#96;products&#96;.brand_id &#x3D; &#96;brand&#96;.id;</code></pre>\n\n<p>但是他们代表的含义并不相同：</p>\n<ul>\n<li>SQL语句一：内连接，代表的是在两张表连接时就会约束数据之间的关系，来决定之后查询的结果；</li>\n<li>SQL语句二：where条件，代表的是先计算出笛卡尔乘积，在笛卡尔乘积的数据基础之上进行where条件的筛选；</li>\n</ul>\n<p>内连接在开发中偶尔也会常见使用，看自己的场景。</p>\n<p>内连接有其他的写法：<code>CROSS JOIN</code>或者 <code>JOIN</code>都可以；</p>\n<h4 id=\"2-6-5-全连接\"><a href=\"#2-6-5-全连接\" class=\"headerlink\" title=\"2.6.5. 全连接\"></a>2.6.5. 全连接</h4><p>SQL规范中全连接是使用FULL JOIN，但是MySQL中并没有对它的支持，我们需要使用 UNION 来实现：</p>\n<p><img src=\"https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuvdojjKnD58NF714kccict627x26F7vljAQ0icOfTINFSqFhoAAT0rQgadHCuPHPvTBmnnElCAl3rnQ/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1\" alt=\"图片\"></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">(SELECT * FROM &#96;products&#96; LEFT JOIN &#96;brand&#96; ON &#96;products&#96;.brand_id &#x3D; &#96;brand&#96;.id)UNION(SELECT * FROM &#96;products&#96; RIGHT JOIN &#96;brand&#96; ON &#96;products&#96;.brand_id &#x3D; &#96;brand&#96;.id);</code></pre>\n\n<p>如果我们希望查询的是下面的结果：</p>\n<p><img src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\" alt=\"图片\"></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">(SELECT * FROM &#96;products&#96; LEFT JOIN &#96;brand&#96; ON &#96;products&#96;.brand_id &#x3D; &#96;brand&#96;.id WHERE &#96;brand&#96;.id IS NULL)UNION(SELECT * FROM &#96;products&#96; RIGHT JOIN &#96;brand&#96; ON &#96;products&#96;.brand_id &#x3D; &#96;brand&#96;.id WHERE &#96;products&#96;.id IS NULL);</code></pre>\n\n<h3 id=\"2-7-多对多关系\"><a href=\"#2-7-多对多关系\" class=\"headerlink\" title=\"2.7. 多对多关系\"></a>2.7. 多对多关系</h3><h4 id=\"2-7-1-准备多张表\"><a href=\"#2-7-1-准备多张表\" class=\"headerlink\" title=\"2.7.1. 准备多张表\"></a>2.7.1. 准备多张表</h4><p>在开发中我们还会遇到多对多的关系：</p>\n<ul>\n<li>比如学生可以选择多门课程，一个课程可以被多个学生选择；</li>\n<li>这种情况我们应该在开发中如何处理呢？</li>\n</ul>\n<p>这个时候我们通常是会建三张表来建立它们之间的关系的：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 创建学生表CREATE TABLE IF NOT EXISTS &#96;students&#96;(\tid INT PRIMARY KEY AUTO_INCREMENT,\tname VARCHAR(20) NOT NULL,\tage INT);# 创建课程表CREATE TABLE IF NOT EXISTS &#96;courses&#96;(\tid INT PRIMARY KEY AUTO_INCREMENT,\tname VARCHAR(20) NOT NULL,\tprice DOUBLE NOT NULL);</code></pre>\n\n<p>我们在两张表中插入一些数据：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">INSERT INTO &#96;students&#96; (name, age) VALUES(&#39;why&#39;, 18);INSERT INTO &#96;students&#96; (name, age) VALUES(&#39;tom&#39;, 22);INSERT INTO &#96;students&#96; (name, age) VALUES(&#39;lilei&#39;, 25);INSERT INTO &#96;students&#96; (name, age) VALUES(&#39;lucy&#39;, 16);INSERT INTO &#96;students&#96; (name, age) VALUES(&#39;lily&#39;, 20);INSERT INTO &#96;courses&#96; (name, price) VALUES (&#39;英语&#39;, 100);INSERT INTO &#96;courses&#96; (name, price) VALUES (&#39;语文&#39;, 666);INSERT INTO &#96;courses&#96; (name, price) VALUES (&#39;数学&#39;, 888);INSERT INTO &#96;courses&#96; (name, price) VALUES (&#39;历史&#39;, 80);</code></pre>\n\n<h4 id=\"2-7-2-创建关系表\"><a href=\"#2-7-2-创建关系表\" class=\"headerlink\" title=\"2.7.2. 创建关系表\"></a>2.7.2. 创建关系表</h4><p>我们需要一个关系表来记录两张表中的数据关系：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 创建关系表CREATE TABLE IF NOT EXISTS &#96;students_select_courses&#96;(\tid INT PRIMARY KEY AUTO_INCREMENT,\tstudent_id INT NOT NULL,\tcourse_id INT NOT NULL,\tFOREIGN KEY (student_id) REFERENCES students(id) ON UPDATE CASCADE,\tFOREIGN KEY (course_id) REFERENCES courses(id) ON UPDATE CASCADE);</code></pre>\n\n<p>我们插入一些数据：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># why 选修了 英文和数学INSERT INTO &#96;students_select_courses&#96; (student_id, course_id) VALUES (1, 1);INSERT INTO &#96;students_select_courses&#96; (student_id, course_id) VALUES (1, 3);# lilei选修了 语文和数学和历史INSERT INTO &#96;students_select_courses&#96; (student_id, course_id) VALUES (3, 2);INSERT INTO &#96;students_select_courses&#96; (student_id, course_id) VALUES (3, 3);INSERT INTO &#96;students_select_courses&#96; (student_id, course_id) VALUES (3, 4);</code></pre>\n\n<h4 id=\"2-7-3-多表数据查询\"><a href=\"#2-7-3-多表数据查询\" class=\"headerlink\" title=\"2.7.3. 多表数据查询\"></a>2.7.3. 多表数据查询</h4><p>查询多条数据：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 查询所有的学生选择的所有课程SELECT \tstu.id studentId, stu.name studentName, cs.id courseId, cs.name courseName, cs.price coursePrice FROM &#96;students&#96; stu JOIN &#96;students_select_courses&#96; ssc \tON stu.id &#x3D; ssc.student_id JOIN &#96;courses&#96; cs \tON ssc.course_id &#x3D; cs.id; # 查询所有的选手选课情况SELECT \tstu.id studentId, stu.name studentName, cs.id courseId, cs.name courseName, cs.price coursePrice FROM &#96;students&#96; stu LEFT JOIN &#96;students_select_courses&#96; ssc \tON stu.id &#x3D; ssc.student_id LEFT JOIN &#96;courses&#96; cs \tON ssc.course_id &#x3D; cs.id;</code></pre>\n\n<p>查询单个学生的课程：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># why同学选择了哪些课程SELECT \tstu.id studentId, stu.name studentName, cs.id courseId, cs.name courseName, cs.price coursePrice FROM &#96;students&#96; stu JOIN &#96;students_select_courses&#96; ssc \tON stu.id &#x3D; ssc.student_id JOIN &#96;courses&#96; cs \tON ssc.course_id &#x3D; cs.id \tWHERE stu.id &#x3D; 1; # lily同学选择了哪些课程SELECT \tstu.id studentId, stu.name studentName, cs.id courseId, cs.name courseName, cs.price coursePrice FROM &#96;students&#96; stu LEFT JOIN &#96;students_select_courses&#96; ssc \tON stu.id &#x3D; ssc.student_id LEFT JOIN &#96;courses&#96; cs \tON ssc.course_id &#x3D; cs.id \tWHERE stu.id &#x3D; 5;</code></pre>\n\n<p>查询哪些学生没有选择和哪些课程没有被选择：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 哪些学生是没有选课的SELECT \tstu.id studentId, stu.name studentName, cs.id courseId, cs.name courseName, cs.price coursePrice FROM &#96;students&#96; stuLEFT JOIN &#96;students_select_courses&#96; ssc\tON stu.id &#x3D; ssc.student_idLEFT JOIN &#96;courses&#96; cs\tON ssc.course_id &#x3D; cs.id\tWHERE cs.id IS NULL;# 查询哪些课程没有被学生选择SELECT \tstu.id studentId, stu.name studentName, cs.id courseId, cs.name courseName, cs.price coursePrice FROM &#96;students&#96; stuRIGHT JOIN &#96;students_select_courses&#96; ssc\tON stu.id &#x3D; ssc.student_idRIGHT JOIN &#96;courses&#96; cs\tON ssc.course_id &#x3D; cs.id\tWHERE stu.id IS NULL;</code></pre>\n\n<h2 id=\"Node操作MySQL\"><a href=\"#Node操作MySQL\" class=\"headerlink\" title=\"Node操作MySQL\"></a>Node操作MySQL</h2><h3 id=\"3-1-对象和数组\"><a href=\"#3-1-对象和数组\" class=\"headerlink\" title=\"3.1.对象和数组\"></a>3.1.对象和数组</h3><h4 id=\"3-1-1-一对多-对象\"><a href=\"#3-1-1-一对多-对象\" class=\"headerlink\" title=\"3.1.1. 一对多 - 对象\"></a>3.1.1. 一对多 - 对象</h4><p>前面我们学习的查询语句，查询到的结果通常是一张表，比如查询手机+品牌信息：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">SELECT * FROM products LEFT JOIN brand ON products.brand_id &#x3D; brand.id;</code></pre>\n\n<p><img src=\"https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuvdojjKnD58NF714kccict62q9MKZf1ENmyg00mlTLh9kSnLODiaBSia8h2jPicMib9eZFmDcXibp4IJROw/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1\" alt=\"图片\">查询结果</p>\n<p>但是在真实开发中，实际上红色圈起来的部分应该放入到一个对象中，那么我们可以使用下面的查询方式：</p>\n<ul>\n<li>这个时候我们要用 <code>JSON_OBJECT</code>;</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">SELECT products.id as id, products.title as title, products.price as price, products.score as score, \t\t\t\tJSON_OBJECT(&#39;id&#39;, brand.id, &#39;name&#39;, brand.name, &#39;rank&#39;, brand.phoneRank, &#39;website&#39;, brand.website) as brandFROM products LEFT JOIN brand ON products.brand_id &#x3D; brand.id;</code></pre>\n\n<p><img src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\" alt=\"图片\">查询结果</p>\n<h4 id=\"3-1-2-多对多-数组\"><a href=\"#3-1-2-多对多-数组\" class=\"headerlink\" title=\"3.1.2. 多对多 - 数组\"></a>3.1.2. 多对多 - 数组</h4><p>在多对多关系中，我们希望查询到的是一个数组：</p>\n<ul>\n<li>比如一个学生的多门课程信息，应该是放到一个数组中的；</li>\n<li>数组中存放的是课程信息的一个个对象；</li>\n<li>这个时候我们要 <code>JSON_ARRAYAGG</code>和<code>JSON_OBJECT</code>结合来使用；</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">SELECT stu.id, stu.name, stu.age, \t\t   JSON_ARRAYAGG(JSON_OBJECT(&#39;id&#39;, cs.id, &#39;name&#39;, cs.name)) as courses FROM students stuLEFT JOIN students_select_courses ssc ON stu.id &#x3D; ssc.student_idLEFT JOIN courses cs ON ssc.course_id &#x3D; cs.idGROUP BY stu.id;</code></pre>\n\n<p><img src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\" alt=\"图片\">查询结果</p>\n<h3 id=\"3-2-mysql2的使用\"><a href=\"#3-2-mysql2的使用\" class=\"headerlink\" title=\"3.2. mysql2的使用\"></a>3.2. mysql2的使用</h3><h4 id=\"3-2-1-认识mysql2\"><a href=\"#3-2-1-认识mysql2\" class=\"headerlink\" title=\"3.2.1. 认识mysql2\"></a>3.2.1. 认识mysql2</h4><p>前面我们所有的操作都是在GUI工具中，通过执行SQL语句来获取结果的，那真实开发中肯定是通过代码来完成所有的操作的。</p>\n<p>那么如何可以在Node的代码中执行SQL语句来，这里我们可以借助于两个库：</p>\n<ul>\n<li>mysql：最早的Node连接MySQL的数据库驱动；</li>\n<li>mysql2：在mysql的基础之上，进行了很多的优化、改进；</li>\n</ul>\n<p>目前相对来说，我更偏向于使用mysql2，mysql2兼容mysql的API，并且提供了一些附加功能</p>\n<ul>\n<li><p>更快&#x2F;更好的性能；</p>\n</li>\n<li><p>Prepared Statement（预编译语句）：</p>\n</li>\n<li><ul>\n<li>提高性能：将创建的语句模块发送给MySQL，然后MySQL编译（解析、优化、转换）语句模块，并且存储它但是不执行，之后我们在真正执行时会给<code>?</code>提供实际的参数才会执行；就算多次执行，也只会编译一次，所以性能是更高的；</li>\n</ul>\n</li>\n<li><p>防止SQL注入：之后传入的值不会像模块引擎那样就编译，那么一些SQL注入的内容不会被执行；<code>or 1 = 1</code>不会被执行；</p>\n</li>\n<li><p>支持Promise，所以我们可以使用async和await语法</p>\n</li>\n<li><p>等等….</p>\n</li>\n</ul>\n<p>所以后续的学习中我会选择mysql2在node中操作数据。</p>\n<p><strong>安装</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">npm install mysql2</code></pre>\n\n<h4 id=\"3-2-2-mysql2基本使用\"><a href=\"#3-2-2-mysql2基本使用\" class=\"headerlink\" title=\"3.2.2. mysql2基本使用\"></a>3.2.2. mysql2基本使用</h4><p>mysql2的使用过程如下：</p>\n<ul>\n<li>第一步：创建连接（通过createConnection），并且获取连接对象；</li>\n<li>第二步：执行SQL语句即可（通过query）；</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">const mysql &#x3D; require(&#39;mysql2&#39;);&#x2F;&#x2F; 创建连接const connection &#x3D; mysql.createConnection(&#123;  host: &#39;localhost&#39;,  database: &#39;coderhub&#39;,  user: &#39;root&#39;,  password: &#39;Coderwhy888.&#39;&#125;);&#x2F;&#x2F; 执行SQL语句connection.query(&#39;SELECT title, price FROM products WHERE price &gt; 9000;&#39;, (err, results, fields) &#x3D;&gt; &#123;  console.log(err);  console.log(&#39;----------&#39;);  console.log(results);  console.log(&#39;----------&#39;);  console.log(fields);&#125;)</code></pre>\n\n<p>通常我们的连接建立之后是不会轻易断开的，因为我们需要这个连接持续帮助我们查询客户端过来的请求。</p>\n<p>但是如果我们确实希望断开连接，可以使用 <code>end</code> 方法：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">connection.end();</code></pre>\n\n<h4 id=\"3-2-3-预编译语句\"><a href=\"#3-2-3-预编译语句\" class=\"headerlink\" title=\"3.2.3. 预编译语句\"></a>3.2.3. 预编译语句</h4><p>Prepared Statement（预编译语句）：</p>\n<ul>\n<li>提高性能：将创建的语句模块发送给MySQL，然后MySQL编译（解析、优化、转换）语句模块，并且存储它但是不执行，之后我们在真正执行时会给<code>?</code>提供实际的参数才会执行；就算多次执行，也只会编译一次，所以性能是更高的；</li>\n<li>防止SQL注入：之后传入的值不会像模块引擎那样就编译，那么一些SQL注入的内容不会被执行；<code>or 1 = 1</code>不会被执行；</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">const statement &#x3D; &#39;SELECT * FROM products WHERE price &gt; ? and brand &#x3D; ?;&#39;;connection.execute(statement, [1000, &#39;华为&#39;], (err, results) &#x3D;&gt; &#123;  console.log(results);&#125;);</code></pre>\n\n<p>强调：如果再次执行该语句，它将会从LRU（Least Recently Used） Cache中获取获取，省略了编译statement的时间来提高性能。</p>\n<h4 id=\"3-2-4-连接池\"><a href=\"#3-2-4-连接池\" class=\"headerlink\" title=\"3.2.4. 连接池\"></a>3.2.4. 连接池</h4><p>前面我们是创建了一个连接（connection），但是如果我们有多个请求的话，该连接很有可能正在被占用，那么我们是否需要每次一个请求都去创建一个新的连接呢？</p>\n<ul>\n<li>事实上，mysql2给我们提供了连接池（connection pools）；</li>\n<li>连接池可以在需要的时候自动创建连接，并且创建的连接不会被销毁，会放到连接池中，后续可以继续使用；</li>\n<li>我们可以在创建连接池的时候设置LIMIT，也就是最大创建个数；</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">const mysql &#x3D; require(&#39;mysql2&#39;);const pool &#x3D; mysql.createPool(&#123;  host: &#39;localhost&#39;,  database: &#39;coderhub&#39;,  user: &#39;root&#39;,  password: &#39;Coderwhy888.&#39;,  connectionLimit: 10&#125;);const statement &#x3D; &#39;SELECT * FROM products WHERE price &gt; ? and brand &#x3D; ?;&#39;;pool.execute(statement, [1000, &#39;华为&#39;], (err, results) &#x3D;&gt; &#123;  console.log(results);&#125;);</code></pre>\n\n<p>为什么Node执行JavaScript时单线程的，还需要连接池呢？</p>\n<ul>\n<li>这是因为Node中操作数据库，本质上是通过Libuv进行了的数据库操作；</li>\n<li>而在libuv中是可以有多个线程的，多个线程也是可以同时去建立连接来操作数据库的；</li>\n</ul>\n<h4 id=\"3-2-5-promises\"><a href=\"#3-2-5-promises\" class=\"headerlink\" title=\"3.2.5. promises\"></a>3.2.5. promises</h4><p>目前在JavaScript开发中我们更习惯Promise和await、async的方式，mysql2同样是支持的：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">const mysql &#x3D; require(&#39;mysql2&#39;);const pool &#x3D; mysql.createPool(&#123;  host: &#39;localhost&#39;,  database: &#39;coderhub&#39;,  user: &#39;root&#39;,  password: &#39;Coderwhy888.&#39;,  connectionLimit: 5&#125;);const statement &#x3D; &#39;SELECT * FROM products WHERE price &gt; ? and brand &#x3D; ?;&#39;;pool.promise().execute(statement, [1000, &#39;华为&#39;]).then(([results]) &#x3D;&gt; &#123;  console.log(results);&#125;);</code></pre>\n\n<h3 id=\"3-3-ORM的sequelize\"><a href=\"#3-3-ORM的sequelize\" class=\"headerlink\" title=\"3.3. ORM的sequelize\"></a>3.3. ORM的sequelize</h3><h4 id=\"3-3-1-认识ORM\"><a href=\"#3-3-1-认识ORM\" class=\"headerlink\" title=\"3.3.1. 认识ORM\"></a>3.3.1. 认识ORM</h4><p><strong>对象关系映射</strong>（英语：<strong>Object Relational Mapping</strong>，简称<strong>ORM</strong>，或<strong>O&#x2F;RM</strong>，或<strong>O&#x2F;R mapping</strong>），是一种程序设计的方案：</p>\n<ul>\n<li>从效果上来讲，它提供了一个可在编程语言中，使用 <code>虚拟对象数据库</code> 的效果；</li>\n<li>比如在Java开发中经常使用的ORM包括：Hibernate、MyBatis；</li>\n</ul>\n<p>Node当中的ORM我们通常使用的是 <code>sequelize</code>;</p>\n<ul>\n<li>Sequelize是用于Postgres，MySQL，MariaDB，SQLite和Microsoft SQL Server的基于Node.js 的 ORM；</li>\n<li>它支持非常多的功能；</li>\n</ul>\n<p>如果我们希望将Sequelize和MySQL一起使用，那么我们需要先安装两个东西：</p>\n<ul>\n<li>mysql2：sequelize在操作mysql时使用的是mysql2；</li>\n<li>sequelize：使用它来让对象映射到表中；</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">npm install sequelize mysql2</code></pre>\n\n<h4 id=\"3-3-2-Sequelize的使用\"><a href=\"#3-3-2-Sequelize的使用\" class=\"headerlink\" title=\"3.3.2. Sequelize的使用\"></a>3.3.2. Sequelize的使用</h4><p>Sequelize的连接数据库：</p>\n<ul>\n<li>第一步：创建一个Sequelize的对象，并且制定数据库、用户名、密码、数据库类型、主机地址等；</li>\n<li>第二步：测试连接是否成功；</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">const &#123;Sequelize, DataTypes, Model, Op&#125; &#x3D; require(&#39;sequelize&#39;);const sequelize &#x3D; new Sequelize(&#39;coderhub&#39;, &#39;root&#39;, &#39;Coderwhy888.&#39;, &#123;  host: &#39;localhost&#39;,  dialect: &#39;mysql&#39;&#125;);sequelize.authenticate().then(() &#x3D;&gt; &#123;  console.log(&quot;sequelize连接成功~&quot;);&#125;).catch(err &#x3D;&gt; &#123;  console.log(&quot;sequlize连接失败~&quot;, err);&#125;);</code></pre>\n\n<p>Sequelize映射关系表：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">class Student extends Model &#123;&#125;Student.init(&#123;  id: &#123;    type: DataTypes.INTEGER,    primaryKey: true,    autoIncrement: true  &#125;,  name: &#123;    type: DataTypes.STRING,    allowNull: false  &#125;,  age: DataTypes.INTEGER&#125;, &#123;  sequelize,  createdAt: false,  updatedAt: false&#125;)</code></pre>\n\n<p>测试增删改查的操作：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">async function queryStudent() &#123;  &#x2F;&#x2F; 1.查询所有的学生  const result1 &#x3D; await Student.findAll(&#123;&#125;);  console.log(result1);  &#x2F;&#x2F; 2.查询年龄大于等于20岁的学生  const result2 &#x3D; await Student.findAll(&#123;    where: &#123;      age: &#123;        [Op.gte]: 20      &#125;    &#125;  &#125;);  console.log(result2);  &#x2F;&#x2F; 3.创建用户  const result3 &#x3D; await Student.create(&#123;    name: &#39;hmm&#39;,    age: 22  &#125;);  console.log(result3);  &#x2F;&#x2F; 4.更新用户  const result4 &#x3D; await Student.update(&#123;    age: 25  &#125;, &#123;    where: &#123;      id: 6    &#125;  &#125;);  console.log(result4);&#125;queryStudent();</code></pre>\n\n<h4 id=\"3-3-3-多对多关系\"><a href=\"#3-3-3-多对多关系\" class=\"headerlink\" title=\"3.3.3. 多对多关系\"></a>3.3.3. 多对多关系</h4><p>第一步：连接数据库</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">const &#123; Sequelize, DataTypes, Model, Op &#125; &#x3D; require(&#39;sequelize&#39;);const sequelize &#x3D; new Sequelize(&#39;coderhub&#39;, &#39;root&#39;, &#39;Coderwhy888.&#39;, &#123;  host: &#39;localhost&#39;,  dialect: &#39;mysql&#39;&#125;);</code></pre>\n\n<p>第二步：创建映射关系</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">class Student extends Model &#123;&#125;Student.init(&#123;  id: &#123;    type: DataTypes.INTEGER,    primaryKey: true,    autoIncrement: true  &#125;,  name: &#123;    type: DataTypes.STRING,    allowNull: false  &#125;,  age: DataTypes.INTEGER&#125;, &#123;  sequelize,  createdAt: false,  updatedAt: false&#125;)class Course extends Model &#123;&#125;Course.init(&#123;  id: &#123;    type: DataTypes.INTEGER,    primaryKey: true,    autoIncrement: true  &#125;,  name: &#123;    type: DataTypes.STRING(20),    allowNull: false  &#125;,  price: &#123;    type: DataTypes.DOUBLE,    allowNull: false  &#125;&#125;, &#123;  sequelize,  createdAt: false,  updatedAt: false&#125;);class StudentCourse extends Model &#123;&#125;;StudentCourse.init(&#123;  id: &#123;    type: DataTypes.INTEGER,    primaryKey: true,    autoIncrement: true  &#125;,  studentId: &#123;    type: DataTypes.INTEGER,    references: &#123;      model: Student,      key: &#39;id&#39;    &#125;,    field: &#39;student_id&#39;,  &#125;,  courseId: &#123;    type: DataTypes.INTEGER,    references: &#123;      model: Course,      key: &#39;id&#39;    &#125;,    field: &#39;course_id&#39;,  &#125;&#125;, &#123;  sequelize,  createdAt: false,  updatedAt: false,  tableName: &#39;students_select_courses&#39;&#125;);</code></pre>\n\n<p>第三步：建立多对多的联系</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Student.belongsToMany(Course, &#123;  through: StudentCourse,   foreignKey: &#39;student_id&#39;,   otherKey: &#39;course_id&#39;,&#125;);Course.belongsToMany(Student, &#123;  through: StudentCourse,   foreignKey: &#39;course_id&#39;,   otherKey: &#39;student_id&#39;&#125;);</code></pre>\n\n<p>第四步：执行多对多查询操作：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">async function queryStudent() &#123;  &#x2F;&#x2F; 查询结果  const result &#x3D; await Student.findAll(&#123;    include: &#123;      model: Course    &#125;</code></pre>\n\n<h1 id=\"http协议\"><a href=\"#http协议\" class=\"headerlink\" title=\"http协议\"></a>http协议</h1><pre class=\"line-numbers language-none\"><code class=\"language-none\">1.超文本传输协议\n规定了如何从网站服务器传输超文本到本地浏览器,基于客户端服务器架构工作,是客户端和服务器端请求和应答标准\n\n2.报文   过程中传递的数据块\n请求报文:1.请求方式 req.method获取请求方式   GET POST\n\t\t2.请求地址 req.url获取请求地址\n\t\t3.请求报文 req.headers[&#39;键名&#39;]获取请求报文\n\t\t\n请求组成:请求行 方式 资源 协议版本\n\t\t请求头 键值对\n\t\t请求体 post有请求参数 get请求参数不在请求体中,在url地址后面\n\t\t\n\n响应报文:1.http状态码   200成功 404没找到 500服务器端错误 400客户端请求语法错\n\t\t2.内容类型 text&#x2F;html text&#x2F;css application&#x2F;javascript image&#x2F;jpeg application&#x2F;json\n\t\t3. 内容长度 内容..\n\t\tres.writeHead(状态码,&#123;&#39;content-type&#39;:&#39;text&#x2F;plain&#39;&#125;) 内容类型默认纯文本\n\t\tres.end(&#39;...&#39;)响应内容\n\t\t\n响应组成:响应行 http协议 状态码 其他状态码(成功2xx 重定向 3xx 客户端4xx 服务器端错误5xx)\n\t\t响应头 键值对\n\t\t响应体 post有请求参数 get请求参数不在请求体中,在url地址后面</code></pre>\n\n<h3 id=\"http请求与响应处理\"><a href=\"#http请求与响应处理\" class=\"headerlink\" title=\"http请求与响应处理\"></a>http请求与响应处理</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">8种请求方式 OPTIONS HEAD  GET POST PUT DELETE TRACE \n\n请求参数GET\n使用url模块,用于处理url地址   \nurl.parse(req.url) 返回一个对象\nurl.parse(req.url,true)把查询参数解析成对象\nurl.parse(req.url,true).query得到这个对象  通过这个对象.键名得到参数值\n\n解构赋值 &#123; query, pathname&#125; &#x3D; url.parse(req.url,true) 得到参数对象和请求地址</code></pre>\n\n<h3 id=\"window释放端口\"><a href=\"#window释放端口\" class=\"headerlink\" title=\"window释放端口\"></a>window释放端口</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">1.cmd\n2.netstat -ano | findstr 9090 查询端口9090使用情况\n3.tasklist | findstr +进程ID  查询端口被进程占用的程序\n4.taskkill &#x2F;f &#x2F;t &#x2F;im  +进程ID或程序  杀死进程</code></pre>\n\n<h1 id=\"NPM\"><a href=\"#NPM\" class=\"headerlink\" title=\"NPM\"></a>NPM</h1><h2 id=\"npm常用命令\"><a href=\"#npm常用命令\" class=\"headerlink\" title=\"npm常用命令\"></a>npm常用命令</h2><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"># 临时\n$ npm --registry https:&#x2F;&#x2F;registry.npm.taobao.org install 插件名\n# 配置\n$ npm config set registry https:&#x2F;&#x2F;registry.npm.taobao.org\n\n# 查看 npm 的版本 \n$ npm -v  \n# 查看各个命令的简单用法\n$ npm -l \n# 查看 npm 命令列表\n$ npm help\n# 查看 npm 的配置\n$ npm config list -l\n# 查看插件的版本\nnpm view 插件名 versions\n# 创建模块\nnpm init\n#当前项目安装的所有模块\n$npm list\n#列出全局安装的模块 带上[--depth 0] 不深入到包的支点 更简洁\n$ npm list -g --depth 0\n\n# 读取package.json里面的配置单安装  \n$ npm install \n&#x2F;&#x2F;可简写成 npm i\n\n# 默认安装指定模块的最新(@latest)版本\n$ npm install [&lt;@scope&gt;&#x2F;]&lt;name&gt; \n&#x2F;&#x2F;eg:npm install gulp\n\n# 安装指定模块的指定版本\n$ npm install [&lt;@scope&gt;&#x2F;]&lt;name&gt;@&lt;version&gt;\n&#x2F;&#x2F;eg: npm install gulp@3.9.1\n\n# 安装指定指定版本范围内的模块\n$ npm install [&lt;@scope&gt;&#x2F;]&lt;name&gt;@&lt;version range&gt;\n&#x2F;&#x2F;eg: npm install vue@&quot;&gt;&#x3D;1.0.28 &lt; 2.0.0&quot;\n\n# 安装指定模块的指定标签 默认值为(@latest)\n$ npm install [&lt;@scope&gt;&#x2F;]&lt;name&gt;@&lt;tag&gt;\n&#x2F;&#x2F;eg:npm install sax@0.1.1\n\n# 通过Github代码库地址安装\n$ npm install &lt;tarball url&gt;\n&#x2F;&#x2F;eg:npm install git:&#x2F;&#x2F;github.com&#x2F;package&#x2F;path.git\n\n#卸载当前项目或全局模块 \n$ npm uninstall &lt;name&gt; [-g] \n\n#升级当前项目或全局的指定模块\n$ npm update &lt;name&gt; [-g]\n\n# 引用依赖 有些包是全局安装了，在项目里面只需要引用即可。\n$ npm link [&lt;@scope&gt;&#x2F;]&lt;pkg&gt;[@&lt;version&gt;]\n&#x2F;&#x2F;eg: 引用   npm link gulp gulp-ssh gulp-ftp\n&#x2F;&#x2F;eg: 解除引用 npm unlink gulp\n\n# 未注册 申请注册一个用户 直接在https:&#x2F;&#x2F;www.npmjs.com&#x2F;注册一样\n$ npm adduser\n&#x2F;&#x2F;执行后 填写几个问题 Username、Password、Email\n\n#已注册\n$ npm login \n\n#发布\n$ npm publish</code></pre>\n\n<h2 id=\"NPM私库搭建\"><a href=\"#NPM私库搭建\" class=\"headerlink\" title=\"NPM私库搭建\"></a>NPM私库搭建</h2><h3 id=\"npm-git\"><a href=\"#npm-git\" class=\"headerlink\" title=\"npm+git\"></a>npm+git</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">1.新建私有git仓库\n2.clone仓库\n3.npm init\n4.按npm规范开发完。push到仓库即可</code></pre>\n\n<p>verdaccio(<a href=\"https://www.jianshu.com/p/0c905e4a8b70\">https://www.jianshu.com/p/0c905e4a8b70</a>)</p>\n<h3 id=\"云服务器安装node环境-nginx\"><a href=\"#云服务器安装node环境-nginx\" class=\"headerlink\" title=\"云服务器安装node环境,nginx\"></a>云服务器安装node环境,nginx</h3><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>1 云服务器安装verdaccio(轻量级开源私有npm代理注册表)<br>npm i verdaccio -g</p></blockquote>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>2 启动服务：<br>verdaccio</p></blockquote>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>3 配置config.yaml</p></blockquote>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">1、vim &#x2F;home&#x2F;yg&#x2F;.config&#x2F;verdaccio&#x2F;config.yaml 进入编辑配置文件\n\n# This is the default config file. It allows all users to do anything,\n# so don&#39;t use it on production systems.\n#\n# Look here for more config file examples:\n# https:&#x2F;&#x2F;github.com&#x2F;verdaccio&#x2F;verdaccio&#x2F;tree&#x2F;master&#x2F;conf\n#\n\n# path to a directory with all packages\n# 所有包缓存的目录\nstorage: .&#x2F;storage\n# path to a directory with plugins to include\n# 插件目录\nplugins: .&#x2F;plugins\n\n# 开启web服务，能够通过web访问\nweb:\n  # WebUI is enabled as default, if you want disable it, just uncomment this line\n  #enable: false\n  title: Verdaccio\n\n# 验证信息\nauth:\n  htpasswd:\n    # 用户信息存储目录\n    file: .&#x2F;htpasswd\n    # Maximum amount of users allowed to register, defaults to &quot;+inf&quot;.\n    # You can set this to -1 to disable registration.\n    #max_users: 1000\n\n# a list of other known repositories we can talk to\n# 公有仓库配置\nuplinks:\n  npmjs:\n    url: https:&#x2F;&#x2F;registry.npmjs.org&#x2F;\n\npackages:\n  &#39;@*&#x2F;*&#39;:\n    # scoped packages\n    access: $all\n    publish: $authenticated\n    # 代理，表示没有的仓库去这个npmjs里边去找\n    # npmjs 又指向 https:&#x2F;&#x2F;registry.npmjs.org&#x2F; ,就是上面的 uplinks 配置\n    proxy: npmjs\n\n  &#39;**&#39;:\n    # allow all users (including non-authenticated users) to read and\n    # publish all packages\n    #\n    # you can specify usernames&#x2F;groupnames (depending on your auth plugin)\n    # and three keywords: &quot;$all&quot;, &quot;$anonymous&quot;, &quot;$authenticated&quot;\n    # 三种身份所有人，匿名用户，认证（登录用户）\n    # 是否可访问所需的权限\n    access: $all\n\n    # allow all known users to publish packages\n    # (anyone can register by default, remember?)\n    # 发布package的权限\n    publish: $authenticated\n\n    # if package is not available locally, proxy requests to &#39;npmjs&#39; registry\n    # 如果package不存在，就向代理的上游服务器发起请求\n    proxy: npmjs\n\n# To use &#96;npm audit&#96; uncomment the following section\nmiddlewares:\n  audit:\n    enabled: true\n\n# 监听端口，重点，不配置这个只能本机可以访问\nlisten: 0.0.0.0:4873\n\n# log settings\nlogs:\n  - &#123;type: stdout, format: pretty, level: http&#125;\n  #- &#123;type: file, path: verdaccio.log, level: info&#125;</code></pre>\n\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>4.启动  pm2 start verdaccio   这是后就可以通过<a href=\"http://xxx(ip地址)去访问了/\">http://xxx（ip地址）去访问了</a></p></blockquote>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>5.如何使用</p></blockquote>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">#当前npm 服务指向本地 \nnpm set registry http:&#x2F;&#x2F;localhost:4873\n# 注册用户 在本地注册一个用户然后指向我们的地址然后我们就可以发布包了\nnpm adduser --registry http:&#x2F;&#x2F;xxx:4873\nUsername: xxx\nPassword: xxx\nPassword:  xxx\nEmail: (this IS public) xxx\nLogged in as yg-ui on http:&#x2F;&#x2F;xxx&#x2F; （你的ip地址）这时候我们就注册一个用户，我们可以用这个用户名和密码去登录去上图窗口去登录</code></pre>\n\n<ul>\n<li><h6 id=\"与私服连接\"><a href=\"#与私服连接\" class=\"headerlink\" title=\"与私服连接\"></a>与私服连接</h6></li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">npm set registry http:&#x2F;&#x2F;xxx：4873 (失败试试：npm config set registry http:&#x2F;&#x2F;xxx:4873 ，然后查看是否配置成功npm config edit）\n把下载镜像源的地址切换到从我们的服务器上下载。这里的npmrc文件里面内地址也就会易主</code></pre>\n\n<ul>\n<li><h6 id=\"安装nrm\"><a href=\"#安装nrm\" class=\"headerlink\" title=\"安装nrm\"></a>安装nrm</h6></li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">nrm是 npm registry 管理工具, 能够查看和切换当前使用的registry。不安装也可以，安装会更高效。\n1、安装 npm install -g nrm\n2、添加私服地址到nrm管理工具\n\n3、这里的 yg-ui是我们给自己的私服地址起的别名，为了切换和使用方便。\n   nrm add yg-ui http:&#x2F;&#x2F;xxx:4873 成功后如下\n     add registry my50 success\n4、将npm包的下载地址改到my50的私服。\n   nrm use yg-ui 成功后如下\n     verb config Skipping project config: &#x2F;home&#x2F;yg&#x2F;.npmrc.\n     Registry has been set to: http:&#x2F;&#x2F;xxx:4873&#x2F;\n5、使用nrm ls可查到我们可以使用的所有镜像源地址，* 后面是当前使用的，如果我们不想从私服上下载包，就可以用上一步骤的nrm use命令，use其它的地址，将下载地址改到别的服务器。\n   \n   输入 nrm ls 成功后如下\n   npm ---- https:&#x2F;&#x2F;registry.npmjs.org&#x2F;\n   cnpm --- http:&#x2F;&#x2F;r.cnpmjs.org&#x2F;\n   taobao - https:&#x2F;&#x2F;registry.npm.taobao.org&#x2F;\n   nj ----- https:&#x2F;&#x2F;registry.nodejitsu.com&#x2F;\n   rednpm - http:&#x2F;&#x2F;registry.mirror.cqupt.edu.cn&#x2F;\n   npmMirror  https:&#x2F;&#x2F;skimdb.npmjs.com&#x2F;registry&#x2F;\n   edunpm - http:&#x2F;&#x2F;registry.enpmjs.org&#x2F; \n   * yg-ui --- http:&#x2F;&#x2F;xxx:4873&#x2F;\n\n   其实nrm只是个npm registry 管理工具，有了它可以让我们切换和查看registry 地址更方便快捷，即便没有它，我们直接用npm的set命令也可以切换地址，用type命令也可以查看地址，只不过用nrm更便捷，用不用随你了，觉得方便就用。</code></pre>\n\n<ul>\n<li><h6 id=\"发布包\"><a href=\"#发布包\" class=\"headerlink\" title=\"发布包\"></a>发布包</h6></li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">1、新建一个npmtest 目录，里边放一个文件\n2、进入目录 npm init 生成package.json\n3、npm publish           # 第二次发包已经切换到我们私服地址的情况下\n   npm publish --registry http:&#x2F;&#x2F;xxx:4873   #未切换到我们的私服时，直接加后缀可以发布到私服上。\n  第二次发包我们需要npm login 输入用户密码以及邮箱即可（这里需要注意的是</code></pre>\n\n<ul>\n<li><h6 id=\"下载包\"><a href=\"#下载包\" class=\"headerlink\" title=\"下载包\"></a>下载包</h6></li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">1、新建.npmrc文件\n   registry&#x3D;http:&#x2F;&#x2F;xxx:4873&#x2F;#&#x2F;detail&#x2F;ui-test\n   &#x2F;&#x2F;xxx&#x2F;:_authToken&#x3D;&quot;EF+Q227aTInBu2cvmkDyiozkm&#x2F;Z&#x2F;nOz9m1mWK&#x2F;PlgoA&#x3D;&quot;\n   &#x2F;&#x2F;localhost:4873&#x2F;:_authToken&#x3D;&quot;OTmT9IjKXStdvRwV8RRf6g&#x3D;&#x3D;&quot;\n   package-lock&#x3D;false\n   npm config edit  可以查看到_authToken\n2、npm install npmtest --save\n\n   这个命令是默认下载当前定位文件夹下package.json文件中需要的所有包，包括其间接依赖的包。第一次下载\n\n   之后的包都会缓存在我们的私服上，然后后期下载的时候从私服下载，就不会再从npmjs上下载包，但是它下\n\n   载每个包的时候都会再走一遍npmjs去检查包的版本，即便不下载资源，但这无疑也浪费了时间。经验证发\n\n   现，我们的package-lock.json文件在此刻起了大作用，因为package-lock.json文件本来就是更新node库后自\n\n   动生成的文件，里面包含了node库中所有包的下载地址当前版本以及包之间的依赖关系，既然package-\n\n   lock.json稳定了版本，所以当我们项目中包含了这个文件时，我们下包时就会根据package-lock.json的稳定版\n\n   本来，就不会再去npmjs上去检查了，这样会极大的提升下载包的速度。所以项目中一定要有稳定的\n\n   package.json和package-lock.json文件，并及时更新这两个文件。\n   package.json里边配置\n   &quot;publishConfig&quot;: &#123;\n     &quot;registry&quot;: &quot;http:&#x2F;&#x2F;xxx&#x2F;repository&#x2F;npmself&#x2F;&quot;\n   &#125;,</code></pre>\n\n<ul>\n<li><h6 id=\"删除包\"><a href=\"#删除包\" class=\"headerlink\" title=\"删除包\"></a>删除包</h6></li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">$ cd &#x2F;home&#x2F;yg&#x2F;.config&#x2F;verdaccio\n$ ls \nconfig.yaml  htpasswd  storage\n$ cd storage\n$ ls\n$ rm -rf  ui-test</code></pre>\n\n","text":"十二.数据库MySQL认识数据库1.1. 为什么要使用数据库任何的软件系统都需要存放大量的数据，这些数据通常是非常复杂和庞大的： 比如用户信息包括姓名、年龄、性别、地址、身份证号、出生日期等等； 比如商品信息包括商品的名称、描述、价格（原价）、分类标签、商品图片等等； 比如歌曲信...","link":"","photos":[],"count_time":{"symbolsCount":"39k","symbolsTime":"35 mins."},"categories":[{"name":"Node","slug":"Node","count":12,"path":"api/categories/Node.json"}],"tags":[{"name":"Node Node基础系列","slug":"Node-Node基础系列","count":12,"path":"api/tags/Node-Node基础系列.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%8D%81%E4%BA%8C-%E6%95%B0%E6%8D%AE%E5%BA%93MySQL\"><span class=\"toc-text\">十二.数据库MySQL</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%AE%A4%E8%AF%86%E6%95%B0%E6%8D%AE%E5%BA%93\"><span class=\"toc-text\">认识数据库</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-1-%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E4%BD%BF%E7%94%A8%E6%95%B0%E6%8D%AE%E5%BA%93\"><span class=\"toc-text\">1.1. 为什么要使用数据库</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-2-%E5%B8%B8%E8%A7%81%E7%9A%84%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9C%89%E5%93%AA%E4%BA%9B%EF%BC%9F\"><span class=\"toc-text\">1.2. 常见的数据库有哪些？</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-3-MySQL%E7%9A%84%E4%B8%8B%E8%BD%BD%E5%92%8C%E5%AE%89%E8%A3%85\"><span class=\"toc-text\">1.3. MySQL的下载和安装</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-4-mysql%E7%9A%84%E8%BF%9E%E6%8E%A5%E5%92%8C%E6%93%8D%E4%BD%9C\"><span class=\"toc-text\">1.4. mysql的连接和操作</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#1-4-1-%E7%BB%88%E7%AB%AF%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93\"><span class=\"toc-text\">1.4.1. 终端连接数据库</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#1-4-2-%E7%BB%88%E7%AB%AF%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E5%BA%93\"><span class=\"toc-text\">1.4.2. 终端操作数据库</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-5-GUI%E5%B7%A5%E5%85%B7%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E5%BA%93\"><span class=\"toc-text\">1.5. GUI工具操作数据库</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#SQL%E8%AF%AD%E5%8F%A5\"><span class=\"toc-text\">SQL语句</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-1-%E8%AE%A4%E8%AF%86SQL%E8%AF%AD%E5%8F%A5\"><span class=\"toc-text\">2.1. 认识SQL语句</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-2-DDL%E8%AF%AD%E5%8F%A5\"><span class=\"toc-text\">2.2. DDL语句</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-2-1-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E6%93%8D%E4%BD%9C\"><span class=\"toc-text\">2.2.1. 数据库的操作</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-2-2-%E6%95%B0%E6%8D%AE%E8%A1%A8%E7%9A%84%E6%93%8D%E4%BD%9C\"><span class=\"toc-text\">2.2.2. 数据表的操作</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-3-%E5%88%9B%E5%BB%BA%E8%A1%A8%E7%BB%86%E8%8A%82\"><span class=\"toc-text\">2.3. 创建表细节</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-3-1-SQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B\"><span class=\"toc-text\">2.3.1. SQL数据类型</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-3-2-%E8%A1%A8%E7%9A%84%E7%BA%A6%E6%9D%9F\"><span class=\"toc-text\">2.3.2. 表的约束</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-3-DML%E8%AF%AD%E5%8F%A5\"><span class=\"toc-text\">2.3. DML语句</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-3-1-%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE\"><span class=\"toc-text\">2.3.1. 插入数据</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-3-2-%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE\"><span class=\"toc-text\">2.3.2. 删除数据</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-3-3-%E4%BF%AE%E6%94%B9%E6%95%B0%E6%8D%AE\"><span class=\"toc-text\">2.3.3. 修改数据</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-4-DQL%E8%AF%AD%E5%8F%A5\"><span class=\"toc-text\">2.4. DQL语句</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-4-1-%E5%9F%BA%E6%9C%AC%E6%9F%A5%E8%AF%A2\"><span class=\"toc-text\">2.4.1. 基本查询</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-4-2-%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A2\"><span class=\"toc-text\">2.4.2. 条件查询</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-4-3-%E6%9F%A5%E8%AF%A2%E6%8E%92%E5%BA%8F\"><span class=\"toc-text\">2.4.3. 查询排序</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-4-4-%E5%88%86%E9%A1%B5%E5%81%8F%E7%A7%BB\"><span class=\"toc-text\">2.4.4. 分页偏移</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-4-5-%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0\"><span class=\"toc-text\">2.4.5. 聚合函数</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-5-%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F\"><span class=\"toc-text\">2.5. 外键约束</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-5-1-%E5%88%9B%E5%BB%BA%E5%A4%9A%E5%BC%A0%E8%A1%A8\"><span class=\"toc-text\">2.5.1. 创建多张表</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-5-2-%E5%88%9B%E5%BB%BA%E5%A4%96%E9%94%AE\"><span class=\"toc-text\">2.5.2. 创建外键</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-5-3-%E5%88%A0%E9%99%A4%E5%92%8C%E6%9B%B4%E6%96%B0\"><span class=\"toc-text\">2.5.3. 删除和更新</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-6-%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2\"><span class=\"toc-text\">2.6. 多表查询</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-6-1-%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2\"><span class=\"toc-text\">2.6.1. 多表查询</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-6-2-%E5%B7%A6%E8%BF%9E%E6%8E%A5\"><span class=\"toc-text\">2.6.2. 左连接</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-6-3-%E5%8F%B3%E8%BF%9E%E6%8E%A5\"><span class=\"toc-text\">2.6.3. 右连接</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-6-4-%E5%86%85%E8%BF%9E%E6%8E%A5\"><span class=\"toc-text\">2.6.4. 内连接</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-6-5-%E5%85%A8%E8%BF%9E%E6%8E%A5\"><span class=\"toc-text\">2.6.5. 全连接</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-7-%E5%A4%9A%E5%AF%B9%E5%A4%9A%E5%85%B3%E7%B3%BB\"><span class=\"toc-text\">2.7. 多对多关系</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-7-1-%E5%87%86%E5%A4%87%E5%A4%9A%E5%BC%A0%E8%A1%A8\"><span class=\"toc-text\">2.7.1. 准备多张表</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-7-2-%E5%88%9B%E5%BB%BA%E5%85%B3%E7%B3%BB%E8%A1%A8\"><span class=\"toc-text\">2.7.2. 创建关系表</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-7-3-%E5%A4%9A%E8%A1%A8%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2\"><span class=\"toc-text\">2.7.3. 多表数据查询</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Node%E6%93%8D%E4%BD%9CMySQL\"><span class=\"toc-text\">Node操作MySQL</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#3-1-%E5%AF%B9%E8%B1%A1%E5%92%8C%E6%95%B0%E7%BB%84\"><span class=\"toc-text\">3.1.对象和数组</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#3-1-1-%E4%B8%80%E5%AF%B9%E5%A4%9A-%E5%AF%B9%E8%B1%A1\"><span class=\"toc-text\">3.1.1. 一对多 - 对象</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#3-1-2-%E5%A4%9A%E5%AF%B9%E5%A4%9A-%E6%95%B0%E7%BB%84\"><span class=\"toc-text\">3.1.2. 多对多 - 数组</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#3-2-mysql2%E7%9A%84%E4%BD%BF%E7%94%A8\"><span class=\"toc-text\">3.2. mysql2的使用</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#3-2-1-%E8%AE%A4%E8%AF%86mysql2\"><span class=\"toc-text\">3.2.1. 认识mysql2</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#3-2-2-mysql2%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8\"><span class=\"toc-text\">3.2.2. mysql2基本使用</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#3-2-3-%E9%A2%84%E7%BC%96%E8%AF%91%E8%AF%AD%E5%8F%A5\"><span class=\"toc-text\">3.2.3. 预编译语句</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#3-2-4-%E8%BF%9E%E6%8E%A5%E6%B1%A0\"><span class=\"toc-text\">3.2.4. 连接池</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#3-2-5-promises\"><span class=\"toc-text\">3.2.5. promises</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#3-3-ORM%E7%9A%84sequelize\"><span class=\"toc-text\">3.3. ORM的sequelize</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#3-3-1-%E8%AE%A4%E8%AF%86ORM\"><span class=\"toc-text\">3.3.1. 认识ORM</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#3-3-2-Sequelize%E7%9A%84%E4%BD%BF%E7%94%A8\"><span class=\"toc-text\">3.3.2. Sequelize的使用</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#3-3-3-%E5%A4%9A%E5%AF%B9%E5%A4%9A%E5%85%B3%E7%B3%BB\"><span class=\"toc-text\">3.3.3. 多对多关系</span></a></li></ol></li></ol></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#http%E5%8D%8F%E8%AE%AE\"><span class=\"toc-text\">http协议</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#http%E8%AF%B7%E6%B1%82%E4%B8%8E%E5%93%8D%E5%BA%94%E5%A4%84%E7%90%86\"><span class=\"toc-text\">http请求与响应处理</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#window%E9%87%8A%E6%94%BE%E7%AB%AF%E5%8F%A3\"><span class=\"toc-text\">window释放端口</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#NPM\"><span class=\"toc-text\">NPM</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#npm%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4\"><span class=\"toc-text\">npm常用命令</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#NPM%E7%A7%81%E5%BA%93%E6%90%AD%E5%BB%BA\"><span class=\"toc-text\">NPM私库搭建</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#npm-git\"><span class=\"toc-text\">npm+git</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%AE%89%E8%A3%85node%E7%8E%AF%E5%A2%83-nginx\"><span class=\"toc-text\">云服务器安装node环境,nginx</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-6\"><a class=\"toc-link\" href=\"#%E4%B8%8E%E7%A7%81%E6%9C%8D%E8%BF%9E%E6%8E%A5\"><span class=\"toc-text\">与私服连接</span></a></li><li class=\"toc-item toc-level-6\"><a class=\"toc-link\" href=\"#%E5%AE%89%E8%A3%85nrm\"><span class=\"toc-text\">安装nrm</span></a></li><li class=\"toc-item toc-level-6\"><a class=\"toc-link\" href=\"#%E5%8F%91%E5%B8%83%E5%8C%85\"><span class=\"toc-text\">发布包</span></a></li><li class=\"toc-item toc-level-6\"><a class=\"toc-link\" href=\"#%E4%B8%8B%E8%BD%BD%E5%8C%85\"><span class=\"toc-text\">下载包</span></a></li><li class=\"toc-item toc-level-6\"><a class=\"toc-link\" href=\"#%E5%88%A0%E9%99%A4%E5%8C%85\"><span class=\"toc-text\">删除包</span></a></li></ol></li></ol></li></ol></li></ol></li></ol>","author":{"name":"ChrisWood","slug":"blog-author","avatar":"https://chriswood-blog.oss-cn-shanghai.aliyuncs.com/me/avatar.png","link":"/","description":"Think like an artist, code like an artisan.","socials":{"github":"https://github.com/chriswoodcn","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"Mysql基础","uid":"e92c64341ee2ef385eda6a1d1f832be9","slug":"mysql/base/Mysql基础","date":"2022-10-01T04:55:09.000Z","updated":"2023-06-14T00:11:57.238Z","comments":true,"path":"api/articles/mysql/base/Mysql基础.json","keywords":"chriswood blogs sharing","cover":null,"text":"Mysql常见数据库 MYSQL：开源免费的数据库，小型的数据库.已经被Oracle收购了.MySQL6.x版本也开始收费。 Oracle：收费的大型数据库，Oracle公司的产品。Oracle收购SUN公司，收购MYSQL。 DB2 ：IBM公司的数据库产品,收费的。常应用在银...","link":"","photos":[],"count_time":{"symbolsCount":"12k","symbolsTime":"11 mins."},"categories":[{"name":"Mysql","slug":"Mysql","count":1,"path":"api/categories/Mysql.json"}],"tags":[{"name":"Mysql","slug":"Mysql","count":1,"path":"api/tags/Mysql.json"}],"author":{"name":"ChrisWood","slug":"blog-author","avatar":"https://chriswood-blog.oss-cn-shanghai.aliyuncs.com/me/avatar.png","link":"/","description":"Think like an artist, code like an artisan.","socials":{"github":"https://github.com/chriswoodcn","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"Node基础十一","uid":"52153482f8bb5490978c774dade2918c","slug":"node/base/Node基础十一","date":"2022-10-01T04:31:50.000Z","updated":"2023-06-14T00:11:57.238Z","comments":true,"path":"api/articles/node/base/Node基础十一.json","keywords":"chriswood blogs sharing","cover":[],"text":"十一.koa开发web服务器Koa初体验1.1. 认识Koa前面我们已经学习了express，另外一个非常流行的Node Web服务器框架就是Koa。 Koa官方的介绍： koa：next generation web framework for node.js； koa：nod...","link":"","photos":[],"count_time":{"symbolsCount":"11k","symbolsTime":"10 mins."},"categories":[{"name":"Node","slug":"Node","count":12,"path":"api/categories/Node.json"}],"tags":[{"name":"Node Node基础系列","slug":"Node-Node基础系列","count":12,"path":"api/tags/Node-Node基础系列.json"}],"author":{"name":"ChrisWood","slug":"blog-author","avatar":"https://chriswood-blog.oss-cn-shanghai.aliyuncs.com/me/avatar.png","link":"/","description":"Think like an artist, code like an artisan.","socials":{"github":"https://github.com/chriswoodcn","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}