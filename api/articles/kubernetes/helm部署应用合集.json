{"title":"helm部署应用合集","uid":"4d398ce32dbbfc73e15b107a6fa1ca0a","slug":"kubernetes/helm部署应用合集","date":"2023-08-16T06:05:21.000Z","updated":"2023-08-17T02:24:27.210Z","comments":true,"path":"api/articles/kubernetes/helm部署应用合集.json","keywords":"chriswood blogs sharing","cover":null,"content":"<h2 id=\"helm部署pxc-db\"><a href=\"#helm部署pxc-db\" class=\"headerlink\" title=\"helm部署pxc-db\"></a>helm部署pxc-db</h2><p>pxc-operator: <a href=\"https://artifacthub.io/packages/helm/percona/pxc-operator\">https://artifacthub.io/packages/helm/percona/pxc-operator</a><br>pxc-db: <a href=\"https://artifacthub.io/packages/helm/percona/pxc-db\">https://artifacthub.io/packages/helm/percona/pxc-db</a></p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">helm repo add percona https:&#x2F;&#x2F;percona.github.io&#x2F;percona-helm-charts\nhelm repo update\nhelm install mysql-pxc-op percona&#x2F;pxc-operator --namespace db --create-namespace\ntouch pxc-mysql.values.yaml\nhelm install -f pxc-mysql.values.yaml mysql-pxc-db percona&#x2F;pxc-db --namespace db --create-namespace</code></pre>\n<p>pxc-mysql.values.yaml<br>具体配置项目见官网描述(Custom Resource options reference): <a href=\"https://docs.percona.com/percona-operator-for-mysql/pxc/operator.html\">https://docs.percona.com/percona-operator-for-mysql/pxc/operator.html</a></p>\n<pre class=\"line-numbers language-yaml\" data-language=\"yaml\"><code class=\"language-yaml\"># Default values for pxc-cluster.\n# This is a YAML-formatted file.\n# Declare variables to be passed into your templates.\n\nfinalizers:\n  - delete-pxc-pods-in-order\n## Set this if you want to delete proxysql persistent volumes on cluster deletion\n  - delete-proxysql-pvc\n## Set this if you want to delete database persistent volumes on cluster deletion\n#  - delete-pxc-pvc\n## Set this if you want to delete cert manager certificates on cluster deletion\n#  - delete-ssl\n\nnameOverride: &quot;&quot;\nfullnameOverride: &quot;&quot;\n\noperatorImageRepository: percona&#x2F;percona-xtradb-cluster-operator\n\ncrVersion: 1.13.0\nignoreAnnotations: []\n  # - iam.amazonaws.com&#x2F;role\nignoreLabels: []\n  # - rack\npause: false\ninitImage: &quot;&quot;\nallowUnsafeConfigurations: false\nupdateStrategy: SmartUpdate\nupgradeOptions:\n  versionServiceEndpoint: https:&#x2F;&#x2F;check.percona.com\n  apply: disabled\n  schedule: &quot;0 4 * * *&quot;\nenableCRValidationWebhook: false\ntls: &#123;&#125;\n  # SANs:\n  #   - pxc-1.example.com\n  #   - pxc-2.example.com\n  #   - pxc-3.example.com\n  # issuerConf:\n  #   name: special-selfsigned-issuer\n  #   kind: ClusterIssuer\n  #   group: cert-manager.io\n\npxc:\n  size: 3\n  image:\n    repository: percona&#x2F;percona-xtradb-cluster\n    tag: 8.0.32\n  # imagePullPolicy: Always\n  autoRecovery: true\n  # expose:\n  #   enabled: true\n  #   type: LoadBalancer\n  #   trafficPolicy: Local\n  #   loadBalancerSourceRanges:\n  #   - 10.0.0.0&#x2F;8\n  #   annotations:\n  #     networking.gke.io&#x2F;load-balancer-type: &quot;Internal&quot;\n  # replicationChannels:\n  # - name: pxc1_to_pxc2\n  #   isSource: true\n  # - name: pxc2_to_pxc1\n  #   isSource: false\n  #   configuration:\n  #     sourceRetryCount: 3\n  #     sourceConnectRetry: 60\n  #     ssl: false\n  #     sslSkipVerify: true\n  #     ca: &#39;&#x2F;etc&#x2F;mysql&#x2F;ssl&#x2F;ca.crt&#39;\n  #   sourcesList:\n  #   - host: 10.95.251.101\n  #     port: 3306\n  #     weight: 100\n  # schedulerName: mycustom-scheduler\n  imagePullSecrets: []\n  # - name: private-registry-credentials\n  annotations: &#123;&#125;\n  #  iam.amazonaws.com&#x2F;role: role-arn\n  labels: &#123;&#125;\n  #  rack: rack-22\n  # priorityClassName: high-priority\n  readinessDelaySec: 15\n  livenessDelaySec: 300\n  ## Uncomment to pass in a mysql config file\n  # configuration: |\n  #   [mysqld]\n  #   wsrep_debug&#x3D;ON\n  #   wsrep_provider_options&#x3D;&quot;gcache.size&#x3D;1G; gcache.recover&#x3D;yes&quot;\n  # envVarsSecret: my-env-var-secrets\n  resources:\n    requests:\n      memory: 1G\n      cpu: 600m\n    limits: &#123;&#125;\n      # memory: 1G\n      # cpu: 600m\n  # runtimeClassName: image-rc\n  sidecars: []\n  sidecarVolumes: []\n  sidecarPVCs: []\n  sidecarResources:\n    requests: &#123;&#125;\n    limits: &#123;&#125;\n  nodeSelector: &#123;&#125;\n  #  disktype: ssd\n  affinity:\n    antiAffinityTopologyKey: &quot;none&quot;\n    # advanced:\n    #   nodeAffinity:\n    #     requiredDuringSchedulingIgnoredDuringExecution:\n    #       nodeSelectorTerms:\n    #       - matchExpressions:\n    #         - key: kubernetes.io&#x2F;e2e-az-name\n    #           operator: In\n    #           values:\n    #           - e2e-az1\n    #           - e2e-az2\n  tolerations: []\n    # - key: &quot;node.alpha.kubernetes.io&#x2F;unreachable&quot;\n    #   operator: &quot;Exists&quot;\n    #   effect: &quot;NoExecute&quot;\n    #   tolerationSeconds: 6000\n  gracePeriod: 600\n  podDisruptionBudget:\n    # only one of maxUnavailable or minAvaliable can be set\n    maxUnavailable: 1\n    # minAvailable: 0\n  persistence:\n    enabled: true\n    ## percona data Persistent Volume Storage Class\n    ## If defined, storageClassName: &lt;storageClass&gt;\n    ## If set to &quot;-&quot;, storageClassName: &quot;&quot;, which disables dynamic provisioning\n    ## If undefined (the default) or set to null, no storageClassName spec is\n    ##   set, choosing the default provisioner.  (gp2 on AWS, standard on\n    ##   GKE, AWS &amp; OpenStack)\n    ##\n    storageClass: &quot;local-path&quot;\n    accessMode: ReadWriteOnce\n    size: 20Gi\n\n  # If you set this to true the cluster will be created without TLS\n  disableTLS: true\n\n  # disable Helm creating TLS certificates if you want to let the operator\n  # request certificates from cert-manager\n  certManager: false\n\n  # If this is set will not create secrets from values and will instead try to use\n  # a pre-existing secret of the same name.\n  # clusterSecretName: cluster1-secrets\n  readinessProbes:\n    initialDelaySeconds: 15\n    timeoutSeconds: 15\n    periodSeconds: 30\n    successThreshold: 1\n    failureThreshold: 5\n  livenessProbes:\n    initialDelaySeconds: 300\n    timeoutSeconds: 5\n    periodSeconds: 10\n    successThreshold: 1\n    failureThreshold: 3\n  # A custom Kubernetes Security Context for a Container to be used instead of the default one\n  # containerSecurityContext:\n  #   privileged: false\n  # A custom Kubernetes Security Context for a Pod to be used instead of the default one\n  # podSecurityContext:\n  #   fsGroup: 1001\n  #   supplementalGroups:\n  #   - 1001\n  # serviceAccountName: percona-xtradb-cluster-operator-workload\n\nhaproxy:\n  enabled: false\n  size: 3\n  image: &quot;&quot;\n  # imagePullPolicy: Always\n  imagePullSecrets: []\n  # - name: private-registry-credentials\n#  configuration: |\n#\n#  the actual default configuration file can be found here https:&#x2F;&#x2F;github.com&#x2F;percona&#x2F;percona-docker&#x2F;blob&#x2F;main&#x2F;haproxy&#x2F;dockerdir&#x2F;etc&#x2F;haproxy&#x2F;haproxy-global.cfg\n#\n#    global\n#      maxconn 2048\n#      external-check\n#      insecure-fork-wanted\n#      stats socket &#x2F;etc&#x2F;haproxy&#x2F;pxc&#x2F;haproxy.sock mode 600 expose-fd listeners level admin\n#\n#    defaults\n#      default-server init-addr last,libc,none\n#      log global\n#      mode tcp\n#      retries 10\n#      timeout client 28800s\n#      timeout connect 100500\n#      timeout server 28800s\n#\n#    frontend galera-in\n#      bind *:3309 accept-proxy\n#      bind *:3306\n#      mode tcp\n#      option clitcpka\n#      default_backend galera-nodes\n#\n#    frontend galera-admin-in\n#      bind *:33062\n#      mode tcp\n#      option clitcpka\n#      default_backend galera-admin-nodes\n#\n#    frontend galera-replica-in\n#      bind *:3307\n#      mode tcp\n#      option clitcpka\n#      default_backend galera-replica-nodes\n#\n#    frontend galera-mysqlx-in\n#      bind *:33060\n#      mode tcp\n#      option clitcpka\n#      default_backend galera-mysqlx-nodes\n#\n#    frontend stats\n#      bind *:8404\n#      mode http\n#      option http-use-htx\n#      http-request use-service prometheus-exporter if &#123; path &#x2F;metrics &#125;\n  annotations: &#123;&#125;\n  #  iam.amazonaws.com&#x2F;role: role-arn\n  labels: &#123;&#125;\n  #  rack: rack-22\n  # serviceType: ClusterIP\n  # externalTrafficPolicy: Cluster\n  # runtimeClassName: image-rc\n  # loadBalancerSourceRanges:\n  #   - 10.0.0.0&#x2F;8\n  # loadBalancerIP: 127.0.0.1\n  # serviceAnnotations:\n  #   service.beta.kubernetes.io&#x2F;aws-load-balancer-backend-protocol: http\n  # serviceLabels:\n  #   rack: rack-23\n  replicasServiceEnabled: true\n  # replicasLoadBalancerSourceRanges:\n  #   - 10.0.0.0&#x2F;8\n  # replicasLoadBalancerIP: 127.0.0.1\n  # replicasServiceType: ClusterIP\n  # replicasExternalTrafficPolicy: Cluster\n  # replicasServiceAnnotations:\n  #   service.beta.kubernetes.io&#x2F;aws-load-balancer-backend-protocol: http\n  # replicasServiceLabels:\n  #   rack: rack-23\n  # priorityClassName: high-priority\n  # schedulerName: mycustom-scheduler\n  readinessDelaySec: 15\n  livenessDelaySec: 300\n  # envVarsSecret: my-env-var-secrets\n  resources:\n    requests:\n      memory: 1G\n      cpu: 600m\n    limits: &#123;&#125;\n      # memory: 1G\n      # cpu: 600m\n  sidecars: []\n  sidecarVolumes: []\n  sidecarPVCs: []\n  sidecarResources:\n    requests: &#123;&#125;\n    limits: &#123;&#125;\n  nodeSelector: &#123;&#125;\n  #  disktype: ssd\n  # serviceAccountName: percona-xtradb-cluster-operator-workload\n  affinity:\n    antiAffinityTopologyKey: &quot;none&quot;\n    # advanced:\n    #   nodeAffinity:\n    #     requiredDuringSchedulingIgnoredDuringExecution:\n    #       nodeSelectorTerms:\n    #       - matchExpressions:\n    #         - key: kubernetes.io&#x2F;e2e-az-name\n    #           operator: In\n    #           values:\n    #           - e2e-az1\n    #           - e2e-az2\n  tolerations: []\n    # - key: &quot;node.alpha.kubernetes.io&#x2F;unreachable&quot;\n    #   operator: &quot;Exists&quot;\n    #   effect: &quot;NoExecute&quot;\n    #   tolerationSeconds: 6000\n  gracePeriod: 30\n  # only one of &#96;maxUnavailable&#96; or &#96;minAvailable&#96; can be set.\n  podDisruptionBudget:\n    maxUnavailable: 1\n    # minAvailable: 0\n  readinessProbes:\n    initialDelaySeconds: 15\n    timeoutSeconds: 1\n    periodSeconds: 5\n    successThreshold: 1\n    failureThreshold: 3\n  livenessProbes:\n    initialDelaySeconds: 60\n    timeoutSeconds: 5\n    periodSeconds: 30\n    successThreshold: 1\n    failureThreshold: 4\n  # A custom Kubernetes Security Context for a Container to be used instead of the default one\n  # containerSecurityContext:\n  #   privileged: false\n  # A custom Kubernetes Security Context for a Pod to be used instead of the default one\n  # podSecurityContext:\n  #   fsGroup: 1001\n  #   supplementalGroups:\n  #   - 1001\n\nproxysql:\n  enabled: true\n  size: 1\n  image: &quot;&quot;\n  # imagePullPolicy: Always\n  imagePullSecrets: []\n#  configuration: |\n#    datadir&#x3D;&quot;&#x2F;var&#x2F;lib&#x2F;proxysql&quot;\n#\n#    admin_variables &#x3D;\n#    &#123;\n#      admin_credentials&#x3D;&quot;proxyadmin:admin_password&quot;\n#      mysql_ifaces&#x3D;&quot;0.0.0.0:6032&quot;\n#      refresh_interval&#x3D;2000\n#\n#      cluster_username&#x3D;&quot;proxyadmin&quot;\n#      cluster_password&#x3D;&quot;admin_password&quot;\n#      checksum_admin_variables&#x3D;false\n#      checksum_ldap_variables&#x3D;false\n#      checksum_mysql_variables&#x3D;false\n#      cluster_check_interval_ms&#x3D;200\n#      cluster_check_status_frequency&#x3D;100\n#      cluster_mysql_query_rules_save_to_disk&#x3D;true\n#      cluster_mysql_servers_save_to_disk&#x3D;true\n#      cluster_mysql_users_save_to_disk&#x3D;true\n#      cluster_proxysql_servers_save_to_disk&#x3D;true\n#      cluster_mysql_query_rules_diffs_before_sync&#x3D;1\n#      cluster_mysql_servers_diffs_before_sync&#x3D;1\n#      cluster_mysql_users_diffs_before_sync&#x3D;1\n#      cluster_proxysql_servers_diffs_before_sync&#x3D;1\n#    &#125;\n#\n#    mysql_variables&#x3D;\n#    &#123;\n#      monitor_password&#x3D;&quot;monitor&quot;\n#      monitor_galera_healthcheck_interval&#x3D;1000\n#      threads&#x3D;2\n#      max_connections&#x3D;2048\n#      default_query_delay&#x3D;0\n#      default_query_timeout&#x3D;10000\n#      poll_timeout&#x3D;2000\n#      interfaces&#x3D;&quot;0.0.0.0:3306&quot;\n#      default_schema&#x3D;&quot;information_schema&quot;\n#      stacksize&#x3D;1048576\n#      connect_timeout_server&#x3D;10000\n#      monitor_history&#x3D;60000\n#      monitor_connect_interval&#x3D;20000\n#      monitor_ping_interval&#x3D;10000\n#      ping_timeout_server&#x3D;200\n#      commands_stats&#x3D;true\n#      sessions_sort&#x3D;true\n#      have_ssl&#x3D;true\n#      ssl_p2s_ca&#x3D;&quot;&#x2F;etc&#x2F;proxysql&#x2F;ssl-internal&#x2F;ca.crt&quot;\n#      ssl_p2s_cert&#x3D;&quot;&#x2F;etc&#x2F;proxysql&#x2F;ssl-internal&#x2F;tls.crt&quot;\n#      ssl_p2s_key&#x3D;&quot;&#x2F;etc&#x2F;proxysql&#x2F;ssl-internal&#x2F;tls.key&quot;\n#      ssl_p2s_cipher&#x3D;&quot;ECDHE-RSA-AES128-GCM-SHA256&quot;\n#    &#125;\n  # - name: private-registry-credentials\n  annotations: &#123;&#125;\n  #  iam.amazonaws.com&#x2F;role: role-arn\n  labels: &#123;&#125;\n  #  rack: rack-22\n  # serviceType: ClusterIP\n  # externalTrafficPolicy: Cluster\n  # runtimeClassName: image-rc\n  # loadBalancerSourceRanges:\n  #   - 10.0.0.0&#x2F;8\n  # loadBalancerIP: 127.0.0.1\n  # serviceAnnotations:\n  #   service.beta.kubernetes.io&#x2F;aws-load-balancer-backend-protocol: http\n  # serviceLabels:\n  #   rack: rack-23\n  # priorityClassName: high-priority\n  # schedulerName: mycustom-scheduler\n  readinessDelaySec: 15\n  livenessDelaySec: 300\n  # envVarsSecret: my-env-var-secrets\n  resources:\n    requests:\n      memory: 1G\n      cpu: 600m\n    limits: &#123;&#125;\n      # memory: 1G\n      # cpu: 600m\n  sidecars: []\n  sidecarVolumes: []\n  sidecarPVCs: []\n  sidecarResources:\n    requests: &#123;&#125;\n    limits: &#123;&#125;\n  nodeSelector: &#123;&#125;\n  #  disktype: ssd\n  # serviceAccountName: percona-xtradb-cluster-operator-workload\n  affinity:\n    antiAffinityTopologyKey: &quot;none&quot;\n    # advanced:\n    #   nodeAffinity:\n    #     requiredDuringSchedulingIgnoredDuringExecution:\n    #       nodeSelectorTerms:\n    #       - matchExpressions:\n    #         - key: kubernetes.io&#x2F;e2e-az-name\n    #           operator: In\n    #           values:\n    #           - e2e-az1\n    #           - e2e-az2\n  tolerations: []\n    # - key: &quot;node.alpha.kubernetes.io&#x2F;unreachable&quot;\n    #   operator: &quot;Exists&quot;\n    #   effect: &quot;NoExecute&quot;\n    #   tolerationSeconds: 6000\n  gracePeriod: 30\n  # only one of &#96;maxUnavailable&#96; or &#96;minAvailable&#96; can be set.\n  podDisruptionBudget:\n    maxUnavailable: 1\n    # minAvailable: 0\n  persistence:\n    enabled: true\n    ## Percona data Persistent Volume Storage Class\n    ## If defined, storageClassName: &lt;storageClass&gt;\n    ## If set to &quot;-&quot;, storageClassName: &quot;&quot;, which disables dynamic provisioning\n    ## If undefined (the default) or set to null, no storageClassName spec is\n    ##   set, choosing the default provisioner.  (gp2 on AWS, standard on\n    ##   GKE, AWS &amp; OpenStack)\n    ##\n    storageClass: &quot;local-path&quot;\n    accessMode: ReadWriteOnce\n    size: 8Gi\n  # A custom Kubernetes Security Context for a Container to be used instead of the default one\n  # containerSecurityContext:\n  #   privileged: false\n  # A custom Kubernetes Security Context for a Pod to be used instead of the default one\n  # podSecurityContext:\n  #   fsGroup: 1001\n  #   supplementalGroups:\n  #   - 1001\n\nlogcollector:\n  enabled: true\n  image: &quot;&quot;\n  # imagePullPolicy: Always\n  imagePullSecrets: []\n  # configuration: |\n  #   [OUTPUT]\n  #         Name  es\n  #         Match *\n  #         Host  192.168.2.3\n  #         Port  9200\n  #         Index my_index\n  #         Type  my_type\n  resources:\n    requests:\n      memory: 100M\n      cpu: 200m\n    limits: &#123;&#125;\n\npmm:\n  enabled: false\n  image:\n    repository: percona&#x2F;pmm-client\n    tag: 2.38.0\n  # imagePullPolicy: Always\n  imagePullSecrets: []\n  serverHost: monitoring-service\n  serverUser: admin\n  resources:\n    requests:\n      memory: 150M\n      cpu: 300m\n    limits: &#123;&#125;\n\nbackup:\n  enabled: true\n  # allowParallel: true\n  image:\n    repository: percona&#x2F;percona-xtradb-cluster-operator\n    tag: 1.13.0-pxc8.0-backup-pxb8.0.32\n  # backoffLimit: 6\n  # serviceAccountName: percona-xtradb-cluster-operator\n  # imagePullPolicy: Always\n  imagePullSecrets: []\n  # - name: private-registry-credentials\n  pitr:\n    enabled: false\n    storageName: s3-us-west-binlogs\n    timeBetweenUploads: 60\n    resources:\n      requests: &#123;&#125;\n      limits: &#123;&#125;\n  storages: &#123;&#125;\n    # fs-pvc:\n    #   type: filesystem\n    #   volume:\n    #     persistentVolumeClaim:\n    #       storageClassName: standard\n    #       accessModes: [&quot;ReadWriteOnce&quot;]\n    #       resources:\n    #         requests:\n    #           storage: 6Gi\n    # s3-us-west:\n    #   type: s3\n    #   verifyTLS: true\n    #   nodeSelector:\n    #     storage: tape\n    #     backupWorker: &#39;True&#39;\n    #   resources:\n    #     requests:\n    #       memory: 1G\n    #       cpu: 600m\n    #   affinity:\n    #     nodeAffinity:\n    #       requiredDuringSchedulingIgnoredDuringExecution:\n    #         nodeSelectorTerms:\n    #         - matchExpressions:\n    #           - key: backupWorker\n    #             operator: In\n    #             values:\n    #             - &#39;True&#39;\n    #   tolerations:\n    #     - key: &quot;backupWorker&quot;\n    #       operator: &quot;Equal&quot;\n    #       value: &quot;True&quot;\n    #       effect: &quot;NoSchedule&quot;\n    #   annotations:\n    #     testName: scheduled-backup\n    #   labels:\n    #     backupWorker: &#39;True&#39;\n    #   schedulerName: &#39;default-scheduler&#39;\n    #   priorityClassName: &#39;high-priority&#39;\n    #   containerSecurityContext:\n    #     privileged: true\n    #   podSecurityContext:\n    #     fsGroup: 1001\n    #     supplementalGroups: [1001, 1002, 1003]\n    #   s3:\n    #     bucket: S3-BACKUP-BUCKET-NAME-HERE\n    #     # Use credentialsSecret OR credentialsAccessKey&#x2F;credentialsSecretKey\n    #     credentialsSecret: my-cluster-name-backup-s3\n    #     #credentialsAccessKey: REPLACE-WITH-AWS-ACCESS-KEY\n    #     #credentialsSecretKey: REPLACE-WITH-AWS-SECRET-KEY\n    #     region: us-west-2\n    #     endpointUrl: https:&#x2F;&#x2F;sfo2.digitaloceanspaces.com\n    # s3-us-west-binlogs:\n    #   type: s3\n    #   s3:\n    #     bucket: S3-BACKUP-BUCKET-NAME-HERE&#x2F;DIRECTORY\n    #     credentialsSecret: my-cluster-name-backup-s3\n    #     region: us-west-2\n    #     endpointUrl: https:&#x2F;&#x2F;sfo2.digitaloceanspaces.com\n    # azure-blob:\n    #   type: azure\n    #   azure:\n    #     credentialsSecret: azure-secret\n    #     container: test\n    #     endpointUrl: https:&#x2F;&#x2F;accountName.blob.core.windows.net\n    #     storageClass: Hot\n\n  schedule: []\n    # - name: &quot;daily-backup&quot;\n    #   schedule: &quot;0 0 * * *&quot;\n    #   keep: 5\n    #   storageName: fs-pvc\n    # - name: &quot;sat-night-backup&quot;\n    #   schedule: &quot;0 0 * * 6&quot;\n    #   keep: 3\n    #   storageName: s3-us-west\n\nsecrets:\n  ## You should be overriding these with your own or specify name for clusterSecretName.\n  # passwords:\n  #  root: insecure-root-password\n  #  xtrabackup: insecure-xtrabackup-password\n  #  monitor: insecure-monitor-password\n  #  clustercheck: insecure-clustercheck-password\n  #  proxyadmin: insecure-proxyadmin-password\n  #  pmmserver: insecure-pmmserver-password\n  #  # If pmmserverkey is set in that case pmmserver pass will not be included\n  #  # pmmserverkey: set-pmmserver-api-key\n  #  operator: insecure-operator-password\n  #  replication: insecure-replication-password\n  ## If you are using &#96;cert-manager&#96; you can skip this next section.\n  tls: &#123;&#125;\n    # This should be the name of a secret that contains certificates.\n    # it should have the following keys: &#96;ca.crt&#96;, &#96;tls.crt&#96;, &#96;tls.key&#96;\n    # If not set the Helm chart will attempt to create certificates\n    # for you [not recommended for prod]:\n    # cluster:\n\n    # This should be the name of a secret that contains certificates.\n    # it should have the following keys: &#96;ca.crt&#96;, &#96;tls.crt&#96;, &#96;tls.key&#96;\n    # If not set the Helm chart will attempt to create certificates\n    # for you [not recommended for prod]:\n    # internal:\n  # logCollector: cluster1-log-collector-secrets\n  # vault: keyring-secret-vault</code></pre>\n<p>验证 fs3NDn~Mk6jzZPM)c(H</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">ROOT_PASSWORD&#x3D;&#96;kubectl -n db get secrets mysql-pxc-db-secrets -o jsonpath&#x3D;&quot;&#123;.data.root&#125;&quot; | base64 --decode&#96;\nkubectl -n db exec -ti mysql-pxc-db-pxc-0 -c pxc -- mysql -uroot -p&quot;$ROOT_PASSWORD&quot;\nkubectl run -i --rm --tty percona-client --image&#x3D;percona:8.0 --restart&#x3D;Never -- bash -il\nmysql -h mysql-pxc-db-proxysql.db.svc.cluster.local -uroot -pfs3NDn~Mk6jzZPM)c(H</code></pre>\n<p>pxc操作 参考:<a href=\"https://docs.percona.com/percona-operator-for-mysql/pxc/api.html\">https://docs.percona.com/percona-operator-for-mysql/pxc/api.html</a><br>备份和恢复 参考:<a href=\"https://docs.percona.com/percona-operator-for-mysql/pxc/backups-restore-to-new-cluster.html\">https://docs.percona.com/percona-operator-for-mysql/pxc/backups-restore-to-new-cluster.html</a></p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">#列出 Percona XtraDB 集群\nkubectl get pxc -n db\n#获取 Percona XtraDB 集群的状态\nkubectl get pxc&#x2F;mysql-pxc-db -o json -n db\n#扩大&#x2F;缩小 Percona XtraDB 集群\nkubectl -n db patch pxc mysql-pxc-db --type&#x3D;merge --patch &#39;&#123;&quot;spec&quot;: &#123;&quot;pxc&quot;:&#123; &quot;size&quot;: &quot;5&quot; &#125;&#125;&#125;&#39;\n#更新 Percona XtraDB 集群镜像\nkubectl -n db patch pxc mysql-pxc-db --type&#x3D;merge --patch &#39;&#123;&quot;spec&quot;: &#123;&quot;pxc&quot;:&#123; &quot;image&quot;: &quot;percona&#x2F;percona-xtradb-cluster:5.7.30-31.43&quot; &#125;&#125;&#125;&#39;\n#备份 Percona XtraDB 集群\nkubectl apply -f percona-xtradb-cluster-operator&#x2F;deploy&#x2F;backup&#x2F;backup.yaml\n#恢复 Percona XtraDB 集群\nkubectl apply -f percona-xtradb-cluster-operator&#x2F;deploy&#x2F;backup&#x2F;restore.yaml</code></pre>\n<pre class=\"line-numbers language-yaml\" data-language=\"yaml\"><code class=\"language-yaml\">---\napiVersion: pxc.percona.com&#x2F;v1\nkind: PerconaXtraDBClusterBackup\nmetadata:\n  name: backup-2308161448\nspec:\n  pxcCluster: mysql-pxc-db\n  storageName: fs-pvc\n---\napiVersion: pxc.percona.com&#x2F;v1\nkind: PerconaXtraDBClusterRestore\nmetadata:\n  name: restore-2308161448\nspec:\n  pxcCluster: mysql-pxc-db\n  backupName: backup-2308161448</code></pre>\n","feature":true,"text":"helm部署pxc-dbpxc-operator: https://artifacthub.io/packages/helm/percona/pxc-operatorpxc-db: https://artifacthub.io/packages/helm/percona/pxc-...","link":"","photos":[],"count_time":{"symbolsCount":"21k","symbolsTime":"20 mins."},"categories":[{"name":"kubernetes","slug":"kubernetes","count":7,"path":"api/categories/kubernetes.json"}],"tags":[{"name":"helm","slug":"helm","count":1,"path":"api/tags/helm.json"},{"name":"kubernetes","slug":"kubernetes","count":8,"path":"api/tags/kubernetes.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#helm%E9%83%A8%E7%BD%B2pxc-db\"><span class=\"toc-text\">helm部署pxc-db</span></a></li></ol>","author":{"name":"ChrisWood","slug":"blog-author","avatar":"https://chriswood-blog.oss-cn-shanghai.aliyuncs.com/me/avatar.png","link":"/","description":"Think like an artist, code like an artisan.","socials":{"github":"https://github.com/chriswoodcn","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"linux上ssh证书登录配置","uid":"cfef3b14a7ab14488e44f93f6307d669","slug":"linux/linux上ssh证书登录配置","date":"2023-08-16T23:55:08.000Z","updated":"2023-08-17T02:24:27.214Z","comments":true,"path":"api/articles/linux/linux上ssh证书登录配置.json","keywords":"chriswood blogs sharing","cover":null,"text":"centos的ssh证书登录 mkdir -p ~&#x2F;.ssh chmod 0700 .ssh cd ~&#x2F;.ssh ssh-keygen -t rsa cp id_rsa.pub authorized_keys chmod 0600 authorized_key...","link":"","photos":[],"count_time":{"symbolsCount":374,"symbolsTime":"1 mins."},"categories":[{"name":"linux","slug":"linux","count":1,"path":"api/categories/linux.json"}],"tags":[{"name":"ssh","slug":"ssh","count":1,"path":"api/tags/ssh.json"},{"name":"linux","slug":"linux","count":1,"path":"api/tags/linux.json"}],"author":{"name":"ChrisWood","slug":"blog-author","avatar":"https://chriswood-blog.oss-cn-shanghai.aliyuncs.com/me/avatar.png","link":"/","description":"Think like an artist, code like an artisan.","socials":{"github":"https://github.com/chriswoodcn","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"英语语法","uid":"5a94284bad0b90df36c14e6069e7b100","slug":"master/English/英语语法","date":"2023-07-10T01:45:57.000Z","updated":"2023-08-17T02:24:27.214Z","comments":true,"path":"api/articles/master/English/英语语法.json","keywords":"chriswood blogs sharing","cover":null,"text":"核心语法综述词法名词 代词 动词 形容词 副词 数词介词 连词 冠词 句法研究句子成分和结构 句子成分与句型结构主语：全句所述说的对象谓语：述说主语的动作或状态表语：表述主语的身份或特征宾语：及物动词或介词的对象定语：限定或修饰名词状语：修饰动、副、形及全句同位语：解释或说明另一...","link":"","photos":[],"count_time":{"symbolsCount":"47k","symbolsTime":"42 mins."},"categories":[{"name":"考研英语","slug":"考研英语","count":3,"path":"api/categories/考研英语.json"}],"tags":[{"name":"考研英语","slug":"考研英语","count":3,"path":"api/tags/考研英语.json"}],"author":{"name":"ChrisWood","slug":"blog-author","avatar":"https://chriswood-blog.oss-cn-shanghai.aliyuncs.com/me/avatar.png","link":"/","description":"Think like an artist, code like an artisan.","socials":{"github":"https://github.com/chriswoodcn","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true}}