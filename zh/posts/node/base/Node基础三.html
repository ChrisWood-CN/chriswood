<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.13" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.49" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://mister-hope.github.io/zh/posts/node/base/Node%E5%9F%BA%E7%A1%80%E4%B8%89.html"><meta property="og:site_name" content="博客"><meta property="og:title" content="Node基础三"><meta property="og:description" content="三 . 掌握前端模块化 1.1. JavaScript设计缺陷 那么，到底什么是模块化开发呢？ 事实上模块化开发最终的目的是将程序划分成一个个小的结构； 这个结构中编写属于自己的逻辑代码，有自己的作用域，不会影响到其他的结构； 这个结构可以将自己希望暴露的变量、函数、对象等导出给其结构使用； 也可以通过某种方式，导入另外结构中的变量、函数、对象等； 上..."><meta property="og:type" content="article"><meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuseDpSr345APaEno34kiboje8hwm1puPMdA3bP3sUYp9LA7m7LpVibnl8ACF7EyTwLgJEtoiadNV6tmQ/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-06-20T00:28:24.000Z"><meta property="article:author" content="chriswoodcn"><meta property="article:published_time" content="2022-10-01T12:23:22.000Z"><meta property="article:modified_time" content="2024-06-20T00:28:24.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Node基础三","image":["https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuseDpSr345APaEno34kiboje8hwm1puPMdA3bP3sUYp9LA7m7LpVibnl8ACF7EyTwLgJEtoiadNV6tmQ/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1","https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuseDpSr345APaEno34kibojewT2wSgxhOcSHdyzZWicejEY7dYHuicgm9AzH1jtLibH0U9Loj7ZTVFbKw/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1","https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuseDpSr345APaEno34kibojeicBuAibNeFXU9qkIauXYDOMsE7QCUxZesYWFouOBC7SQatrZpb4lUoEA/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1","https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuseDpSr345APaEno34kibojeib966pL7iazrlQAJFO14AUekibxu8JF2MHxUrVoX0csXo1nJMjZeWOjmw/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1","https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuseDpSr345APaEno34kibojeE1wEXS3pNL4evJyQ0ia6lF5nx0aH7Lc6CQichwyWtoOKUlcBqIM8qOHQ/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1","https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuseDpSr345APaEno34kibojeQeOBuV3g4Gv6td12x74GguP2uS3Ze7FeHtWWLN3FM5o4j18yB3Bkiaw/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1","https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuseDpSr345APaEno34kibojeccY2Bics4UStoH4FzQrWyibQ4JPiaQayWNXn7ph55CpDPSNmeVXb0Jxyg/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1","https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuseDpSr345APaEno34kibojeicyjvLkriaru3ojNlKRmvS2JxaSFMSc2FBKKwYarUJo4yg4gswJiaR3pA/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1","https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuseDpSr345APaEno34kibojeY4IPWs3EMyKOMWKeM6j67YYqCxEBibXBPr88jK58OMNW4vAiaj6sWAnw/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1","https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuseDpSr345APaEno34kiboje0sX4zUA3vz40Ozw8qcUhylACJpZPhEXeZrKboRMRgQpwhCpZibWbceg/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1","https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuseDpSr345APaEno34kibojeEjMHCucTVCC7q8WcQNmShUiaKWkFvkLSccd6HjJdM2MVkyVwrDoff8Q/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1","https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuseDpSr345APaEno34kibojeeWRicwIysicCm4m69Kfd8FFfaEcWuRdSV4spX0zrGLzX51KCgZ6ibELPg/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1","https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuseDpSr345APaEno34kibojeUG7186yJvYjzRXmzl3NFJg46oIEJibAPpbJvyBmycic4YF91qVfibuW7A/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1","https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuseDpSr345APaEno34kibojeezXibRWtBBwGrUqbiceysIwmIBaWxjhEc1QAOOr0MSjCbOJTkKhP5dfw/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1","https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuseDpSr345APaEno34kibojelXdJWbQtsL9dkFfVickXCPiclf8icow980G4sPwpITsbzuEYaZS1VPIoA/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1","https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuseDpSr345APaEno34kibojefTf4B6uacj7YUH5BD1IKh5IzA1DcedJ5ia6Y1Wnul1HCo9fVCWjMdRQ/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1"],"datePublished":"2022-10-01T12:23:22.000Z","dateModified":"2024-06-20T00:28:24.000Z","author":[{"@type":"Person","name":"chriswoodcn"}]}</script><title>Node基础三 | 博客</title><meta name="description" content="三 . 掌握前端模块化 1.1. JavaScript设计缺陷 那么，到底什么是模块化开发呢？ 事实上模块化开发最终的目的是将程序划分成一个个小的结构； 这个结构中编写属于自己的逻辑代码，有自己的作用域，不会影响到其他的结构； 这个结构可以将自己希望暴露的变量、函数、对象等导出给其结构使用； 也可以通过某种方式，导入另外结构中的变量、函数、对象等； 上...">
    <link rel="preload" href="/assets/style-sqluUE2b.css" as="style"><link rel="stylesheet" href="/assets/style-sqluUE2b.css">
    <link rel="modulepreload" href="/assets/app-Di2jApqi.js"><link rel="modulepreload" href="/assets/Node基础三.html-D-BFS7cF.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/assets/index.html-D4qz_427.js" as="script"><link rel="prefetch" href="/assets/intro.html-CXiqSqMx.js" as="script"><link rel="prefetch" href="/assets/index.html-Zz5AiXsA.js" as="script"><link rel="prefetch" href="/assets/intro.html-G1Yiigd_.js" as="script"><link rel="prefetch" href="/assets/开发环境配置.html-B2H74Tx0.js" as="script"><link rel="prefetch" href="/assets/docker-compose.html-B5xQaNTc.js" as="script"><link rel="prefetch" href="/assets/docker-entrypoint.sh脚本.html-9rRAabZJ.js" as="script"><link rel="prefetch" href="/assets/docker-repository.html-txqEvqI3.js" as="script"><link rel="prefetch" href="/assets/docker安装及CA证书制作.html-DR72D3ji.js" as="script"><link rel="prefetch" href="/assets/docker环境部署集群前后端分离项目.html-BcSQqDso.js" as="script"><link rel="prefetch" href="/assets/docker镜像构建方式.html-Bfrmxyen.js" as="script"><link rel="prefetch" href="/assets/gradle环境配置.html-BT-wEbYi.js" as="script"><link rel="prefetch" href="/assets/docker部署hbase.html-DDRGFj9y.js" as="script"><link rel="prefetch" href="/assets/EditorConfig配置.html-BoTIUtJY.js" as="script"><link rel="prefetch" href="/assets/docker部署kafka集群.html-BfBhRN8Y.js" as="script"><link rel="prefetch" href="/assets/kafka学习.html-5_Bpuk3n.js" as="script"><link rel="prefetch" href="/assets/Grammer.html-D_53h0WS.js" as="script"><link rel="prefetch" href="/assets/docker、crictl、ctr命令集合.html-BWvNs2wl.js" as="script"><link rel="prefetch" href="/assets/helm部署应用合集.html-B7pSDFmc.js" as="script"><link rel="prefetch" href="/assets/istio入门.html-AkJRQovE.js" as="script"><link rel="prefetch" href="/assets/istio配置.html-DsB4nCa0.js" as="script"><link rel="prefetch" href="/assets/k3s部署rancher.html-DdH8g1aJ.js" as="script"><link rel="prefetch" href="/assets/kubeadmin搭建k8s.html-B9-m27Oo.js" as="script"><link rel="prefetch" href="/assets/kubectl多集群环境切换.html-CG1pzhjt.js" as="script"><link rel="prefetch" href="/assets/kubernetes安装dashboard.html-DDXFUvXs.js" as="script"><link rel="prefetch" href="/assets/kubernetes常用模板.html-dTRaa_Yu.js" as="script"><link rel="prefetch" href="/assets/kubernetes阿里云应用方式.html-DEJdSY6E.js" as="script"><link rel="prefetch" href="/assets/Linux-iptables学习.html-DHYZ9rnI.js" as="script"><link rel="prefetch" href="/assets/Linux上ssh证书登录配置.html-DFP2Pk-o.js" as="script"><link rel="prefetch" href="/assets/centos7.html-CS1kvKSR.js" as="script"><link rel="prefetch" href="/assets/crontab命令.html-QmVleZOn.js" as="script"><link rel="prefetch" href="/assets/shell脚本编辑.html-C2PGARd-.js" as="script"><link rel="prefetch" href="/assets/Nginx常用操作及配置.html-1hsWMzUF.js" as="script"><link rel="prefetch" href="/assets/Nginx日志按天切割.html-B4dRMM_s.js" as="script"><link rel="prefetch" href="/assets/springboot日志配置.html-TIJCC-Z5.js" as="script"><link rel="prefetch" href="/assets/springboot配置文件.html-Bj5gkxgj.js" as="script"><link rel="prefetch" href="/assets/md数学公式编辑.html-oQm70FfE.js" as="script"><link rel="prefetch" href="/assets/batch命令.html-DlqcG1UL.js" as="script"><link rel="prefetch" href="/assets/SuppressWarnings注解.html-lcZTPDuw.js" as="script"><link rel="prefetch" href="/assets/Java高并发专题-JUC线程池.html-Crmtw95J.js" as="script"><link rel="prefetch" href="/assets/maven项目pom-xml配置说明.html-DeeNhH0X.js" as="script"><link rel="prefetch" href="/assets/RedisTemplate的opsFor操作.html-BHXvTkZR.js" as="script"><link rel="prefetch" href="/assets/核心词汇.html-_vZVF7pr.js" as="script"><link rel="prefetch" href="/assets/英语词根词缀整理.html-stOK79AW.js" as="script"><link rel="prefetch" href="/assets/英语语法.html-DZ9zLglf.js" as="script"><link rel="prefetch" href="/assets/线性代数.html-0LSlo-r-.js" as="script"><link rel="prefetch" href="/assets/高等数学.html-1CgFanDN.js" as="script"><link rel="prefetch" href="/assets/思修法基.html-obYh9tzy.js" as="script"><link rel="prefetch" href="/assets/毛中特.html-DGlIt-Mu.js" as="script"><link rel="prefetch" href="/assets/近代史.html-Cv9wYnw1.js" as="script"><link rel="prefetch" href="/assets/马克思主义基本原理.html-s7jwL3md.js" as="script"><link rel="prefetch" href="/assets/Mysql基础.html-Be1VFVDB.js" as="script"><link rel="prefetch" href="/assets/Node基础一.html-CYQbrA81.js" as="script"><link rel="prefetch" href="/assets/Node基础七.html-x0BFgfV5.js" as="script"><link rel="prefetch" href="/assets/Node基础九.html-ChNLkdpN.js" as="script"><link rel="prefetch" href="/assets/Node基础二.html-J-NKRYqg.js" as="script"><link rel="prefetch" href="/assets/Node基础五.html-CiMFV1D_.js" as="script"><link rel="prefetch" href="/assets/Node基础八.html-CqH_wYtt.js" as="script"><link rel="prefetch" href="/assets/Node基础六.html-DX34i4E0.js" as="script"><link rel="prefetch" href="/assets/Node基础十.html-CFjQw2cF.js" as="script"><link rel="prefetch" href="/assets/Node基础十一.html-DyfnBagS.js" as="script"><link rel="prefetch" href="/assets/Node基础十二.html-BKB60jG_.js" as="script"><link rel="prefetch" href="/assets/Node基础四.html-DdJO9Jf0.js" as="script"><link rel="prefetch" href="/assets/404.html-CeYmuh1l.js" as="script"><link rel="prefetch" href="/assets/index.html-x53Nlasd.js" as="script"><link rel="prefetch" href="/assets/index.html-DhlQU6Vt.js" as="script"><link rel="prefetch" href="/assets/index.html-ChR1mk8X.js" as="script"><link rel="prefetch" href="/assets/index.html-VYsFbXm-.js" as="script"><link rel="prefetch" href="/assets/index.html-LRI8IIQO.js" as="script"><link rel="prefetch" href="/assets/index.html-D_qUD5Aa.js" as="script"><link rel="prefetch" href="/assets/index.html-tHmJ_tA-.js" as="script"><link rel="prefetch" href="/assets/index.html-JQGXZrUC.js" as="script"><link rel="prefetch" href="/assets/index.html-D0RsaZZy.js" as="script"><link rel="prefetch" href="/assets/index.html-D46oBuzM.js" as="script"><link rel="prefetch" href="/assets/index.html-DfE2JuK9.js" as="script"><link rel="prefetch" href="/assets/index.html-DVy0CMpZ.js" as="script"><link rel="prefetch" href="/assets/index.html-BmzMF5C4.js" as="script"><link rel="prefetch" href="/assets/index.html-DPFKxUkr.js" as="script"><link rel="prefetch" href="/assets/index.html-6yaYEBgF.js" as="script"><link rel="prefetch" href="/assets/index.html-CtGf7FYa.js" as="script"><link rel="prefetch" href="/assets/index.html-C6Yle-Hz.js" as="script"><link rel="prefetch" href="/assets/index.html-Bu3ZdIfy.js" as="script"><link rel="prefetch" href="/assets/index.html-P7gPELSD.js" as="script"><link rel="prefetch" href="/assets/index.html-B7hWlkOP.js" as="script"><link rel="prefetch" href="/assets/index.html-BWAkpyri.js" as="script"><link rel="prefetch" href="/assets/index.html-WmCfZBAZ.js" as="script"><link rel="prefetch" href="/assets/index.html-DABKk2lm.js" as="script"><link rel="prefetch" href="/assets/index.html-BNXk92Ay.js" as="script"><link rel="prefetch" href="/assets/index.html-XJ1XbpfC.js" as="script"><link rel="prefetch" href="/assets/index.html-DWt8iBrg.js" as="script"><link rel="prefetch" href="/assets/index.html-47pXob8C.js" as="script"><link rel="prefetch" href="/assets/index.html-i6sVGXvV.js" as="script"><link rel="prefetch" href="/assets/index.html-Dgx4vpne.js" as="script"><link rel="prefetch" href="/assets/index.html-MxcMAMkq.js" as="script"><link rel="prefetch" href="/assets/index.html-D9vTw3F7.js" as="script"><link rel="prefetch" href="/assets/index.html-DHYLyJZD.js" as="script"><link rel="prefetch" href="/assets/index.html-CaRNJj-G.js" as="script"><link rel="prefetch" href="/assets/index.html-DH9MIpRP.js" as="script"><link rel="prefetch" href="/assets/index.html-Cv3xreyg.js" as="script"><link rel="prefetch" href="/assets/index.html-DeVUVbg_.js" as="script"><link rel="prefetch" href="/assets/index.html-DJcxoTLG.js" as="script"><link rel="prefetch" href="/assets/index.html-CcrMK4I5.js" as="script"><link rel="prefetch" href="/assets/index.html-ByHriRIj.js" as="script"><link rel="prefetch" href="/assets/index.html-CjuEV6bl.js" as="script"><link rel="prefetch" href="/assets/index.html-BuAvSP_s.js" as="script"><link rel="prefetch" href="/assets/index.html-HRfogTHc.js" as="script"><link rel="prefetch" href="/assets/index.html-CBhn3jr3.js" as="script"><link rel="prefetch" href="/assets/index.html-CxHnKTnt.js" as="script"><link rel="prefetch" href="/assets/index.html-CaQe2iEB.js" as="script"><link rel="prefetch" href="/assets/index.html-DlcPsw23.js" as="script"><link rel="prefetch" href="/assets/index.html-DWvrNUZi.js" as="script"><link rel="prefetch" href="/assets/index.html-T_Pctg9J.js" as="script"><link rel="prefetch" href="/assets/index.html-Dt3ROPfA.js" as="script"><link rel="prefetch" href="/assets/index.html-BUh3lg2V.js" as="script"><link rel="prefetch" href="/assets/index.html-DQtXdGRq.js" as="script"><link rel="prefetch" href="/assets/index.html-DtomvJZk.js" as="script"><link rel="prefetch" href="/assets/index.html-BwRfzkKX.js" as="script"><link rel="prefetch" href="/assets/index.html-CRaW4dQ1.js" as="script"><link rel="prefetch" href="/assets/index.html-C0LTyAuf.js" as="script"><link rel="prefetch" href="/assets/index.html-DzIDeq9I.js" as="script"><link rel="prefetch" href="/assets/index.html-BuruV9G3.js" as="script"><link rel="prefetch" href="/assets/index.html-Byf4z4qy.js" as="script"><link rel="prefetch" href="/assets/index.html-CioDMIV2.js" as="script"><link rel="prefetch" href="/assets/index.html-nBOzC5v5.js" as="script"><link rel="prefetch" href="/assets/index.html-DtysaZ25.js" as="script"><link rel="prefetch" href="/assets/index.html-ByJI4lzo.js" as="script"><link rel="prefetch" href="/assets/index.html-ByiVgVmI.js" as="script"><link rel="prefetch" href="/assets/index.html-Bhtn0eDk.js" as="script"><link rel="prefetch" href="/assets/index.html-nSkWFSR0.js" as="script"><link rel="prefetch" href="/assets/index.html-CW3su0Zf.js" as="script"><link rel="prefetch" href="/assets/index.html-7eDIEIM2.js" as="script"><link rel="prefetch" href="/assets/index.html-ESGIg6Gt.js" as="script"><link rel="prefetch" href="/assets/index.html-BrSZEg1x.js" as="script"><link rel="prefetch" href="/assets/index.html-BgbOusEz.js" as="script"><link rel="prefetch" href="/assets/index.html-DWDw1-rC.js" as="script"><link rel="prefetch" href="/assets/index.html-oZ9-EYf-.js" as="script"><link rel="prefetch" href="/assets/index.html-CiK6csT1.js" as="script"><link rel="prefetch" href="/assets/index.html-B9P6YcrU.js" as="script"><link rel="prefetch" href="/assets/index.html-BOn5mf9l.js" as="script"><link rel="prefetch" href="/assets/index.html-BGmWUBYo.js" as="script"><link rel="prefetch" href="/assets/index.html-CAo8hE40.js" as="script"><link rel="prefetch" href="/assets/index.html-BDGIk76J.js" as="script"><link rel="prefetch" href="/assets/index.html-CTYhcoSU.js" as="script"><link rel="prefetch" href="/assets/index.html-DUlpepaS.js" as="script"><link rel="prefetch" href="/assets/index.html-Dx5xCuSL.js" as="script"><link rel="prefetch" href="/assets/index.html-BHZv_HCb.js" as="script"><link rel="prefetch" href="/assets/index.html-CDoYd7N6.js" as="script"><link rel="prefetch" href="/assets/index.html-o5SNqjHV.js" as="script"><link rel="prefetch" href="/assets/index.html-DyLCGxu-.js" as="script"><link rel="prefetch" href="/assets/index.html-C1DzPoJ2.js" as="script"><link rel="prefetch" href="/assets/index.html-D4e9mCPb.js" as="script"><link rel="prefetch" href="/assets/index.html-B6bjyy5A.js" as="script"><link rel="prefetch" href="/assets/index.html-pyAA9YiD.js" as="script"><link rel="prefetch" href="/assets/index.html-B1LfIsXO.js" as="script"><link rel="prefetch" href="/assets/index.html-C9Ws5MTe.js" as="script"><link rel="prefetch" href="/assets/index.html-DzIDeq9I.js" as="script"><link rel="prefetch" href="/assets/index.html-H-Mg__Pv.js" as="script"><link rel="prefetch" href="/assets/index.html-XmpbZYT4.js" as="script"><link rel="prefetch" href="/assets/index.html-DRJkbUJ5.js" as="script"><link rel="prefetch" href="/assets/index.html-D1LTd96z.js" as="script"><link rel="prefetch" href="/assets/index.html-DHIQoyek.js" as="script"><link rel="prefetch" href="/assets/index.html-B0NWSZbk.js" as="script"><link rel="prefetch" href="/assets/index.html-Do6OW5_m.js" as="script"><link rel="prefetch" href="/assets/index.html-DI1ZcndS.js" as="script"><link rel="prefetch" href="/assets/index.html-pCcZJPpZ.js" as="script"><link rel="prefetch" href="/assets/index.html-BQ69Fh7a.js" as="script"><link rel="prefetch" href="/assets/index.html-DlsKr7WN.js" as="script"><link rel="prefetch" href="/assets/index.html-CHoqXjqw.js" as="script"><link rel="prefetch" href="/assets/index.html-EuFT4h8T.js" as="script"><link rel="prefetch" href="/assets/index.html-BXDDA9co.js" as="script"><link rel="prefetch" href="/assets/index.html-CP3U5sX8.js" as="script"><link rel="prefetch" href="/assets/playground.min-ClNEchlS.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-GXRgw7eJ.js" as="script"><link rel="prefetch" href="/assets/SearchResult-BpVowSsR.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container external-link-icon has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/zh/"><img class="vp-nav-logo" src="/logo.png" alt><!----><span class="vp-site-name hide-in-pad">博客</span></a><!--[--><button type="button" class="search-pro-button" aria-label="搜索"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon" name="search"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="search-pro-placeholder">搜索</div><div class="search-pro-key-hints"><kbd class="search-pro-key">Ctrl</kbd><kbd class="search-pro-key">K</kbd></div></button><!--]--><!--]--><!----></div><div class="vp-navbar-center"><!----><!----><!----></div><div class="vp-navbar-end"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/zh/" aria-label="主页"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="home" width="1em" height="1em"></iconify-icon><!--]-->主页<!----></a></div></nav><div class="vp-nav-item"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="选择语言"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon i18n-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="i18n icon" name="i18n" style="width:1rem;height:1rem;vertical-align:middle;"><path d="M379.392 460.8 494.08 575.488l-42.496 102.4L307.2 532.48 138.24 701.44l-71.68-72.704L234.496 460.8l-45.056-45.056c-27.136-27.136-51.2-66.56-66.56-108.544h112.64c7.68 14.336 16.896 27.136 26.112 35.84l45.568 46.08 45.056-45.056C382.976 312.32 409.6 247.808 409.6 204.8H0V102.4h256V0h102.4v102.4h256v102.4H512c0 70.144-37.888 161.28-87.04 210.944L378.88 460.8zM576 870.4 512 1024H409.6l256-614.4H768l256 614.4H921.6l-64-153.6H576zM618.496 768h196.608L716.8 532.48 618.496 768z"></path></svg><!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/" aria-label="English"><!---->English<!----></a></li><li class="vp-dropdown-item"><a class="route-link route-link-active auto-link" href="/zh/posts/node/base/Node%E5%9F%BA%E7%A1%80%E4%B8%89.html" aria-label="简体中文"><!---->简体中文<!----></a></li></ul></button></div></div><!----><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!----><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/zh/" aria-label="主页"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="home" width="1em" height="1em"></iconify-icon><!--]-->主页<!----></a></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header clickable"><iconify-icon class="font-icon icon" style="" mode="style" inline icon="laptop-code" width="1em" height="1em"></iconify-icon><a class="route-link auto-link vp-sidebar-title no-external-link-icon" href="/zh/demo/" aria-label="如何使用"><!---->如何使用<!----></a><!----></p><ul class="vp-sidebar-links"></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header active"><iconify-icon class="font-icon icon" style="" mode="style" inline icon="book" width="1em" height="1em"></iconify-icon><span class="vp-sidebar-title">文章</span><!----></p><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Docker</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Env</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Gradle</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Hbase</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Ide</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Java</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Kafka</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Kotlin</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Kubernetes</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Linux</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Master</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Mysql</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Nginx</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">Node</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">Base</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/zh/posts/node/base/Node%E5%9F%BA%E7%A1%80%E4%B8%80.html" aria-label="Node基础一"><!---->Node基础一<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/zh/posts/node/base/Node%E5%9F%BA%E7%A1%80%E4%B8%83.html" aria-label="Node基础七"><!---->Node基础七<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/zh/posts/node/base/Node%E5%9F%BA%E7%A1%80%E4%B8%89.html" aria-label="Node基础三"><!---->Node基础三<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/zh/posts/node/base/Node%E5%9F%BA%E7%A1%80%E4%B9%9D.html" aria-label="Node基础九"><!---->Node基础九<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/zh/posts/node/base/Node%E5%9F%BA%E7%A1%80%E4%BA%8C.html" aria-label="Node基础二"><!---->Node基础二<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/zh/posts/node/base/Node%E5%9F%BA%E7%A1%80%E4%BA%94.html" aria-label="Node基础五"><!---->Node基础五<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/zh/posts/node/base/Node%E5%9F%BA%E7%A1%80%E5%85%AB.html" aria-label="Node基础八"><!---->Node基础八<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/zh/posts/node/base/Node%E5%9F%BA%E7%A1%80%E5%85%AD.html" aria-label="Node基础六"><!---->Node基础六<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/zh/posts/node/base/Node%E5%9F%BA%E7%A1%80%E5%8D%81.html" aria-label="Node基础十"><!---->Node基础十<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/zh/posts/node/base/Node%E5%9F%BA%E7%A1%80%E5%8D%81%E4%B8%80.html" aria-label="Node基础十一"><!---->Node基础十一<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/zh/posts/node/base/Node%E5%9F%BA%E7%A1%80%E5%8D%81%E4%BA%8C.html" aria-label="Node基础十二"><!---->Node基础十二<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/zh/posts/node/base/Node%E5%9F%BA%E7%A1%80%E5%9B%9B.html" aria-label="Node基础四"><!---->Node基础四<!----></a></li></ul></section></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Springboot</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Tools</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Windows</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li><li><a class="route-link auto-link vp-sidebar-link" href="/zh/intro.html" aria-label="介绍页"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="circle-info" width="1em" height="1em"></iconify-icon><!--]-->介绍页<!----></a></li><li><a class="auto-link external-link vp-sidebar-link" href="https://plugin-md-enhance.vuejs.press/zh/guide/content/revealjs/demo.html" aria-label="幻灯片" rel="noopener noreferrer" target="_blank"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="person-chalkboard" width="1em" height="1em"></iconify-icon><!--]-->幻灯片<!----></a></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->Node基础三</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="page-author-item">chriswoodcn</span></span><span property="author" content="chriswoodcn"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2022-10-01T12:23:22.000Z"></span><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 22 分钟</span><meta property="timeRequired" content="PT22M"></span><span class="page-category-info" aria-label="分类🌈" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color3 clickable" role="navigation">Node</span><!--]--><meta property="articleSection" content="Node"></span><span class="page-tag-info" aria-label="标签🏷" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color4 clickable" role="navigation">Node Node基础系列</span><!--]--><meta property="keywords" content="Node Node基础系列"></span></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!----><div class="vp-toc-header">此页内容<button type="button" class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#三-掌握前端模块化">三 . 掌握前端模块化</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-1-javascript设计缺陷">1.1. JavaScript设计缺陷</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-2-没有模块化的问题">1.2. 没有模块化的问题</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#commonjs规范">CommonJS规范</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-1-commonjs和node">2.1. CommonJS和Node</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-2-node模块化开发">2.2. Node模块化开发</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-3-node的源码解析">2.3. Node的源码解析</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#amd和cmd规范">AMD和CMD规范</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-1-commonjs规范缺点">3.1. CommonJS规范缺点</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-2-amd规范">3.2. AMD规范</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-3-cmd规范">3.3. CMD规范</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#es-module">ES Module</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_4-1-认识es-module">4.1. 认识ES Module</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_4-2-es-module的使用">4.2. ES Module的使用</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_4-3-es-module的原理">4.3. ES Module的原理</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content"><h2 id="三-掌握前端模块化" tabindex="-1"><a class="header-anchor" href="#三-掌握前端模块化"><span>三 . 掌握前端模块化</span></a></h2><h3 id="_1-1-javascript设计缺陷" tabindex="-1"><a class="header-anchor" href="#_1-1-javascript设计缺陷"><span>1.1. JavaScript设计缺陷</span></a></h3><p>那么，到底什么是模块化开发呢？</p><ul><li>事实上模块化开发最终的目的是将程序划分成一个个小的结构；</li><li>这个结构中编写属于自己的逻辑代码，有自己的作用域，不会影响到其他的结构；</li><li>这个结构可以将自己希望暴露的变量、函数、对象等导出给其结构使用；</li><li>也可以通过某种方式，导入另外结构中的变量、函数、对象等；</li></ul><p><strong>上面说提到的结构，就是模块；</strong></p><p><strong>按照这种结构划分开发程序的过程，就是模块化开发的过程；</strong></p><p>无论你多么喜欢JavaScript，以及它现在发展的有多好，我们都需要承认在<em>Brendan Eich</em>用了10天写出JavaScript的时候，它都有很多的缺陷：</p><ul><li>比如var定义的变量作用域问题；</li><li>比如JavaScript的面向对象并不能像常规面向对象语言一样使用class；</li><li>比如JavaScript没有模块化的问题；</li></ul><p><em>Brendan Eich</em>本人也多次承认过JavaScript设计之初的缺陷，但是随着JavaScript的发展以及标准化，存在的缺陷问题基本都得到了完善。</p><ul><li>JavaScript目前已经得到了快速的发展，无论是web、移动端、小程序端、服务器端、桌面应用都被广泛的使用；</li></ul><p>在网页开发的早期，<em>Brendan Eich</em>开发JavaScript仅仅作为一种脚本语言，做一些简单的表单验证或动画实现等，那个时候代码还是很少的：</p><ul><li>这个时候我们只需要讲JavaScript代码写到script标签中即可；</li><li>并没有必要放到多个文件中来编写；</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>&lt;button id=&quot;btn&quot;&gt;按钮&lt;/button&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;script&gt;</span></span>
<span class="line"><span>  document.getElementById(&quot;btn&quot;).onclick = function() {</span></span>
<span class="line"><span>    console.log(&quot;按钮被点击了&quot;);</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>&lt;/script&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>但是随着前端和JavaScript的快速发展，JavaScript代码变得越来越复杂了：</p><ul><li>ajax的出现，前后端开发分离，意味着后端返回数据后，我们需要通过JavaScript进行前端页面的渲染；</li><li>SPA的出现，前端页面变得更加复杂：包括前端路由、状态管理等等一系列复杂的需求需要通过JavaScript来实现；</li><li>包括Node的实现，JavaScript编写复杂的后端程序，没有模块化是致命的硬伤；</li></ul><p>所以，模块化已经是JavaScript一个非常迫切的需求：</p><ul><li>但是JavaScript本身，直到ES6（2015）才推出了自己的模块化方案；</li><li>在此之前，为了让JavaScript支持模块化，涌现出了很多不同的模块化规范：AMD、CMD、CommonJS等；</li></ul><p>在这个章节，我们将详细学习JavaScript的模块化，尤其是CommonJS和ES6的模块化。</p><h3 id="_1-2-没有模块化的问题" tabindex="-1"><a class="header-anchor" href="#_1-2-没有模块化的问题"><span>1.2. 没有模块化的问题</span></a></h3><p>我们先来简单体会一下没有模块化代码的问题。</p><p>我们知道，对于一个大型的前端项目，通常是多人开发的（即使一个人开发，也会将代码划分到多个文件夹中）：</p><ul><li>我们假设有两个人：小明和小丽同时在开发一个项目，并且会将自己的JavaScript代码放在一个单独的js文件中。</li></ul><p>小明开发了aaa.js文件，代码如下（当然真实代码会复杂的多）：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>var flag = true;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>if (flag) {</span></span>
<span class="line"><span>  console.log(&quot;aaa的flag为true&quot;)</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>小丽开发了bbb.js文件，代码如下：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>var flag = false;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>if (!flag) {</span></span>
<span class="line"><span>  console.log(&quot;bbb使用了flag为false&quot;);</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>很明显出现了一个问题：</p><ul><li>大家都喜欢使用flag来存储一个boolean类型的值；</li><li>但是一个人赋值了true，一个人赋值了false；</li><li>如果之后都不再使用，那么也没有关系；</li></ul><p>但是，小明又开发了ccc.js文件：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>if (flag) {</span></span>
<span class="line"><span>  console.log(&quot;使用了aaa的flag&quot;);</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>问题来了：小明发现ccc中的flag值不对</p><ul><li>对于聪明的你，当然一眼就看出来，是小丽将flag赋值为了false；</li><li>但是如果每个文件都有上千甚至更多的代码，而且有上百个文件，你可以一眼看出来flag在哪个地方被修改了吗？</li></ul><p>备注：引用路径如下：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>&lt;script src=&quot;./aaa.js&quot;&gt;&lt;/script&gt;</span></span>
<span class="line"><span>&lt;script src=&quot;./bbb.js&quot;&gt;&lt;/script&gt;</span></span>
<span class="line"><span>&lt;script src=&quot;./ccc.js&quot;&gt;&lt;/script&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>所以，没有模块化对于一个大型项目来说是灾难性的。</p><p><strong>当然，我们有办法可以解决上面的问题：立即函数调用表达式（IIFE）</strong></p><ul><li><strong>IIFE</strong> (Immediately Invoked Function Expression)</li></ul><p>aaa.js</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>const moduleA = (function () {</span></span>
<span class="line"><span>  var flag = true;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  if (flag) {</span></span>
<span class="line"><span>    console.log(&quot;aaa的flag为true&quot;)</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  return {</span></span>
<span class="line"><span>    flag: flag</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>})();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>bbb.js</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>const moduleB = (function () {</span></span>
<span class="line"><span>  var flag = false;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  if (!flag) {</span></span>
<span class="line"><span>    console.log(&quot;bbb使用了flag为false&quot;);</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>})();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ccc.js</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>const moduleC = (function() {</span></span>
<span class="line"><span>  const flag = moduleA.flag;</span></span>
<span class="line"><span>  if (flag) {</span></span>
<span class="line"><span>    console.log(&quot;使用了aaa的flag&quot;);</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>})();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>命名冲突的问题，有没有解决呢？解决了。</p><p>但是，我们其实带来了新的问题：</p><ul><li>第一，我必须记得每一个模块中返回对象的命名，才能在其他模块使用过程中正确的使用；</li><li>第二，代码写起来混乱不堪，每个文件中的代码都需要包裹在一个匿名函数中来编写；</li><li>第三，在没有合适的规范情况下，每个人、每个公司都可能会任意命名、甚至出现模块名称相同的情况；</li></ul><p><strong>所以，我们会发现，虽然实现了模块化，但是我们的实现过于简单，并且是没有规范的。</strong></p><ul><li>我们需要制定一定的规范来约束每个人都按照这个规范去编写模块化的代码；</li><li>这个规范中应该包括核心功能：模块本身可以导出暴露的属性，模块又可以导入自己需要的属性；</li></ul><p>JavaScript社区为了解决上面的问题，涌现出一系列好用的规范，接下来我们就学习具有代表性的一些规范。</p><h2 id="commonjs规范" tabindex="-1"><a class="header-anchor" href="#commonjs规范"><span>CommonJS规范</span></a></h2><h3 id="_2-1-commonjs和node" tabindex="-1"><a class="header-anchor" href="#_2-1-commonjs和node"><span>2.1. CommonJS和Node</span></a></h3><p>我们需要知道CommonJS是一个规范，最初提出来是在浏览器意外的地方使用，并且当时被命名为<strong>ServerJS</strong>，后来为了体现它的广泛性，修改为<strong>CommonJS</strong>，平时我们也会简称为CJS。</p><ul><li>Node是CommonJS在服务器端一个具有代表性的实现；</li><li>Browserify是CommonJS在浏览器中的一种实现；</li><li>webpack打包工具具备对CommonJS的支持和转换（后面我会讲到）；</li></ul><p>所以，Node中对CommonJS进行了支持和实现，让我们在开发node的过程中可以方便的进行模块化开发：</p><ul><li>在Node中每一个js文件都是一个单独的模块；</li><li>这个模块中包括CommonJS规范的核心变量：exports、module.exports、require；</li><li>我们可以使用这些变量来方便的进行模块化开发；</li></ul><p>前面我们提到过模块化的核心是导出和导入，Node中对其进行了实现：</p><ul><li>exports和module.exports可以负责对模块中的内容进行导出；</li><li>require函数可以帮助我们导入其他模块（自定义模块、系统模块、第三方库模块）中的内容；</li></ul><h3 id="_2-2-node模块化开发" tabindex="-1"><a class="header-anchor" href="#_2-2-node模块化开发"><span>2.2. Node模块化开发</span></a></h3><p>我们来看一下两个文件：</p><p>bar.js</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>const name = &#39;coderwhy&#39;;</span></span>
<span class="line"><span>const age = 18;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function sayHello(name) {</span></span>
<span class="line"><span>  console.log(&quot;Hello &quot; + name);</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>main.js</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>console.log(name);</span></span>
<span class="line"><span>console.log(age);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>sayHello(&#39;kobe&#39;);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面的代码会报错：</p><ul><li>在node中每一个文件都是一个独立的模块，有自己的作用域；</li><li>那么，就意味着别的模块main中不能随便访问另外一个模块bar中的内容；</li><li>bar需要导出自己想要暴露的变量、函数、对象等等；</li><li>main从bar中导入自己想要使用的变量、函数、对象等等；</li></ul><p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuseDpSr345APaEno34kiboje8hwm1puPMdA3bP3sUYp9LA7m7LpVibnl8ACF7EyTwLgJEtoiadNV6tmQ/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy">导出和导入</p><h4 id="_2-2-1-exports导出" tabindex="-1"><a class="header-anchor" href="#_2-2-1-exports导出"><span>2.2.1. exports导出</span></a></h4><p><strong>强调：exports是一个对象，我们可以在这个对象中添加很多个属性，添加的属性会导出</strong></p><p>bar.js中导出内容：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>exports.name = name;</span></span>
<span class="line"><span>exports.age = age;</span></span>
<span class="line"><span>exports.sayHello = sayHello;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>main.js中导入内容：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>const bar = require(&#39;./bar&#39;);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>上面这行代码意味着什么呢？</p><ul><li>意味着main中的bar变量等于exports对象；</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>main中的bar = bar中的exports</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>所以，我可以编写下面的代码：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>const bar = require(&#39;./bar&#39;);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const name = bar.name;</span></span>
<span class="line"><span>const age = bar.age;</span></span>
<span class="line"><span>const sayHello = bar.sayHello;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>console.log(name);</span></span>
<span class="line"><span>console.log(age);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>sayHello(&#39;kobe&#39;);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuseDpSr345APaEno34kibojewT2wSgxhOcSHdyzZWicejEY7dYHuicgm9AzH1jtLibH0U9Loj7ZTVFbKw/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" tabindex="0" loading="lazy"><figcaption>图片</figcaption></figure><p>模块之间的引用关系</p><p>为了进一步论证，bar和exports是同一个对象：</p><ul><li>所以，bar对象是exports对象的浅拷贝；</li><li>浅拷贝的本质就是一种引用的赋值而已；</li></ul><p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuseDpSr345APaEno34kibojeicBuAibNeFXU9qkIauXYDOMsE7QCUxZesYWFouOBC7SQatrZpb4lUoEA/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy">定时器修改对象</p><h4 id="_2-2-2-module-exports" tabindex="-1"><a class="header-anchor" href="#_2-2-2-module-exports"><span>2.2.2. module.exports</span></a></h4><p>但是Node中我们经常导出东西的时候，又是通过module.exports导出的：</p><ul><li>module.exports和exports有什么关系或者区别呢？</li></ul><p>我们追根溯源，通过维基百科中对CommonJS规范的解析：</p><ul><li>CommonJS中是没有module.exports的概念的；</li><li>但是为了实现模块的导出，Node中使用的是Module的类，每一个模块都是Module的一个实例，也就是module；</li><li><strong>所以在Node中真正用于导出的其实根本不是exports，而是module.exports；</strong></li><li>因为module才是导出的真正实现者；</li></ul><p>但是，为什么exports也可以导出呢？</p><ul><li>这是因为module对象的exports属性是exports对象的一个引用；</li><li>也就是说 <code>module.exports = exports = main中的bar</code>；</li></ul><p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuseDpSr345APaEno34kibojeib966pL7iazrlQAJFO14AUekibxu8JF2MHxUrVoX0csXo1nJMjZeWOjmw/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy">image-20201011163653515</p><p>注意：真正导出的模块内容的核心其实是module.exports，只是为了实现CommonJS的规范，刚好module.exports对exports对象有一个引用而已；</p><p>那么，如果我的代码这样修改了：</p><p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuseDpSr345APaEno34kibojeE1wEXS3pNL4evJyQ0ia6lF5nx0aH7Lc6CQichwyWtoOKUlcBqIM8qOHQ/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy">image-20201011164006266</p><p>你能猜到内存中会有怎么样的表现吗？</p><ul><li>结论：和exports对象没有任何关系了，exports你随便玩自己的吧；</li><li>module.exports我现在导出一个自己的对象，不带着你玩了；</li><li>新的对象取代了exports对象的导出，那么就意味着require导入的对象是新的对象；</li></ul><p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuseDpSr345APaEno34kibojeQeOBuV3g4Gv6td12x74GguP2uS3Ze7FeHtWWLN3FM5o4j18yB3Bkiaw/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy">image-20201011164223607</p><h4 id="_2-2-3-require细节" tabindex="-1"><a class="header-anchor" href="#_2-2-3-require细节"><span>2.2.3. require细节</span></a></h4><p>我们现在已经知道，require是一个函数，可以帮助我们引入一个文件（模块）中导入的对象。</p><p>那么，require的查找规则是怎么样的呢？</p><ul><li>https://nodejs.org/dist/latest-v14.x/docs/api/modules.html#modules_all_together</li></ul><p><strong>这里我总结比较常见的查找规则：</strong></p><p>导入格式如下：require(X)</p><ul><li><p>情况一：X是一个核心模块，比如path、http</p></li><li><ul><li>直接返回核心模块，并且停止查找</li></ul></li><li><p>情况二：X是以 <code>./</code> 或 <code>../</code> 或 <code>/</code>（根目录）开头的</p></li><li><ul><li>查找目录下面的index文件</li></ul></li><li><p>1&gt; 查找X/index.js文件</p></li><li><p>2&gt; 查找X/index.json文件</p></li><li><p>3&gt; 查找X/index.node文件</p></li><li><p>1.如果有后缀名，按照后缀名的格式查找对应的文件</p></li><li><p>2.如果没有后缀名，会按照如下顺序：</p></li><li><p>1&gt; 直接查找文件X</p></li><li><p>2&gt; 查找X.js文件</p></li><li><p>3&gt; 查找X.json文件</p></li><li><p>4&gt; 查找X.node文件</p></li><li><p>第一步：将X当做一个文件在对应的目录下查找；</p></li><li><p>第二步：没有找到对应的文件，将X作为一个目录</p></li><li><p>如果没有找到，那么报错：<code>not found</code></p></li><li><p>情况三：直接是一个X（没有路径），并且X不是一个核心模块</p></li><li><ul><li>比如 <code>/Users/coderwhy/Desktop/Node/TestCode/04_learn_node/05_javascript-module/02_commonjs/main.js</code>中编写 <code>require(&#39;why&#39;)</code></li></ul></li><li><p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuseDpSr345APaEno34kibojeccY2Bics4UStoH4FzQrWyibQ4JPiaQayWNXn7ph55CpDPSNmeVXb0Jxyg/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy">查找顺序</p></li><li><p>如果上面的路径中都没有找到，那么报错：<code>not found</code></p></li></ul><h4 id="_2-2-4-模块加载顺序" tabindex="-1"><a class="header-anchor" href="#_2-2-4-模块加载顺序"><span>2.2.4. 模块加载顺序</span></a></h4><p>这里我们研究一下模块的加载顺序问题。</p><p><strong>结论一：模块在被第一次引入时，模块中的js代码会被运行一次</strong></p><p>aaa.js</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>const name = &#39;coderwhy&#39;;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>console.log(&quot;Hello aaa&quot;);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>setTimeout(() =&gt; {</span></span>
<span class="line"><span>  console.log(&quot;setTimeout&quot;);</span></span>
<span class="line"><span>}, 1000);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>main.js</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>const aaa = require(&#39;./aaa&#39;);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>aaa.js中的代码在引入时会被运行一次</p><p><strong>结论二：模块被多次引入时，会缓存，最终只加载（运行）一次</strong></p><p>main.js</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>const aaa = require(&#39;./aaa&#39;);</span></span>
<span class="line"><span>const bbb = require(&#39;./bbb&#39;);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>aaa.js</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>const ccc = require(&quot;./ccc&quot;);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>bbb.js</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>const ccc = require(&quot;./ccc&quot;);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ccc.js</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>console.log(&#39;ccc被加载&#39;);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ccc中的代码只会运行一次。</p><p><strong>为什么只会加载运行一次呢？</strong></p><ul><li>这是因为每个模块对象module都有一个属性：loaded。</li><li>为false表示还没有加载，为true表示已经加载；</li></ul><p><strong>结论三：如果有循环引入，那么加载顺序是什么？</strong></p><p>如果出现下面模块的引用关系，那么加载顺序是什么呢？</p><ul><li>这个其实是一种数据结构：图结构；</li><li>图结构在遍历的过程中，有深度优先搜索（DFS, depth first search）和广度优先搜索（BFS, breadth first search）；</li><li>Node采用的是深度优先算法：main -&gt; aaa -&gt; ccc -&gt; ddd -&gt; eee -&gt;bbb</li></ul><p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuseDpSr345APaEno34kibojeicyjvLkriaru3ojNlKRmvS2JxaSFMSc2FBKKwYarUJo4yg4gswJiaR3pA/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy">多个模块的引入关系</p><h3 id="_2-3-node的源码解析" tabindex="-1"><a class="header-anchor" href="#_2-3-node的源码解析"><span>2.3. Node的源码解析</span></a></h3><p>Module类</p><figure><img src="https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuseDpSr345APaEno34kibojeY4IPWs3EMyKOMWKeM6j67YYqCxEBibXBPr88jK58OMNW4vAiaj6sWAnw/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" tabindex="0" loading="lazy"><figcaption>图片</figcaption></figure><p>Module类</p><p>Module.prototype.require函数</p><figure><img src="https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuseDpSr345APaEno34kiboje0sX4zUA3vz40Ozw8qcUhylACJpZPhEXeZrKboRMRgQpwhCpZibWbceg/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" tabindex="0" loading="lazy"><figcaption>图片</figcaption></figure><p>require函数</p><p>Module._load函数</p><figure><img src="https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuseDpSr345APaEno34kibojeEjMHCucTVCC7q8WcQNmShUiaKWkFvkLSccd6HjJdM2MVkyVwrDoff8Q/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" tabindex="0" loading="lazy"><figcaption>图片</figcaption></figure><p>_load函数的实现</p><h2 id="amd和cmd规范" tabindex="-1"><a class="header-anchor" href="#amd和cmd规范"><span>AMD和CMD规范</span></a></h2><h3 id="_3-1-commonjs规范缺点" tabindex="-1"><a class="header-anchor" href="#_3-1-commonjs规范缺点"><span>3.1. CommonJS规范缺点</span></a></h3><p>CommonJS加载模块是同步的：</p><ul><li>同步的意味着只有等到对应的模块加载完毕，当前模块中的内容才能被运行；</li><li>这个在服务器不会有什么问题，因为服务器加载的js文件都是本地文件，加载速度非常快；</li></ul><p>如果将它应用于浏览器呢？</p><ul><li>浏览器加载js文件需要先从服务器将文件下载下来，之后在加载运行；</li><li>那么采用同步的就意味着后续的js代码都无法正常运行，即使是一些简单的DOM操作；</li></ul><p>所以在浏览器中，我们通常不使用CommonJS规范：</p><ul><li>当然在webpack中使用CommonJS是另外一回事；</li><li>因为它会将我们的代码转成浏览器可以直接执行的代码；</li></ul><p>在早期为了可以在浏览器中使用模块化，通常会采用AMD或CMD：</p><ul><li>但是目前一方面现代的浏览器已经支持ES Modules，另一方面借助于webpack等工具可以实现对CommonJS或者ES Module代码的转换；</li><li>AMD和CMD已经使用非常少了，所以这里我们进行简单的演练；</li></ul><h3 id="_3-2-amd规范" tabindex="-1"><a class="header-anchor" href="#_3-2-amd规范"><span>3.2. AMD规范</span></a></h3><p>AMD主要是应用于浏览器的一种模块化规范：</p><ul><li>AMD是Asynchronous Module Definition（异步模块定义）的缩写；</li><li>它采用的是异步加载模块；</li><li>事实上AMD的规范还要早于CommonJS，但是CommonJS目前依然在被使用，而AMD使用的较少了；</li></ul><p>我们提到过，规范只是定义代码的应该如何去编写，只有有了具体的实现才能被应用：</p><ul><li>AMD实现的比较常用的库是require.js和curl.js；</li></ul><p><strong>这里我们以require.js为例讲解：</strong></p><p>第一步：下载require.js</p><ul><li>下载地址：https://github.com/requirejs/requirejs</li><li>找到其中的require.js文件；</li></ul><p>第二步：定义HTML的script标签引入require.js和定义入口文件：</p><ul><li>data-main属性的作用是在加载完src的文件后会加载执行该文件</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>&lt;script src=&quot;./lib/require.js&quot; data-main=&quot;./index.js&quot;&gt;&lt;/script&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>第三步：编写如下目录和代码</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>├── index.html</span></span>
<span class="line"><span>├── index.js</span></span>
<span class="line"><span>├── lib</span></span>
<span class="line"><span>│   └── require.js</span></span>
<span class="line"><span>└── modules</span></span>
<span class="line"><span>    ├── bar.js</span></span>
<span class="line"><span>    └── foo.js</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>index.js</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>(function() {</span></span>
<span class="line"><span>  require.config({</span></span>
<span class="line"><span>    baseUrl: &#39;&#39;,</span></span>
<span class="line"><span>    paths: {</span></span>
<span class="line"><span>      foo: &#39;./modules/foo&#39;,</span></span>
<span class="line"><span>      bar: &#39;./modules/bar&#39;</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  })</span></span>
<span class="line"><span> </span></span>
<span class="line"><span>  // 开始加载执行foo模块的代码</span></span>
<span class="line"><span>  require([&#39;foo&#39;], function(foo) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  })</span></span>
<span class="line"><span>})();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>modules/bar.js</p><ul><li>如果一个模块不依赖其他，那么直接使用define(function)即可</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>define(function() {</span></span>
<span class="line"><span>  const name = &quot;coderwhy&quot;;</span></span>
<span class="line"><span>  const age = 18;</span></span>
<span class="line"><span>  const sayHello = function(name) {</span></span>
<span class="line"><span>    console.log(&quot;Hello &quot; + name);</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  return {</span></span>
<span class="line"><span>    name,</span></span>
<span class="line"><span>    age, </span></span>
<span class="line"><span>    sayHello</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>})</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>modules/foo.js</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>define([&#39;bar&#39;], function(bar) {</span></span>
<span class="line"><span>  console.log(bar.name);</span></span>
<span class="line"><span>  console.log(bar.age);</span></span>
<span class="line"><span>  bar.sayHello(&#39;kobe&#39;);</span></span>
<span class="line"><span>})</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-3-cmd规范" tabindex="-1"><a class="header-anchor" href="#_3-3-cmd规范"><span>3.3. <strong>CMD规范</strong></span></a></h3><p>CMD规范也是应用于浏览器的一种模块化规范：</p><ul><li>CMD 是Common Module Definition（通用模块定义）的缩写；</li><li>它也采用了异步加载模块，但是它将CommonJS的优点吸收了过来；</li><li>但是目前CMD使用也非常少了；</li></ul><p>CMD也有自己比较优秀的实现方案：</p><ul><li>SeaJS</li></ul><p><strong>我们一起看一下SeaJS如何使用：</strong></p><p>第一步：下载SeaJS</p><ul><li>下载地址：https://github.com/seajs/seajs</li><li>找到dist文件夹下的sea.js</li></ul><p>第二步：引入sea.js和使用主入口文件</p><ul><li><code>seajs</code>是指定主入口文件的</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>&lt;script src=&quot;./lib/sea.js&quot;&gt;&lt;/script&gt;</span></span>
<span class="line"><span>&lt;script&gt;</span></span>
<span class="line"><span>  seajs.use(&#39;./index.js&#39;);</span></span>
<span class="line"><span>&lt;/script&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>第三步：编写如下目录和代码</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>├── index.html</span></span>
<span class="line"><span>├── index.js</span></span>
<span class="line"><span>├── lib</span></span>
<span class="line"><span>│   └── sea.js</span></span>
<span class="line"><span>└── modules</span></span>
<span class="line"><span>    ├── bar.js</span></span>
<span class="line"><span>    └── foo.js</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>index.js</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>define(function(require, exports, module) {</span></span>
<span class="line"><span>  const foo = require(&#39;./modules/foo&#39;);</span></span>
<span class="line"><span>})</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>bar.js</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>define(function(require, exports, module) {</span></span>
<span class="line"><span>  const name = &#39;lilei&#39;;</span></span>
<span class="line"><span>  const age = 20;</span></span>
<span class="line"><span>  const sayHello = function(name) {</span></span>
<span class="line"><span>    console.log(&quot;你好 &quot; + name);</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  module.exports = {</span></span>
<span class="line"><span>    name,</span></span>
<span class="line"><span>    age,</span></span>
<span class="line"><span>    sayHello</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>})</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>foo.js</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>define(function(require, exports, module) {</span></span>
<span class="line"><span>  const bar = require(&#39;./bar&#39;);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  console.log(bar.name);</span></span>
<span class="line"><span>  console.log(bar.age);</span></span>
<span class="line"><span>  bar.sayHello(&quot;韩梅梅&quot;);</span></span>
<span class="line"><span>})</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="es-module" tabindex="-1"><a class="header-anchor" href="#es-module"><span>ES Module</span></a></h2><h3 id="_4-1-认识es-module" tabindex="-1"><a class="header-anchor" href="#_4-1-认识es-module"><span>4.1. 认识ES Module</span></a></h3><p>JavaScript没有模块化一直是它的痛点，所以才会产生我们前面学习的社区规范：CommonJS、AMD、CMD等，所以在ES推出自己的模块化系统时，大家也是兴奋异常。</p><p>ES Module和CommonJS的模块化有一些不同之处：</p><ul><li>一方面它使用了import和export关键字；</li><li>另一方面它采用编译期静态类型检测，并且动态引用的方式；</li></ul><p>ES Module模块采用export和import关键字来实现模块化：</p><ul><li>export负责将模块内的内容导出；</li><li>import负责从其他模块导入内容；</li></ul><p>了解：采用ES Module将自动采用严格模式：<code>use strict</code></p><ul><li>如果你不熟悉严格模式可以简单看一下MDN上的解析；</li><li>https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Strict_mode</li></ul><h3 id="_4-2-es-module的使用" tabindex="-1"><a class="header-anchor" href="#_4-2-es-module的使用"><span>4.2. ES Module的使用</span></a></h3><h4 id="_4-2-1-代码结构组件" tabindex="-1"><a class="header-anchor" href="#_4-2-1-代码结构组件"><span>4.2.1. 代码结构组件</span></a></h4><p>这里我在浏览器中演示ES6的模块化开发：</p><p>代码结构如下：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>├── index.html</span></span>
<span class="line"><span>├── main.js</span></span>
<span class="line"><span>└── modules</span></span>
<span class="line"><span>    └── foo.js</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>index.html中引入两个js文件作为模块：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>&lt;script src=&quot;./modules/foo.js&quot; type=&quot;module&quot;&gt;&lt;/script&gt;</span></span>
<span class="line"><span>&lt;script src=&quot;main.js&quot; type=&quot;module&quot;&gt;&lt;/script&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>如果直接在浏览器中运行代码，会报如下错误：</p><figure><img src="https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuseDpSr345APaEno34kibojeeWRicwIysicCm4m69Kfd8FFfaEcWuRdSV4spX0zrGLzX51KCgZ6ibELPg/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" tabindex="0" loading="lazy"><figcaption>图片</figcaption></figure><p>模块化运行</p><p>这个在MDN上面有给出解释：</p><ul><li>https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Modules</li><li>你需要注意本地测试 — 如果你通过本地加载Html 文件 (比如一个 <code>file://</code> 路径的文件), 你将会遇到 CORS 错误，因为Javascript 模块安全性需要。</li><li>你需要通过一个服务器来测试。</li></ul><p>我这里使用的VSCode，VSCode中有一个插件：Live Server</p><ul><li>通过插件运行，可以将我们的代码运行在一个本地服务中；</li></ul><p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuseDpSr345APaEno34kibojeUG7186yJvYjzRXmzl3NFJg46oIEJibAPpbJvyBmycic4YF91qVfibuW7A/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy">image-20201012153439900</p><h4 id="_4-2-2-export关键字" tabindex="-1"><a class="header-anchor" href="#_4-2-2-export关键字"><span>4.2.2. export关键字</span></a></h4><p>export关键字将一个模块中的变量、函数、类等导出；</p><p>foo.js文件中默认代码如下：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>const name = &#39;coderwhy&#39;;</span></span>
<span class="line"><span>const age = 18;</span></span>
<span class="line"><span>let message = &quot;my name is why&quot;;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function sayHello(name) {</span></span>
<span class="line"><span>  console.log(&quot;Hello &quot; + name);</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>我们希望将其他中内容全部导出，它可以有如下的方式：</strong></p><p>方式一：在语句声明的前面直接加上export关键字</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>export const name = &#39;coderwhy&#39;;</span></span>
<span class="line"><span>export const age = 18;</span></span>
<span class="line"><span>export let message = &quot;my name is why&quot;;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>export function sayHello(name) {</span></span>
<span class="line"><span>  console.log(&quot;Hello &quot; + name);</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>方式二：将所有需要导出的标识符，放到export后面的 <code>{}</code>中</p><ul><li>注意：这里的 <code>{}</code>里面不是ES6的对象字面量的增强写法，<code>{}</code>也不是表示一个对象的；</li><li>所以：<code>export {name: name}</code>，是错误的写法；</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>const name = &#39;coderwhy&#39;;</span></span>
<span class="line"><span>const age = 18;</span></span>
<span class="line"><span>let message = &quot;my name is why&quot;;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function sayHello(name) {</span></span>
<span class="line"><span>  console.log(&quot;Hello &quot; + name);</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>export {</span></span>
<span class="line"><span>  name,</span></span>
<span class="line"><span>  age,</span></span>
<span class="line"><span>  message,</span></span>
<span class="line"><span>  sayHello</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>方式三：导出时给<code>标识符</code>起一个别名</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>export {</span></span>
<span class="line"><span>  name as fName,</span></span>
<span class="line"><span>  age as fAge,</span></span>
<span class="line"><span>  message as fMessage,</span></span>
<span class="line"><span>  sayHello as fSayHello</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4-2-3-import关键字" tabindex="-1"><a class="header-anchor" href="#_4-2-3-import关键字"><span>4.2.3. import关键字</span></a></h4><p>import关键字负责从另外一个模块中导入内容</p><p><strong>导入内容的方式也有多种：</strong></p><p>方式一：<code>import {标识符列表} from &#39;模块&#39;</code>；</p><ul><li>注意：这里的<code>{}</code>也不是一个对象，里面只是存放导入的标识符列表内容；</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>import { name, age, message, sayHello } from &#39;./modules/foo.js&#39;;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>console.log(name)</span></span>
<span class="line"><span>console.log(message);</span></span>
<span class="line"><span>console.log(age);</span></span>
<span class="line"><span>sayHello(&quot;Kobe&quot;);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>方式二：导入时给标识符起别名</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>import { name as wName, age as wAge, message as wMessage, sayHello as wSayHello } from &#39;./modules/foo.js&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>方式三：将模块功能放到一个模块功能对象（a module object）上</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>import * as foo from &#39;./modules/foo.js&#39;;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>console.log(foo.name);</span></span>
<span class="line"><span>console.log(foo.message);</span></span>
<span class="line"><span>console.log(foo.age);</span></span>
<span class="line"><span>foo.sayHello(&quot;Kobe&quot;);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4-2-4-export和import结合" tabindex="-1"><a class="header-anchor" href="#_4-2-4-export和import结合"><span>4.2.4. export和import结合</span></a></h4><p>如果从一个模块中导入的内容，我们希望再直接导出出去，这个时候可以直接使用export来导出。</p><p>bar.js中导出一个sum函数：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>export const sum = function(num1, num2) {</span></span>
<span class="line"><span>  return num1 + num2;</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>foo.js中导入，但是只是做一个中转：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>export { sum } from &#39;./bar.js&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>main.js直接从foo中导入：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>import { sum } from &#39;./modules/foo.js&#39;;</span></span>
<span class="line"><span>console.log(sum(20, 30));</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>甚至在foo.js中导出时，我们可以变化它的名字</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>export { sum as barSum } from &#39;./bar.js&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>为什么要这样做呢？</p><ul><li>在开发和封装一个功能库时，通常我们希望将暴露的所有接口放到一个文件中；</li><li>这样方便指定统一的接口规范，也方便阅读；</li><li>这个时候，我们就可以使用export和import结合使用；</li></ul><h4 id="_4-2-4-default用法" tabindex="-1"><a class="header-anchor" href="#_4-2-4-default用法"><span>4.2.4. default用法</span></a></h4><p>前面我们学习的导出功能都是有名字的导出（named exports）：</p><ul><li>在导出export时指定了名字；</li><li>在导入import时需要知道具体的名字；</li></ul><p>还有一种导出叫做默认导出（default export）</p><ul><li>默认导出export时可以不需要指定名字；</li><li>在导入时不需要使用 <code>{}</code>，并且可以自己来指定名字；</li><li>它也方便我们和现有的CommonJS等规范相互操作；</li></ul><p>导出格式如下：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>export default function sub(num1, num2) {</span></span>
<span class="line"><span>  return num1 - num2;</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>导入格式如下：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>import sub from &#39;./modules/foo.js&#39;;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>console.log(sub(20, 30));</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注意：在一个模块中，只能有一个默认导出（default export）；</p><h4 id="_4-2-5-import" tabindex="-1"><a class="header-anchor" href="#_4-2-5-import"><span>4.2.5. import()</span></a></h4><p>通过import加载一个模块，是不可以在其放到逻辑代码中的，比如：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>if (true) {</span></span>
<span class="line"><span>  import sub from &#39;./modules/foo.js&#39;;</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>为什么会出现这个情况呢？</p><ul><li>这是因为ES Module在被JS引擎解析时，就必须知道它的依赖关系；</li><li>由于这个时候js代码没有任何的运行，所以无法在进行类似于if判断中根据代码的执行情况；</li><li>甚至下面的这种写法也是错误的：因为我们必须到运行时能确定path的值；</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>const path = &#39;./modules/foo.js&#39;;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>import sub from path;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>但是某些情况下，我们确确实实希望动态的来加载某一个模块：</p><ul><li>如果根据不懂的条件，动态来选择加载模块的路径；</li><li><strong>这个时候我们需要使用 <code>import()</code> 函数来动态加载；</strong></li></ul><p>aaa.js模块：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>export function aaa() {</span></span>
<span class="line"><span>  console.log(&quot;aaa被打印&quot;);</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>bbb.js模块：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>export function bbb() {</span></span>
<span class="line"><span>  console.log(&quot;bbb被执行&quot;);</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>main.js模块：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>let flag = true;</span></span>
<span class="line"><span>if (flag) {</span></span>
<span class="line"><span>  import(&#39;./modules/aaa.js&#39;).then(aaa =&gt; {</span></span>
<span class="line"><span>    aaa.aaa();</span></span>
<span class="line"><span>  })</span></span>
<span class="line"><span>} else {</span></span>
<span class="line"><span>  import(&#39;./modules/bbb.js&#39;).then(bbb =&gt; {</span></span>
<span class="line"><span>    bbb.bbb();</span></span>
<span class="line"><span>  })</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-3-es-module的原理" tabindex="-1"><a class="header-anchor" href="#_4-3-es-module的原理"><span>4.3. ES Module的原理</span></a></h3><h4 id="_4-3-1-es-module和commonjs的区别" tabindex="-1"><a class="header-anchor" href="#_4-3-1-es-module和commonjs的区别"><span>4.3.1. ES Module和CommonJS的区别</span></a></h4><p><strong>CommonJS模块加载js文件的过程是运行时加载的，并且是同步的：</strong></p><ul><li>运行时加载意味着是js引擎在执行js代码的过程中加载 模块；</li><li>同步的就意味着一个文件没有加载结束之前，后面的代码都不会执行；</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>console.log(&quot;main代码执行&quot;);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const flag = true;</span></span>
<span class="line"><span>if (flag) {</span></span>
<span class="line"><span>  // 同步加载foo文件，并且执行一次内部的代码</span></span>
<span class="line"><span>  const foo = require(&#39;./foo&#39;);</span></span>
<span class="line"><span>  console.log(&quot;if语句继续执行&quot;);</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>CommonJS通过module.exports导出的是一个对象：</strong></p><ul><li>导出的是一个对象意味着可以将这个对象的引用在其他模块中赋值给其他变量；</li><li>但是最终他们指向的都是同一个对象，那么一个变量修改了对象的属性，所有的地方都会被修改；</li></ul><p><strong>ES Module加载js文件的过程是编译（解析）时加载的，并且是异步的：</strong></p><ul><li><p>编译时（解析）时加载，意味着import不能和运行时相关的内容放在一起使用：</p></li><li><ul><li>比如from后面的路径需要动态获取；</li></ul></li><li><p>比如不能将import放到if等语句的代码块中；</p></li><li><p>所以我们有时候也称ES Module是静态解析的，而不是动态或者运行时解析的；</p></li><li><p>异步的意味着：JS引擎在遇到<code>import</code>时会去获取这个js文件，但是这个获取的过程是异步的，并不会阻塞主线程继续执行；</p></li><li><ul><li>也就是说设置了 <code>type=module</code> 的代码，相当于在script标签上也加上了 <code>async</code> 属性；</li></ul></li><li><p>如果我们后面有普通的script标签以及对应的代码，那么ES Module对应的js文件和代码不会阻塞它们的执行；</p></li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>&lt;script src=&quot;main.js&quot; type=&quot;module&quot;&gt;&lt;/script&gt;</span></span>
<span class="line"><span>&lt;!-- 这个js文件的代码不会被阻塞执行 --&gt;</span></span>
<span class="line"><span>&lt;script src=&quot;index.js&quot;&gt;&lt;/script&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ES Module通过export导出的是变量本身的引用：</strong></p><ul><li>export在导出一个变量时，js引擎会解析这个语法，并且创建<strong>模块环境记录</strong>（module environment record）；</li><li><strong>模块环境记录</strong>会和变量进行 <code>绑定</code>（binding），并且这个绑定是实时的；</li><li>而在导入的地方，我们是可以实时的获取到绑定的最新值的；</li></ul><p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuseDpSr345APaEno34kibojeezXibRWtBBwGrUqbiceysIwmIBaWxjhEc1QAOOr0MSjCbOJTkKhP5dfw/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy">export和import绑定的过程</p><p><strong>所以我们下面的代码是成立的：</strong></p><p>bar.js文件中修改</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>let name = &#39;coderwhy&#39;;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>setTimeout(() =&gt; {</span></span>
<span class="line"><span>  name = &quot;湖人总冠军&quot;;</span></span>
<span class="line"><span>}, 1000);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>setTimeout(() =&gt; {</span></span>
<span class="line"><span>  console.log(name);</span></span>
<span class="line"><span>}, 2000);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>export {</span></span>
<span class="line"><span>  name</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>main.js文件中获取</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>import { name } from &#39;./modules/bar.js&#39;;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>console.log(name);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// bar中修改, main中验证</span></span>
<span class="line"><span>setTimeout(() =&gt; {</span></span>
<span class="line"><span>  console.log(name);</span></span>
<span class="line"><span>}, 2000);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>但是，下面的代码是不成立的：main.js中修改</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>import { name } from &#39;./modules/bar.js&#39;;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>console.log(name);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// main中修改, bar中验证</span></span>
<span class="line"><span>setTimeout(() =&gt; {</span></span>
<span class="line"><span>  name = &#39;kobe&#39;;</span></span>
<span class="line"><span>}, 1000);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuseDpSr345APaEno34kibojelXdJWbQtsL9dkFfVickXCPiclf8icow980G4sPwpITsbzuEYaZS1VPIoA/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy">导入的变量不可以被修改</p><p>思考：如果bar.js中导出的是一个对象，那么main.js中是否可以修改对象中的属性呢？</p><ul><li>答案是可以的，因为他们指向同一块内存空间；（自己编写代码验证，这里不再给出）</li></ul><h4 id="_4-3-2-node中支持-es-module" tabindex="-1"><a class="header-anchor" href="#_4-3-2-node中支持-es-module"><span>4.3.2. Node中支持 ES Module</span></a></h4><p><strong>在Current版本中</strong></p><p>在最新的Current版本（v14.13.1）中，支持es module我们需要进行如下操作：</p><ul><li>方式一：在package.json中配置 <code>type: module</code>（后续再学习，我们现在还没有讲到package.json文件的作用）</li><li>方式二：文件以 <code>.mjs</code> 结尾，表示使用的是ES Module；</li></ul><p>这里我们暂时选择以 <code>.mjs</code> 结尾的方式来演练：</p><p>bar.mjs</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>const name = &#39;coderwhy&#39;;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>export {</span></span>
<span class="line"><span>  name</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>main.mjs</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>import { name } from &#39;./modules/bar.mjs&#39;;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>console.log(name);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>在LTS版本中</strong></p><p>在最新的LST版本（v12.19.0）中，我们也是可以正常运行的，但是会报一个警告：</p><p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/O8xWXzAqXuseDpSr345APaEno34kibojefTf4B6uacj7YUH5BD1IKh5IzA1DcedJ5ia6Y1Wnul1HCo9fVCWjMdRQ/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy">lts版本的警告</p><h4 id="_4-3-3-es-module和commonjs的交互" tabindex="-1"><a class="header-anchor" href="#_4-3-3-es-module和commonjs的交互"><span>4.3.3. ES Module和CommonJS的交互</span></a></h4><p><strong>CommonJS加载ES Module</strong></p><p>结论：通常情况下，CommonJS不能加载ES Module</p><ul><li>因为CommonJS是同步加载的，但是ES Module必须经过静态分析等，无法在这个时候执行JavaScript代码；</li><li>但是这个并非绝对的，某些平台在实现的时候可以对代码进行针对性的解析，也可能会支持；</li><li>Node当中是不支持的；</li></ul><p><strong>ES Module加载CommonJS</strong></p><p>结论：多数情况下，ES Module可以加载CommonJS</p><ul><li>ES Module在加载CommonJS时，会将其module.exports导出的内容作为default导出方式来使用；</li><li>这个依然需要看具体的实现，比如webpack中是支持的、Node最新的Current版本也是支持的；</li><li>但是在最新的LTS版本中就不支持；</li></ul><p>foo.js</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>const address = &#39;foo的address&#39;;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>module.exports = {</span></span>
<span class="line"><span>  address</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>main.js</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>import foo from &#39;./modules/foo.js&#39;;</span></span>
<span class="line"><span>console.log(foo.address);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></div><!----><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">上次编辑于: </span><!----></div><div class="contributors"><span class="vp-meta-label">贡献者: </span><!--[--><!--[--><span class="vp-meta-info" title="email: chriswoodcn@aliyun.com">chriswoodcn</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/zh/posts/node/base/Node%E5%9F%BA%E7%A1%80%E4%B8%83.html" aria-label="Node基础七"><div class="hint"><span class="arrow start"></span>上一页</div><div class="link"><!---->Node基础七</div></a><a class="route-link auto-link next" href="/zh/posts/node/base/Node%E5%9F%BA%E7%A1%80%E5%9B%9B.html" aria-label="Node基础四"><div class="hint">下一页<span class="arrow end"></span></div><div class="link">Node基础四<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper"><!----><div class="vp-copyright"><div>Copyright &copy; 2024 Chris Wood, All Rights Reserved.<div></div></footer></div><!--]--><!--[--><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-Di2jApqi.js" defer></script>
  </body>
</html>
